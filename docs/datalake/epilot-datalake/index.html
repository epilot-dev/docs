<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<title data-react-helmet="true">Epilot Datalake | epilot dev center</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.epilot.io/docs/datalake/epilot-datalake"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Epilot Datalake | epilot dev center"><meta data-react-helmet="true" name="description" content="Welcome to the documentation for our Data Lake feature, which serves as the centralized repository for real-time event streams of entity operations, snapshots of workflow executions, journey analytics and portal analytics data. This feature empowers users to access and analyze essential data generated by the epilot portal, including changes to entities such as orders, opportunities, contacts, accounts, products, interactions from user journeys, customer portal, installer portal and more."><meta data-react-helmet="true" property="og:description" content="Welcome to the documentation for our Data Lake feature, which serves as the centralized repository for real-time event streams of entity operations, snapshots of workflow executions, journey analytics and portal analytics data. This feature empowers users to access and analyze essential data generated by the epilot portal, including changes to entities such as orders, opportunities, contacts, accounts, products, interactions from user journeys, customer portal, installer portal and more."><link data-react-helmet="true" rel="icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://docs.epilot.io/docs/datalake/epilot-datalake"><link data-react-helmet="true" rel="alternate" href="https://docs.epilot.io/docs/datalake/epilot-datalake" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.epilot.io/docs/datalake/epilot-datalake" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.09015a10.css">
<link rel="preload" href="/assets/js/runtime~main.c8c37d84.js" as="script">
<link rel="preload" href="/assets/js/main.debc8871.js" as="script">
</head>
<body data-theme="light">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="epilot" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.png" alt="epilot" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Dev Center</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/api">REST API</a><a class="navbar__item navbar__link" href="/graphql/sharing">GraphQL</a><a class="navbar__item navbar__link" href="/docs/architecture/sdk">SDK</a><a class="navbar__item navbar__link" href="/apps/">Apps</a></div><div class="navbar__items navbar__items--right"><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ðŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ðŸŒž</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current,docs-graphql-current,docs-apps-current"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/architecture/overview">Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/auth/authentication">Auth</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/portal/microfrontends">360 Portal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/entities/flexible-entities">Entities</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/journeys/journey-builder">Journeys</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/ui-design/component_library">UI Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/messaging/email-settings">Messaging</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/files/file-entity">Files</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/portals/customer-portal">Portals</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/pricing/">Pricing</a><button aria-label="Toggle the collapsible sidebar category &#x27;Pricing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/automation/intro">Automation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/collaboration/partner-directory">Collaboration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/audit-logs">Audit logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/webhooks">Webhooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/workflows/intro">Workflows</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/integrations/3rd-party-journeys">Integrations</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/datalake/epilot-datalake">Datalake</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/datalake/epilot-datalake">Epilot Datalake</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/sso/single-sign-on">Single Sign On</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/templates/template-variables">Templates</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/blueprints/intro">Blueprints</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Epilot Datalake</h1><p>Welcome to the documentation for our Data Lake feature, which serves as the centralized repository for real-time event streams of entity operations, snapshots of workflow executions, journey analytics and portal analytics data. This feature empowers users to access and analyze essential data generated by the epilot portal, including changes to entities such as orders, opportunities, contacts, accounts, products, interactions from user journeys, customer portal, installer portal and more.</p><p>Our Data Lake is seamlessly integrated with Clickhouse for data warehousing, enabling the users to leverage Business Intelligence (BI) tools and create insightful reports. This documentation will guide you through the key components of the Data Lake feature, including data schemas, usage, and credential management.</p><p>Feel free to contact our customer support or sales for help in enabling this datalake feature for your organization.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="data-schemas">Data Schemas<a class="hash-link" href="#data-schemas" title="Direct link to heading">â€‹</a></h2><p>Our Data Lake features two distinct datasets:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="1-entity-operations-event-streams">1. Entity Operations Event Streams<a class="hash-link" href="#1-entity-operations-event-streams" title="Direct link to heading">â€‹</a></h3><p>This dataset captures real-time event streams of entity operations. </p><p>The schema for entity operations is as follows:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;activity_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ID for the individual entity operation/activity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;entity_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ID of the entity being mutated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;org_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Organization ID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;operation&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Operation can be &quot;createEntity,&quot; &quot;updateEntity,&quot; or &quot;deleteEntity&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;schema&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Schema of the entity</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;timestamp&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;DateTime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp of the entity mutation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;detail&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// Stringified JSON payload containing entity data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Fields of interest in this schema include:</p><p><strong>Operation</strong>: Describes the type of entity operation, including creation, update, or deletion.</p><ul><li><code>createEntity</code>: This operation type is recorded when a new entity is created.</li><li><code>updateEntity</code>: This operation type is recorded when an existing entity is updated.</li><li><code>deleteEntity</code>: This operation type is recorded when an entity is deleted.</li></ul><p><strong>timestamp</strong>: Provides a timestamp for building time series reports.</p><p><strong>activity_id</strong> and <strong>entity_id</strong>: These fields contain unique identifiers that can be used to track individual entity operations (activity_id) and identify the specific entity that was mutated (entity_id).</p><p><strong>detail</strong>: The detail field contains a stringified JSON payload that includes the full entity data at the time of the operation. This payload can be parsed and used to access detailed information about the entity&#x27;s state during the operation.</p><blockquote><p>Additionally, we offer a simplified view called <strong>{org_id}_current_entities_final</strong>, which displays only the latest state of currently active entities in the organization, excluding deleted entities</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="2-workflow-execution-snapshots">2: Workflow Execution Snapshots<a class="hash-link" href="#2-workflow-execution-snapshots" title="Direct link to heading">â€‹</a></h3><p>In addition to entity operations, we ingest real-time updates from workflow executions, allowing users to access current snapshots of workflow data. This dataset comprises five tables:</p><ul><li><p><strong>{org_id}_workflow_executions_final</strong>
This table contains all the attributes of workflow execution data.</p></li><li><p><strong>{org_id}_workflow_phases_final</strong>
Here, you can find attributes of the various phases involved in a workflow execution.</p></li><li><p><strong>{org_id}_workflow_tasks_final</strong>
This table stores attributes related to individual steps or tasks within a workflow execution.</p></li><li><p><strong>{org_id}_workflow_cancellations_final</strong>
This table records data regarding the reasons for workflow execution cancellations.</p></li><li><p><strong>{org_id}_workflow_contexts_final</strong>
Contains information about related entities associated with a workflow execution.</p><div><iframe title="Workflows DB Schema" width="100%" height="600px" src="https://drawsql.app/teams/epilot/diagrams/workflows/embed"></iframe></div></li></ul><p>To know more about workflow execution details, please refer <a href="/api/workflow-execution#tag/Workflows/operation/getExecution">here</a></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="3-journey-analytics">3. Journey Analytics<a class="hash-link" href="#3-journey-analytics" title="Direct link to heading">â€‹</a></h3><p>This dataset showcases the user sessions created for each journey and the interactions that occur within those sessions.</p><p>The schema for journey sessions is as follows:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the session (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;org_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the organization associated with the session (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;journey_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the user journey to which the session belongs (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when the session started</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;details&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Additional details about the session, in JSON format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;end_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when the session ended</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;last_updated_at&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when was the session last updated at</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Fields of interest in this schema include:</p><p><strong>details</strong>: This field possibly contains basic user&#x27;s browser session details</p><ul><li><code>deviceType</code>: The type of device used by the user (e.g., mobile, desktop).</li><li><code>osType</code>: The operating system of the device (e.g., iOS, Android, Windows).</li><li><code>browserTypeAndVersion</code>: The browser name and version used by the user (e.g., Chrome 92, Firefox 89).</li><li><code>screenResolution</code>: The screen resolution of the user&#x27;s device (e.g., 1920x1080).</li><li><code>viewportSize</code>: The size of the viewport in the browser (i.e., the visible area of the web page).</li><li><code>colorDepth</code>: The color depth of the user&#x27;s display (e.g., 24).</li><li><code>languagePreference</code>: The preferred language set in the user&#x27;s browser (e.g., en-US, fr-FR).</li><li><code>ip</code>: The IP address of the user&#x27;s device when the event was recorded.</li><li><code>embeddedIn</code>: The website or platform on which the journey is embedded.</li><li><code>isLauncherJourney</code>: The journey for which the session was created is a launcher journey or not</li></ul><p>The schema for journey events is as follows:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the event (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;org_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Identifier of the organization associated with the event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;session_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the session in which the event occurred (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;journey_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the user journey to which the event belongs (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Type of event (e.g., &quot;step_navigation&quot;, &quot;journey_submit&quot;, &quot;journey_exit&quot;)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;details&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Additional details about the event, typically in JSON format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;created_at&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when the event was recorded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Fields of interest in this schema include:</p><p><strong>type</strong>: This field contains the type of user interaction or event that occurs on the session</p><ul><li><code>journey_load_time</code>: The time it takes for the journey to load, typically measured from journey API response time.</li><li><code>step_navigation</code>: The event triggered when a user navigates from one step to another within the journey.</li><li><code>journey_submit</code>: The event triggered when a user completes and submits the journey.</li><li><code>journey_exit</code>: The event triggered when a user exits the journey, possibly by closing or refreshing the journey tab in the browser.</li></ul><p><strong>details</strong>: This field contains additional details about the type of event that occurs. Basically <code>fromStepName</code>, <code>fromStepNumber</code>, <code>toStepName</code> and <code>toStepNumber</code> on a <code>step_navigation</code> event, <code>stepNumber</code> and <code>stepName</code> on which the <code>journey_exit</code> occurred and time taken for journeys to load.</p><ul><li><p><strong>{org_id}_journey_sessions_final</strong>
This table stores the above attributes related to journey sessions.</p></li><li><p><strong>{org_id}_journey_events_final</strong>
This table stores the above attributes related to journey events.</p></li></ul><p><img alt="Journey analytics db schema" src="/assets/images/journey-analytics-db-schema-a6429f1377c411dc860faa987091b2d3.png" width="697" height="320"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="4-portal-analytics">4. Portal Analytics<a class="hash-link" href="#4-portal-analytics" title="Direct link to heading">â€‹</a></h3><p>This dataset highlights user sessions generated during each portal login and details the interactions that occur within these sessions. It captures key metrics and events to provide insights into user behavior and engagement patterns.</p><p>The schema for portal sessions is as follows:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the session (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;org_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Identifier of the organization associated with the event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;app_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Name of the app for which the session was created (customer portal, installer portal etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;start_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when the session started</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;details&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Additional details about the session, in JSON format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;end_time&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when the session ended</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;last_updated_at&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when was the session last updated at</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Fields of interest in this schema include:</p><p><strong>details</strong>: This field possibly contains basic user&#x27;s browser session details</p><ul><li><code>deviceType</code>: The type of device used by the user (e.g., mobile, desktop).</li><li><code>osType</code>: The operating system of the device (e.g., iOS, Android, Windows).</li><li><code>browserTypeAndVersion</code>: The browser name and version used by the user (e.g., Chrome 92, Firefox 89).</li><li><code>screenResolution</code>: The screen resolution of the user&#x27;s device (e.g., 1920x1080).</li><li><code>viewportSize</code>: The size of the viewport in the browser (i.e., the visible area of the web page).</li><li><code>colorDepth</code>: The color depth of the user&#x27;s display (e.g., 24).</li><li><code>languagePreference</code>: The preferred language set in the user&#x27;s browser (e.g., en-US, fr-FR).</li><li><code>ip</code>: The IP address of the user&#x27;s device when the event was recorded.</li><li><code>email</code>: The email ID of the logged in user.</li><li><code>domainName</code>: The app domain in which the session was created</li><li><code>referrer</code>: The user was referred or directed from which site </li></ul><p>The schema for portal events is as follows:</p><div class="codeBlockContainer_I0IT language-json theme-code-block"><div class="codeBlockContent_wNvx json"><pre tabindex="0" class="prism-code language-json codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the event (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;org_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Identifier of the organization associated with the event</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;session_id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Unique identifier for the session in which the event occurred (UUID)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;app_name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Name of the app for which the event was created (customer portal, installer portal etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;type&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Type of event (e.g., &quot;user_logged_in&quot;, &quot;page_navigation&quot;, etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;details&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;string&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Additional details about the event, in JSON format</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;created_at&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;datetime&quot;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Timestamp indicating when the event was recorded</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Fields of interest in this schema include:</p><p><strong>type</strong>: This field contains the type of user interaction or event that occurs on the session</p><ul><li><code>user_logged_in</code>: User successfully logged into the portal.</li><li><code>user_registered</code>: A new user successfully registered.</li><li><code>add_contract_initiated</code>: User started adding a new contract.</li><li><code>additional_info_update_initiated</code>: User began updating additional info (it is a wrapper term for all the additional or custom information section that an organization configures for its portal)</li><li><code>additional_info_updated</code>: User successfully updated additional information.</li><li><code>additional_info_viewed</code>: User viewed additional information details.</li><li><code>all_documents_downloaded</code>: User downloaded all available documents in a section.</li><li><code>contract_added</code>: A new contract was successfully added.</li><li><code>contract_due_date_changed</code>: User updated the contractâ€™s due date.</li><li><code>contract_payment_rate_changed</code>: User changed the payment rate for a contract.</li><li><code>contracts_listing_viewed</code>: User viewed the list of all contracts.</li><li><code>contract_viewed</code>: User opened and viewed a specific contract.</li><li><code>document_deleted</code>: A document was removed by the user.</li><li><code>document_downloaded</code>: User downloaded a specific document.</li><li><code>document_uploaded</code>: A document was uploaded by the user.</li><li><code>documents_listing_viewed</code>: User viewed a list of uploaded documents.</li><li><code>external_website_opened</code>: User navigated to an external website.</li><li><code>journey_opened</code>: User initiated a new journey workflow.</li><li><code>journey_closed</code>: User exited a specific journey workflow.</li><li><code>meter_reading_submission_initiated</code>: User started submitting meter reading.</li><li><code>meter_reading_submitted</code>: A meter reading was successfully submitted.</li><li><code>meters_listing_viewed</code>: User viewed the list of available meters.</li><li><code>meter_viewed</code>: User opened details for a specific meter.</li><li><code>meter_widget_viewed</code>: User viewed a widget related to meters.</li><li><code>opportunities_listing_viewed</code>: User browsed the list of opportunities.</li><li><code>opportunity_viewed</code>: User opened and viewed an opportunityâ€™s details.</li><li><code>order_accepted</code>: User accepted a specific order.</li><li><code>order_refused</code>: User declined a specific order.</li><li><code>order_viewed</code>: User viewed details of a particular order.</li><li><code>orders_listing_viewed</code>: User accessed the list of available orders.</li><li><code>page_navigation</code>: User navigated between application pages.</li><li><code>password_changed</code>: User successfully updated their account password.</li><li><code>payments_listing_viewed</code>: User browsed the list of all payments.</li><li><code>product_viewed</code>: User viewed details of a specific product.</li><li><code>teaser_opened</code>: User clicked and opened a teaser content.</li><li><code>user_account_deleted</code>: Userâ€™s account was removed or deleted.</li><li><code>user_email_changed</code>: User updated their email address.</li><li><code>user_logged_out</code>: User logged out from the application.</li></ul><p><strong>details</strong>: This field contains additional details about the type of event that occurs. Basically from and to page URLs for page_navigation, entity details for contracts, orders, meter readings, documents, journeys etc, external links opened, custom information updates etc.</p><ul><li><p><strong>{org_id}_portal_sessions_final</strong>
This table stores the above attributes related to portal sessions.</p></li><li><p><strong>{org_id}_portal_events_final</strong>
This table stores the above attributes related to portal events.</p></li></ul><p><img alt="Portal analytics db schema" src="/assets/images/portal-analytics-db-schema-b08c6c193d5c39ba2a14c7aa7ea7af0e.png" width="982" height="504"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="setting-up-datalake">Setting up Datalake<a class="hash-link" href="#setting-up-datalake" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="generate-datalake-credentials">Generate datalake credentials<a class="hash-link" href="#generate-datalake-credentials" title="Direct link to heading">â€‹</a></h3><ul><li><p>Navigate to the &quot;Settings&quot; menu on the top right in your organization&#x27;s portal. Then locate the &quot;Data Lake&quot; section from the drop down menu.
<img alt="Datalake menu" src="/assets/images/datalake-menu-fd0a3a932930ddb350df6d76ea239e6e.png" width="872" height="656"></p></li><li><p>The <code>Data Lake page</code> will display active credentials for your Data Lake. Here, you can revoke existing credentials or create new ones as needed.
<img alt="Datalake page" src="/assets/images/datalake-page-feba4fa5ae043089c3f86290a0c26ed9.png" width="2802" height="774"></p></li><li><p>To create new credentials, select the <code>Generate Credentials</code> button.</p></li><li><p>A new set of credentials will be generated. Note that the password will be visible only once at the time of creation for security reasons, so it&#x27;s crucial to save it securely.
<img alt="Datalake Credentials" src="/assets/images/datalake-credentials-fafbef14598a9fb836fd46a1e109cc49.png" width="1124" height="1276"></p></li><li><p>Utilize the generated <code>username</code>, <code>host</code>, <code>port</code>, <code>database</code> and <code>password</code> details to connect to the Data Lake from any BI tool or other data sources.</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="querying-the-data">Querying the Data<a class="hash-link" href="#querying-the-data" title="Direct link to heading">â€‹</a></h2><p>Once you&#x27;ve set up the necessary credentials, you can connect to the Clickhouse data warehouse and query the data. There are two primary ways to interact with the data:</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="directly-quering-via-sql">Directly Quering via SQL<a class="hash-link" href="#directly-quering-via-sql" title="Direct link to heading">â€‹</a></h3><p>You can write SQL queries to retrieve the data directly from Clickhouse using SQL functions. Below are examples illustrating how to query the data for insights.</p><p><strong>Example 1: Reporting Opportunities Created Over Time</strong>
Suppose you need to create a report showing opportunities created over time, grouped by journey source, with a time granularity of months. You can use SQL to accomplish this task:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">count</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> count</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    JSONExtractString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">detail</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;payload&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;source&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;title&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> journey_source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toStartOfYear </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">year</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    toStartOfMonth</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">timestamp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">month</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entity_operations</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">schema</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;opportunity&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"> operation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;createEntity&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">group</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    journey_source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">year</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">month</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This SQL query retrieves data about opportunities created over time, extracts relevant information from the JSON payload, and aggregates it by year and month, providing insights into opportunities created during different periods.</p><p><img alt="Datalake page" src="/assets/images/opportunity-time-series-927ebb568a5cd85d7b78840309a9b296.png" width="1924" height="806"></p><p><strong>Example 2: Reporting Journey Sessions Created Over Time</strong>
Suppose you need to create a report showing journey sessions created over time for a specific journey. You can use SQL to accomplish this task:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    journey_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {org_id}_journey_sessions_final</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    journey_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> {your_journey_id}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_time </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2024-08-01 00:00:00&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This SQL query retrieves the journey sessions created over time for a specific journey</p><p><img alt="Datalake page" src="/assets/images/journey_analytics_query_result-4ac916336a03776127980dc7f9ba22d1.png" width="704" height="523"></p><p><strong>Example 3: Reporting Portal Sessions Created Over Time</strong>
Suppose you need to create a report showing portal sessions created over time for a specific portal like customer portal or installer portal. You can use SQL to accomplish this task:</p><div class="codeBlockContainer_I0IT language-sql theme-code-block"><div class="codeBlockContent_wNvx sql"><pre tabindex="0" class="prism-code language-sql codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">select</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app_name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    details</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {org_id}_portal_sessions_final</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">where</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    app_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> {your_app_name}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">and</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start_time </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;2024-08-01 00:00:00&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>This SQL query retrieves the portal sessions created over time for a specific portal</p><p><img alt="Datalake page" src="/assets/images/portal_analytics_query_result-9271db99ba95a03a1f54000d1763c077.png" width="1544" height="726"></p><p>You can use any SQL client to connect to the Clickhouse Data Warehouse (DWH) using the credentials provided. For more detailed information, please refer to <a href="https://clickhouse.com/docs/en/integrations/datagrip" target="_blank" rel="noopener noreferrer">this link</a>.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="connecting-to-bi-tools">Connecting to BI Tools<a class="hash-link" href="#connecting-to-bi-tools" title="Direct link to heading">â€‹</a></h3><p>Alternatively, you can connect to Business Intelligence (BI) tools of your choice to load the data from Clickhouse and build reports and dashboards. Many BI tools support direct integration with Clickhouse, allowing you to create visually appealing and interactive reports based on your data or alternatively you can make use of official <a href="https://github.com/ClickHouse/clickhouse-odbc/releases" target="_blank" rel="noopener noreferrer">Clickhouse ODBC driver</a> to establish the connection setup with Clickhouse.</p><blockquote><p><strong>Example</strong> - we will walk you through an example of connecting to Power BI to create a demo BI report for <code>Raven Energy GmbH</code>, an energy utility company with two distinct journeys and workflow processes for handling <code>Wallbox</code> and <code>Energieausweis</code> sales digitally. Each use case involves two products. We will leverage our Data Lake to set up a BI report for this scenario.</p></blockquote><p>To get started with the various ways to establish a connection between Clickhouse and PowerBI, please refer to <!-- -->[this link]<!-- --> (<a href="https://clickhouse.com/docs/en/integrations/powerbi" target="_blank" rel="noopener noreferrer">https://clickhouse.com/docs/en/integrations/powerbi</a>).</p><p>Steps to Create a Power BI Report:</p><ul><li><p><strong>Open Power BI</strong>: Once you have installed all the necessary dependencies to set up an ODBC connection as specified in the link above, you can add a new data source by selecting the ODBC option from the list of supported connectors.
<img alt="Power BI ODBC" src="/assets/images/powerbi-odbc-826ee26c6e4556feaecc36b0c2b33e95.png" width="1354" height="1320"></p></li><li><p><strong>Enter Connection Details</strong>: Enter the required connection details, including the ODBC connection, username, password, and the specific database. Then, click &quot;OK&quot; to establish the connection.</p></li></ul><p>Example ODBC Connection String -  <code>Driver={ClickHouse ODBC Driver (ANSI)};Server={replace-it-with-host};Port=8443;Database=datawarehouse;</code> </p><p><img alt="Power BI Connection" src="/assets/images/powerbi-connection-d7f7368a1631f36e767d9149c2e7c4f8.png" width="1398" height="1052"></p><ul><li><strong>Select Data</strong>: Once connected, Power BI will display the available schemas and tables. You can easily locate the &quot;entity_operations&quot; table within the &quot;datawarehouse&quot; schema, along with the &quot;{org_id}_current_entities_final&quot; simplified view for easier data access.</li></ul><p><img alt="Power BI Entity Operations" src="/assets/images/powerbi-entity-operations-86de3c142396214b27c5ea13d7ad3120.png" width="1758" height="1396"></p><ul><li><strong>Load or Transform Data</strong>: You have two options for data handling. You can click &quot;Load Data&quot; to load all the raw data directly into Power BI. Alternatively, you can click &quot;Transform&quot; to access Power BI&#x27;s query editor, where you can define your custom transformation logic to preprocess and shape the data to your specific requirements.</li></ul><p><img alt="Power BI Current Entities" src="/assets/images/powerbi-current-entities-dc3c5232582ae3f2d33880eb531e410c.png" width="1754" height="1384"></p><ul><li><strong>Data Modeling</strong>: After loading or transforming the data, you can begin setting up data models. Create relationships between different tables to enable seamless data exploration and reporting. For example, you can establish relationships between the entity_operations data and other relevant tables in your dataset.</li></ul><p><img alt="Power BI Data Model" src="/assets/images/powerbi-data-model-3e7e7fc48dde261f11f00554fb5a3e28.png" width="2682" height="590"></p><ul><li><strong>Report Creation</strong>: With the data modeling in place, you can start creating visually appealing reports within Power BI. Utilize various chart types, tables, and visuals to convey insights effectively.</li></ul><p><img alt="Power BI Report" src="/assets/images/powerbi-report-575b56af8a31334160dfe7aed52c26ca.png" width="2970" height="1354">
<img alt="Power BI Report" src="/assets/images/powerbi-journey-analytics-report-bc18aea7df800df9d8049ccb96ed7260.png" width="857" height="492"></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="interactive-powerbi-report-using-epilot-datalake">Interactive PowerBI report using Epilot Datalake<a class="hash-link" href="#interactive-powerbi-report-using-epilot-datalake" title="Direct link to heading">â€‹</a></h2><div><iframe title="raven bi" width="100%" height="600" src="https://app.powerbi.com/view?r=eyJrIjoiZDQ4MmQzNzAtODVlYy00MjdiLTg5ODMtNzVhNmMxOTU4OGUzIiwidCI6IjMzZDRmM2U1LTNkZjItNDIxZS1iOTJlLWE2M2NmYTY4MGE4OCJ9" frameborder="0" allowfullscreen=""></iframe></div><p>Our Data Lake feature provides a powerful way to capture and analyze real-time entity operations, enabling you to gain valuable insights from your data. By understanding the data schema and following the steps to set up credentials, you can leverage this feature to build reports, perform analytics, and make data-driven decisions for your organization.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="interactive-powerbi-report-for-journey-analytics-using-epilot-datalake">Interactive PowerBI report for Journey Analytics using Epilot Datalake<a class="hash-link" href="#interactive-powerbi-report-for-journey-analytics-using-epilot-datalake" title="Direct link to heading">â€‹</a></h2><div><iframe title="raven bi" width="100%" height="600" src="https://app.powerbi.com/view?r=eyJrIjoiZGM2MjI0NzgtZGQ2Zi00NzVjLWFmYjAtZDdhOWVkNmJhYzFiIiwidCI6IjMzZDRmM2U1LTNkZjItNDIxZS1iOTJlLWE2M2NmYTY4MGE4OCJ9" frameborder="0" allowfullscreen=""></iframe></div><p>Our Journey Analytics Data lake feature offers a comprehensive solution to track and analyze user journeys in real-time, providing you with deep insights into how users interact with your journeys. By capturing detailed event data, such as step navigations, form submissions, and user exits, you can gain a clear understanding of user behavior and identify opportunities for optimization.</p><p>You can also refer to the following link to establish connection to <a href="https://clickhouse.com/docs/en/integrations/data-visualization" target="_blank" rel="noopener noreferrer">different BI tools.</a></p><p>If you have any further questions or need assistance with data queries, please reach out to our team.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/epilot-dev/docs/edit/main/docs/datalake/epilot-datalake.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/integrations/3rd-party-journeys"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Example: 3rd Party Journey</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/sso/single-sign-on"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Single Sign On</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-schemas" class="table-of-contents__link toc-highlight">Data Schemas</a><ul><li><a href="#1-entity-operations-event-streams" class="table-of-contents__link toc-highlight">1. Entity Operations Event Streams</a></li><li><a href="#2-workflow-execution-snapshots" class="table-of-contents__link toc-highlight">2: Workflow Execution Snapshots</a></li><li><a href="#3-journey-analytics" class="table-of-contents__link toc-highlight">3. Journey Analytics</a></li><li><a href="#4-portal-analytics" class="table-of-contents__link toc-highlight">4. Portal Analytics</a></li></ul></li><li><a href="#setting-up-datalake" class="table-of-contents__link toc-highlight">Setting up Datalake</a><ul><li><a href="#generate-datalake-credentials" class="table-of-contents__link toc-highlight">Generate datalake credentials</a></li></ul></li><li><a href="#querying-the-data" class="table-of-contents__link toc-highlight">Querying the Data</a><ul><li><a href="#directly-quering-via-sql" class="table-of-contents__link toc-highlight">Directly Quering via SQL</a></li><li><a href="#connecting-to-bi-tools" class="table-of-contents__link toc-highlight">Connecting to BI Tools</a></li></ul></li><li><a href="#interactive-powerbi-report-using-epilot-datalake" class="table-of-contents__link toc-highlight">Interactive PowerBI report using Epilot Datalake</a></li><li><a href="#interactive-powerbi-report-for-journey-analytics-using-epilot-datalake" class="table-of-contents__link toc-highlight">Interactive PowerBI report for Journey Analytics using Epilot Datalake</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/api">REST API Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/graphql/sharing">Graphql API Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/architecture/sdk">SDK</a></li></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items"><li class="footer__item"><a href="https://portal.epilot.cloud" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Portal login<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/epilot-dev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://dev.to/epilot" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://docs.epilot.io/techradar" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Tech Radar<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/epilot-dev/engineering-principles" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Engineering Principles<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">&copy; epilot.cloud 2025</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c8c37d84.js"></script>
<script src="/assets/js/main.debc8871.js"></script>
</body>
</html>