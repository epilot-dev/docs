"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[89503],{35722:(t,e,o)=>{o.d(e,{G:()=>s});var a=o(42858),n=o(67294),i=o(25108);let r=0,l=!1;const d=(t,e)=>{const o=t?.getAttribute("data-theme")??"light",a="dark"===o?"dark":"default";return e?.theme?.[o]??e?.mermaid?.theme??a},s=t=>{let{chart:e,config:o}=t;const s=(0,n.useRef)(null),c=(0,n.useRef)("mermaid-"+r++),[p,m]=(0,n.useState)(""),u=(0,n.useMemo)((()=>"string"==typeof o?JSON.parse(o):o),[o]);return(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const t=document.querySelector("html"),o=d(t,u);l||(a.Z.initialize({startOnLoad:!1,theme:o,...u?.mermaid||{}}),l=!0);(async()=>{try{const{svg:t}=await a.Z.render(c.current,e);m(t)}catch(t){i.error("Mermaid rendering failed:",t)}})()}),[e,u]),(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const t=document.querySelector("html"),o=new MutationObserver((o=>{for(const n of o){if("attributes"!==n.type||"data-theme"!==n.attributeName)continue;const o=d(t,u);l=!1,a.Z.initialize({startOnLoad:!1,theme:o,...u?.mermaid||{}}),l=!0,c.current="mermaid-"+r++,a.Z.render(c.current,e).then((t=>{let{svg:e}=t;m(e)}));break}}));return o.observe(t,{attributes:!0}),()=>o.disconnect()}),[e,u]),"undefined"==typeof window?n.createElement("div",{className:"mermaid"},e):n.createElement("div",{ref:s,dangerouslySetInnerHTML:{__html:p}})}},47495:(t,e,o)=>{o.r(e),o.d(e,{contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var a=o(87462),n=(o(67294),o(3905));o(35722);const i={title:"Portal Webhooks",sidebar_position:4},r="Portal Webhooks",l={unversionedId:"portals/portal-webhooks",id:"portals/portal-webhooks",title:"Portal Webhooks",description:"Portal-specific webhooks let you integrate external applications with activities that occur inside customer and installer portals.",source:"@site/docs/portals/portal-webhooks.md",sourceDirName:"portals",slug:"/portals/portal-webhooks",permalink:"/docs/portals/portal-webhooks",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/portals/portal-webhooks.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Portal Webhooks",sidebar_position:4},sidebar:"docsSidebar",previous:{title:"Mobile App",permalink:"/docs/portals/mobile-app"},next:{title:"Overview",permalink:"/docs/automation/intro"}},d=[{value:"Setup",id:"setup",children:[],level:2},{value:"Webhook Payload",id:"webhook-payload",children:[],level:2},{value:"Activity Types",id:"activity-types",children:[],level:2}],s={toc:d},c="wrapper";function p(t){let{components:e,...i}=t;return(0,n.kt)(c,(0,a.Z)({},s,i,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"portal-webhooks"},"Portal Webhooks"),(0,n.kt)("p",null,"Portal-specific webhooks let you integrate external applications with activities that occur inside customer and installer portals."),(0,n.kt)("h2",{id:"setup"},"Setup"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Configure a webhook that includes the portal activity:")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Doc Downloaded Webhook",src:o(29271).Z,width:"2324",height:"1222"})),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"Go to ",(0,n.kt)("strong",{parentName:"li"},"Automations"),' and create a new automation with a portal-specific trigger (e.g. "File Activity: File Downloaded from portal"):')),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Doc Downloaded Automation Trigger",src:o(73502).Z,width:"2108",height:"642"})),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"Add an action to the automation and select the webhook you created:")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Doc Downloaded Automation Action",src:o(4057).Z,width:"2324",height:"688"})),(0,n.kt)("h2",{id:"webhook-payload"},"Webhook Payload"),(0,n.kt)("p",null,"The webhook message contains the full ",(0,n.kt)("inlineCode",{parentName:"p"},"entity")," involved in the activity. The ",(0,n.kt)("inlineCode",{parentName:"p"},"activity")," object includes the activity ",(0,n.kt)("inlineCode",{parentName:"p"},"type")," and ",(0,n.kt)("inlineCode",{parentName:"p"},"caller")," information identifying the portal user who triggered it."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Example: DocDownloadedFromPortal"',title:'"Example:','DocDownloadedFromPortal"':!0},'{\n    "metadata": {\n        "webhook_id": "17DwnAQo8zZaJWCQ5HaZhC",\n        "organization_id": "739224"\n    },\n    "entity": {\n        "_schema": "file",\n        "_id": "78794089-343c-4bcd-97a1-9b307c3ac040",\n        "_org": "739224",\n        ...other entity attributes\n    },\n    "activity": {\n        "type": "DocDownloadedFromPortal",\n        "title": "Portal user downloaded the file",\n        "message": "Portal user {{entity payload.caller.portalUserId}} has downloaded the file {{entity payload.entity._id}}.",\n        "payload": {\n            "caller": {\n                "portal_user_id": "bed23253-b00b-4a09-8815-2bc87c69ae97",\n                "contact_entity_id": "78794089-343c-4bcd-97a1-9b307c3ac040",\n                "email": "portal.user@example.com",\n                "portal_origin": "END_CUSTOMER_PORTAL"\n            },\n            "entity": {\n                "_id": "78794089-343c-4bcd-97a1-9b307c3ac040",\n                "_schema": "file",\n                "_org": "739224"\n            },\n            "orgId": "739224"\n        },\n        "_org": "739224",\n        "_id": "01HCYQ73MPPQDR5ZHV1GQ25CZY",\n        "timestamp": "2023-10-17T11:44:25.238Z",\n        "operations": [\n            null\n        ]\n    }\n}\n')),(0,n.kt)("h2",{id:"activity-types"},"Activity Types"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},"Type"),(0,n.kt)("th",{parentName:"tr",align:null},"Automation Trigger"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("inlineCode",{parentName:"td"},"DocDownloadedFromPortal")),(0,n.kt)("td",{parentName:"tr",align:null},"File Activity: File Downloaded from portal")))))}p.isMDXComponent=!0},4057:(t,e,o)=>{o.d(e,{Z:()=>a});const a=o.p+"assets/images/doc-downloaded-automation-action-58c761e2f73ffcddd0671458116e1288.png"},73502:(t,e,o)=>{o.d(e,{Z:()=>a});const a=o.p+"assets/images/doc-downloaded-automation-trigger-9d790ac530898fd5dfa3469001c96edf.png"},29271:(t,e,o)=>{o.d(e,{Z:()=>a});const a=o.p+"assets/images/doc-downloaded-webhook-9bba447708674228ff6e222c243f8293.png"}}]);