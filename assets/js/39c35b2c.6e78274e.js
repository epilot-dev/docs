"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[5731],{3905:(e,t,n)=>{n.d(t,{Zo:()=>h,kt:()=>m});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},h=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,h=s(e,["components","mdxType","originalType","parentName"]),c=u(n),p=a,m=c["".concat(l,".").concat(p)]||c[p]||d[p]||i;return n?o.createElement(m,r(r({ref:t},h),{},{components:n})):o.createElement(m,r({ref:t},h))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,r=new Array(i);r[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,r[1]=s;for(var u=2;u<i;u++)r[u]=n[u];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},20728:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>r,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var o=n(87462),a=(n(67294),n(3905));const i={sidebar_position:14},r="Webhooks",s={unversionedId:"webhooks",id:"webhooks",title:"Webhooks",description:"[API Docs]",source:"@site/docs/webhooks.md",sourceDirName:".",slug:"/webhooks",permalink:"/docs/webhooks",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/webhooks.md",tags:[],version:"current",sidebarPosition:14,frontMatter:{sidebar_position:14},sidebar:"appsSidebar",previous:{title:"Audit logs",permalink:"/docs/audit-logs"},next:{title:"Overview",permalink:"/docs/workflows/intro"}},l=[{value:"Data Transmission",id:"data-transmission",children:[{value:"What is Transfer-Encoding: chunked?",id:"what-is-transfer-encoding-chunked",children:[],level:3},{value:"Why is This Important?",id:"why-is-this-important",children:[],level:3},{value:"Limitations",id:"limitations",children:[],level:3}],level:2},{value:"Webhook Payload Structure",id:"webhook-payload-structure",children:[],level:2},{value:"Webhook Events",id:"webhook-events",children:[],level:2},{value:"Testing Webhook Configurations",id:"testing-webhook-configurations",children:[],level:2},{value:"Synchronous invocation",id:"synchronous-invocation",children:[{value:"Limitations",id:"limitations-1",children:[],level:3}],level:2},{value:"Customization",id:"customization",children:[{value:"Payload configuration",id:"payload-configuration",children:[],level:3},{value:"Custom header",id:"custom-header",children:[],level:3},{value:"Custom oauth parameter",id:"custom-oauth-parameter",children:[],level:3}],level:2},{value:"Limitations",id:"limitations-2",children:[{value:"Timeout",id:"timeout",children:[],level:3}],level:2}],u={toc:l},h="wrapper";function c(e){let{components:t,...i}=e;return(0,a.kt)(h,(0,o.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"webhooks"},"Webhooks"),(0,a.kt)("p",null,"[",(0,a.kt)("a",{parentName:"p",href:"/api/webhooks"},"API Docs"),"]\n[",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/webhooks-client"},"SDK"),"]"),(0,a.kt)("p",null,"The epilot ",(0,a.kt)("a",{parentName:"p",href:"/api/webhooks"},"Webhooks API")," provides the possibility to subscribe to epilot public events. This will allow you to receive notifications with payload to your configured webhook URL every time events happen in your account."),(0,a.kt)("p",null,"This document describes the steps how to configure hooks, subscribe to events and how to manage those configurations. Service is reachable using https connection to ensure encryption between client and service."),(0,a.kt)("p",null,"Webhooks can be comfortably configured and managed by admin users in epilot portal."),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"/api/webhooks"},"Webhooks API Documentation")),(0,a.kt)("h2",{id:"data-transmission"},"Data Transmission"),(0,a.kt)("p",null,"Webhooks do use the ",(0,a.kt)("inlineCode",{parentName:"p"},"Transfer-Encoding: chunked")," mechanism when sending HTTP requests. This applies to webhook payloads triggered by various events in the system, ensuring that data is efficiently transmitted to your server."),(0,a.kt)("h3",{id:"what-is-transfer-encoding-chunked"},"What is Transfer-Encoding: chunked?"),(0,a.kt)("p",null,"The Transfer-Encoding: chunked header is used in HTTP/1.1 to send data in small, manageable chunks rather than all at once. With this method, the total size of the content doesn\u2019t need to be known in advance, and data can be sent progressively."),(0,a.kt)("h3",{id:"why-is-this-important"},"Why is This Important?"),(0,a.kt)("p",null,"When receiving webhook events from our system:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},'Chunked Data Transfer: The HTTP request body will arrive in parts (or "chunks"), each sent with its own size indicator. This means your server will need to handle and process the data as it arrives.')),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Streaming Efficiency: This method allows us to stream data efficiently, especially for large payloads, ensuring that your server gets the data without needing to wait for the entire payload to be generated.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Completion Signal: The transfer is complete when a zero-length chunk is sent, signaling the end of the payload.\nHow to Handle Chunked Webhook Requests\nTo ensure proper handling of our webhook payloads, your server must:")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Support chunked transfer encoding: Most modern web servers handle this automatically, but ensure your environment does not reject or misinterpret chunked data.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"Process Data in Chunks: If necessary, ensure your application processes the incoming data incrementally as it arrives.")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"End-of-Transfer Detection: Be aware that the payload transmission is complete when a final, empty chunk is received."))),(0,a.kt)("h3",{id:"limitations"},"Limitations"),(0,a.kt)("p",null,"The chunked transfer encoding mechanism is not supported by all servers. If your server does not support this feature, please contact our support team for assistance."),(0,a.kt)("p",null,"Already known services which do not support chunked transfer encoding are:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://www.microsoft.com/de-de/power-platform/products/power-automate?market=de"},"Microsoft Power Automate"))),(0,a.kt)("h2",{id:"webhook-payload-structure"},"Webhook Payload Structure"),(0,a.kt)("p",null,"You can use the Entity API to get a full ",(0,a.kt)("a",{parentName:"p",href:"/api/entity#tag/Schemas/operation/getJsonSchema"},"JSON schema")," and a ",(0,a.kt)("a",{parentName:"p",href:"/api/entity#tag/Schemas/operation/getSchemaExample"},"JSON example")," of an entity part of your webhook. Alternatively, you can download these from the epilot portal for each of your entities from the entity builder UI."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Export Entity Schema",src:n(77516).Z,width:"464",height:"163"})),(0,a.kt)("h2",{id:"webhook-events"},"Webhook Events"),(0,a.kt)("p",null,"You can view and filter failed and succesful events and its details. Every event can be replayed. The replay will send the same payload and creates a new event afterwards. By default, all events are persisted for 4 weeks. "),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Webhook Events",src:n(16205).Z,width:"800",height:"527"})),(0,a.kt)("h2",{id:"testing-webhook-configurations"},"Testing Webhook Configurations"),(0,a.kt)("p",null,"The webhook configuration can be tested by sending a test request to the configured URL. This feature allows users to verify the webhook configuration and ensure that the request is being sent to the correct endpoint. The test request will include a sample payload, allowing users to verify that the webhook is functioning as expected. This sample payload can be either customized or a entity schema can be used."),(0,a.kt)("h2",{id:"synchronous-invocation"},"Synchronous invocation"),(0,a.kt)("p",null,"To get immediate feedback on the success of a webhook request, the webhook can be configured to be invoked synchronously. This will cause the webhook to wait for the response of the request before proceeding. If the request fails, the webhook will be flagged as unsuccessful. This feature has to be enabled in the webhook action of the automation configuration.\n",(0,a.kt)("img",{alt:"Option to enable sync webhooks",src:n(50480).Z,width:"1232",height:"398"})),(0,a.kt)("h3",{id:"limitations-1"},"Limitations"),(0,a.kt)("p",null,"Sync webhooks are limited to a maximum duration of 30 seconds. If the request exceeds this time limit, it will be automatically aborted, prompting the webhook to retry the request up to 2 times. If, after these retries, the request continues to fail, the webhook will be flagged as unsuccessful."),(0,a.kt)("h2",{id:"customization"},"Customization"),(0,a.kt)("h3",{id:"payload-configuration"},"Payload configuration"),(0,a.kt)("p",null,"Customizing the payload of an incoming webhook request is entirely feasible. The standard structure for this customization typically follows this general format:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},"{\n   metadata: {\n    organization_id: '',\n    ...\n   }, // always present\n   entity: {} // always present,\n   relations: {} // optional,\n   activity: {} // optional,\n   changed_attributes: {\n      added: {},\n      deleted: {},\n      updated: {}\n   } // optional\n}\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Include Changed Attributes",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"shows the ",(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"changed"))," added|deleted|updated attributes ",(0,a.kt)("strong",{parentName:"li"},(0,a.kt)("em",{parentName:"strong"},"after"))," the event"),(0,a.kt)("li",{parentName:"ul"},"important note: this will only be included if the event is a change event e.g. an ",(0,a.kt)("inlineCode",{parentName:"li"},"Entity update: Opportunity")," automation trigger. Manual trigger will not fill changed attribures."))),(0,a.kt)("li",{parentName:"ul"},"Include Activity"),(0,a.kt)("li",{parentName:"ul"},"Include Relations",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"hydrated")," relations to other entities"),(0,a.kt)("li",{parentName:"ul"},"important note: including this can increase the payload size significantly")))),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Custom Webhook Payload Configuration",src:n(90998).Z,width:"1990",height:"898"})),(0,a.kt)("h3",{id:"custom-header"},"Custom header"),(0,a.kt)("p",null,"Custom headers can be added to the webhook request to provide additional information or authentication. This feature allows users to include custom headers in the webhook request, enhancing the security and customization options available for webhook configurations."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Custom Webhook Header",src:n(22543).Z,width:"1186",height:"428"})),(0,a.kt)("p",null,"The following headers are forbidden and will be removed from the request:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"    'x-epilot-org-id',\n    'x-ivy-org-id',\n    'Authorization',\n    'A-IM',\n    'Accept-Charset',\n    'Accept-Datetime',\n    'Accept-Encoding',\n    'Cache-Control',\n    'Connection',\n    'Content-Length',\n    'Content-Encoding',\n    'Transfer-Encoding',\n    'Host',\n    'Content-Type',\n    'Content-Range',\n    'Content-MD5',\n    'Range',\n    'User-Agent',\n    'Date',\n    'Expect',\n    'Forwarded',\n    'From',\n    'Host',\n    'HTTP2-Settings',\n    'If-Match',\n    'If-Modified-Since',\n    'If-None-Match',\n    'If-Range',\n    'If-Unmodified-Since',\n    'Max-Forwards',\n    'Origin',\n    'Pragma',\n    'Proxy-Authorization',\n    'Referer',\n    'Server',\n    'TE',\n    'Trailer',\n    'Transfer-Encoding',\n    'Upgrade',\n    'Via',\n    'Warning',\n    'x-forwarded-*',\n    'x-amz-*',\n    'x-amzn-*'\n")),(0,a.kt)("h3",{id:"custom-oauth-parameter"},"Custom oauth parameter"),(0,a.kt)("p",null,"Custom OAuth parameters can be seamlessly integrated into the webhook configuration process. These parameters can be included as part of the OAuth request, appended as body, query, or header parameters. This feature empowers users to augment the OAuth request with supplementary information as needed, enhancing the flexibility and customization options within the authentication flow."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Custom Webhook Ouath Parameter",src:n(47435).Z,width:"954",height:"1102"})),(0,a.kt)("h2",{id:"limitations-2"},"Limitations"),(0,a.kt)("h3",{id:"timeout"},"Timeout"),(0,a.kt)("p",null,"As previously mentioned, the webhook request times out after 30 seconds for synchronous webhooks. For asynchronous webhooks, the request will not time out, but the webhook will be flagged as unsuccessful if the request takes longer than 2 minutes to complete. This is to prevent the webhook from being stuck in a pending state indefinitely. Contact support if you need to increase this timeout. Keep in mind that for long running requests, it is recommend to handle them asynchronously on the 3rd party side and return a 202 Accepted response to the webhook request."))}c.isMDXComponent=!0},50480:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/automation-sync-webhook-be6a42bccc4e22ec84f6ef4f34da2007.png"},77516:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/export-entity-schema-15a09578778b7b08492f5659ee3e123f.png"},22543:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/custom-header-a6596c0a6920e984be22411a65f732e3.png"},47435:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/custom-oauth-b9ad4aafa692632ee4d4e17a1d1abfab.png"},90998:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/custom-payload-5f4ae66c6785463dc95e484832eca2dc.png"},16205:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"assets/images/events-36fe43b05965174ca6ff277d34ab0feb.gif"}}]);