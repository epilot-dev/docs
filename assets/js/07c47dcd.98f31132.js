"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[17442],{35722:(e,t,a)=>{a.d(t,{G:()=>d});var n=a(42858),r=a(67294),i=a(25108);let l=0,s=!1;const o=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??n},d=e=>{let{chart:t,config:a}=e;const d=(0,r.useRef)(null),u=(0,r.useRef)("mermaid-"+l++),[p,c]=(0,r.useState)(""),m=(0,r.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=o(e,m);s||(n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),s=!0);(async()=>{try{const{svg:e}=await n.Z.render(u.current,t);c(e)}catch(e){i.error("Mermaid rendering failed:",e)}})()}),[t,m]),(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const r of a){if("attributes"!==r.type||"data-theme"!==r.attributeName)continue;const a=o(e,m);s=!1,n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),s=!0,u.current="mermaid-"+l++,n.Z.render(u.current,t).then((e=>{let{svg:t}=e;c(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,m]),"undefined"==typeof window?r.createElement("div",{className:"mermaid"},t):r.createElement("div",{ref:d,dangerouslySetInnerHTML:{__html:p}})}},37556:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>s,default:()=>c,frontMatter:()=>l,metadata:()=>o,toc:()=>d});var n=a(87462),r=(a(67294),a(3905)),i=a(35722);const l={sidebar_position:6,title:"Continuous Delivery"},s="Continuous Delivery",o={unversionedId:"architecture/continuous-delivery",id:"architecture/continuous-delivery",title:"Continuous Delivery",description:"epilot ships over 200 production deployments per week using trunk-based development and automated pipelines. Every merge to main triggers a deployment through staging to production, gated by end-to-end tests.",source:"@site/docs/architecture/continuous-delivery.md",sourceDirName:"architecture",slug:"/architecture/continuous-delivery",permalink:"/docs/architecture/continuous-delivery",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/architecture/continuous-delivery.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"Continuous Delivery"},sidebar:"docsSidebar",previous:{title:"Serverless",permalink:"/docs/architecture/serverless"},next:{title:"Open Source",permalink:"/docs/architecture/open-source"}},d=[{value:"Release Channels",id:"release-channels",children:[{value:"Stable (Monthly Releases)",id:"stable-monthly-releases",children:[],level:3},{value:"Canary (Continuous Updates)",id:"canary-continuous-updates",children:[],level:3},{value:"How Customers Choose",id:"how-customers-choose",children:[],level:3},{value:"Hotfixes and Patches",id:"hotfixes-and-patches",children:[],level:3}],level:2},{value:"Deployment Pipeline",id:"deployment-pipeline",children:[{value:"Frontend Deployments",id:"frontend-deployments",children:[],level:3},{value:"Backend Deployments",id:"backend-deployments",children:[],level:3}],level:2},{value:"Feature Flags",id:"feature-flags",children:[],level:2},{value:"Testing Strategy",id:"testing-strategy",children:[{value:"Unit Tests",id:"unit-tests",children:[],level:3},{value:"End-to-End Tests (Playwright)",id:"end-to-end-tests-playwright",children:[],level:3},{value:"Performance Benchmarks",id:"performance-benchmarks",children:[],level:3}],level:2},{value:"Release Quality Process",id:"release-quality-process",children:[],level:2},{value:"Monitoring and Rollback",id:"monitoring-and-rollback",children:[],level:2},{value:"Further Reading",id:"further-reading",children:[],level:2}],u={toc:d},p="wrapper";function c(e){let{components:t,...a}=e;return(0,r.kt)(p,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"continuous-delivery"},"Continuous Delivery"),(0,r.kt)("p",null,"epilot ships over 200 production deployments per week using trunk-based development and automated pipelines. Every merge to ",(0,r.kt)("inlineCode",{parentName:"p"},"main")," triggers a deployment through staging to production, gated by end-to-end tests."),(0,r.kt)("p",null,"To balance speed with stability, epilot operates two release channels: ",(0,r.kt)("strong",{parentName:"p"},"Canary")," for continuous updates and ",(0,r.kt)("strong",{parentName:"p"},"Stable")," for curated, periodic releases."),(0,r.kt)("h2",{id:"release-channels"},"Release Channels"),(0,r.kt)("h3",{id:"stable-monthly-releases"},"Stable (Monthly Releases)"),(0,r.kt)("p",null,"The Stable channel receives curated, tested releases on a regular cadence. Usually about 1 month between releases. Each release goes through a structured acceptance testing period before publication."),(0,r.kt)("p",null,"Stable releases are assembled by snapshotting tested versions of all frontend microservices into a ",(0,r.kt)("inlineCode",{parentName:"p"},"stable-importmap.json"),", which is served to organizations on the Stable channel."),(0,r.kt)("p",null,"During the release, new features are rolled out using feature flags."),(0,r.kt)("h3",{id:"canary-continuous-updates"},"Canary (Continuous Updates)"),(0,r.kt)("p",null,"The Canary channel receives new deployments in real-time. Code merged to ",(0,r.kt)("inlineCode",{parentName:"p"},"main")," flows through staging, passes automated tests, and usually gets shipped to production within minutes."),(0,r.kt)("p",null,"Canary is treated as a critical production environment with high stability, however changes happen more frequently and might lack official communication at times."),(0,r.kt)("p",null,"For this reason, canary is suitable for:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Sandboxes"),(0,r.kt)("li",{parentName:"ul"},"Validating upcoming features"),(0,r.kt)("li",{parentName:"ul"},"Customers who want early access to new capabilities")),(0,r.kt)("h3",{id:"how-customers-choose"},"How Customers Choose"),(0,r.kt)("p",null,"Organizations select their preferred release channel in the epilot 360 portal settings. The default is Stable."),(0,r.kt)("p",null,"Individual users can also override the organization default from their account settings -- useful for administrators who want to preview upcoming changes without switching the entire organization to Canary."),(0,r.kt)("h3",{id:"hotfixes-and-patches"},"Hotfixes and Patches"),(0,r.kt)("p",null,"Critical issues affecting Stable customers are addressed immediately through two mechanisms:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Hotfix tags")," (",(0,r.kt)("inlineCode",{parentName:"li"},"hotfix-*"),") -- deploy directly to the Stable import map, skipping E2E tests for speed. Reserved for critical production issues."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Patch tags")," (",(0,r.kt)("inlineCode",{parentName:"li"},"patch-*"),") -- deploy to the Stable import map after running the full pipeline with E2E tests and manual approval. Used for non-urgent fixes between scheduled releases.")),(0,r.kt)("p",null,"We try to minimize the usage of both mechanisms, but especially hotfixes should only be used in rare occasions, usually related to a critical bugfix or incident response."),(0,r.kt)("h2",{id:"deployment-pipeline"},"Deployment Pipeline"),(0,r.kt)("p",null,"All services follow trunk-based development. There are no long-lived feature branches or release branches."),(0,r.kt)(i.G,{chart:"flowchart TD\n    A[Merge to main] --\x3e B[Deploy to staging]\n    B --\x3e C[E2E tests on staging]\n    C --\x3e|Pass| D[Deploy to production]\n    C --\x3e|Fail| E[Block deployment + alert]\n    D --\x3e F[E2E tests on production]\n    F --\x3e|Pass| G[Done - live on Canary]\n    F --\x3e|Fail| H[Alert + rollback]",mdxType:"Mermaid"}),(0,r.kt)("h3",{id:"frontend-deployments"},"Frontend Deployments"),(0,r.kt)("p",null,"The epilot 360 portal is a ",(0,r.kt)("a",{parentName:"p",href:"/docs/architecture/microfrontends"},"single-spa micro-frontend architecture"),". Each microfrontend deploys independently and updates an import map that the portal shell reads at load time."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Trigger"),(0,r.kt)("th",{parentName:"tr",align:null},"Import map updated"),(0,r.kt)("th",{parentName:"tr",align:null},"Channel"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Merge to ",(0,r.kt)("inlineCode",{parentName:"td"},"main")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"systemjs-importmap.json")),(0,r.kt)("td",{parentName:"tr",align:null},"Canary")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"stable-*")," tag"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"stable-importmap.json")),(0,r.kt)("td",{parentName:"tr",align:null},"Stable")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"hotfix-*")," tag"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"stable-importmap.json")),(0,r.kt)("td",{parentName:"tr",align:null},"Stable")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"patch-*")," tag"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"stable-importmap.json")," (with manual approval)"),(0,r.kt)("td",{parentName:"tr",align:null},"Stable")))),(0,r.kt)("p",null,"Because APIs maintain backward compatibility, Stable frontend versions continue to work correctly even as backend services are updated continuously."),(0,r.kt)("h3",{id:"backend-deployments"},"Backend Deployments"),(0,r.kt)("p",null,"Backend services (AWS Lambda, Step Functions, CDK stacks) deploy through the same pipeline: staging, E2E tests, then production. Backend deployments always go live for all customers -- the Canary/Stable split applies only to frontend microfrontends."),(0,r.kt)("h2",{id:"feature-flags"},"Feature Flags"),(0,r.kt)("p",null,"epilot uses ",(0,r.kt)("a",{parentName:"p",href:"https://launchdarkly.com/"},"LaunchDarkly")," for feature flag management, enabling progressive rollout of new capabilities independent of deployments."),(0,r.kt)("p",null,"Feature flags serve several purposes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Ship incomplete work safely.")," Code deploys continuously to production behind flags, decoupling deployment from release."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Gradual rollout.")," Enable features for specific organizations, user segments, or percentages of traffic."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Instant rollback.")," Disable a feature without redeploying code."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Per-environment control.")," Enable features in staging for testing before production.")),(0,r.kt)("p",null,"Flags are evaluated at runtime using the organization ID (and optionally user ID) as the targeting context, enabling fine-grained control over feature availability per customer."),(0,r.kt)("h2",{id:"testing-strategy"},"Testing Strategy"),(0,r.kt)("h3",{id:"unit-tests"},"Unit Tests"),(0,r.kt)("p",null,"All services implement unit testing with high (usually >80%) code coverage. Integration tests against AWS services use ",(0,r.kt)("a",{parentName:"p",href:"https://localstack.cloud/"},"LocalStack")," running as a Docker service in CI."),(0,r.kt)("h3",{id:"end-to-end-tests-playwright"},"End-to-End Tests (Playwright)"),(0,r.kt)("p",null,"A centralized Playwright test suite runs against the full application in staging and production as part of every deployment pipeline. These tests act as the primary deployment gate -- if they fail on staging, the deployment to production is blocked."),(0,r.kt)("p",null,"The E2E test suite covers critical user workflows across the platform: entity management, journeys, workflows, messaging, portals, and more."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Key practices:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Page Object Models")," encapsulate UI interactions, improving test readability and reducing locator duplication across test files."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"User-visible locators")," (",(0,r.kt)("inlineCode",{parentName:"li"},"getByRole"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"getByLabel"),") are preferred over implementation-coupled selectors (",(0,r.kt)("inlineCode",{parentName:"li"},"locator('.css-class')"),"), making tests resilient to UI refactors."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Test isolation")," -- each test manages its own data setup and teardown, enabling parallel execution and reliable retries.")),(0,r.kt)("h3",{id:"performance-benchmarks"},"Performance Benchmarks"),(0,r.kt)("p",null,"Playwright test durations are monitored via Datadog. Alerts fire when key user flows exceed duration thresholds, surfacing both performance regressions and flaky tests early."),(0,r.kt)("h2",{id:"release-quality-process"},"Release Quality Process"),(0,r.kt)("p",null,"Each Stable release follows a structured quality gate:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Breakathon."),' Teams take time to stress test and find ways to "break" their own features to uncover new bugs.'),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Acceptance testing.")," A minimum 3-day testing period where QA engineers and cross-functional colleagues validate the release candidate."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Release readiness criteria.")," All automated tests passing, QA playbooks completed, no known bugs, no open translation issues."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Release.")," The stable import map is updated, feature toggles are switched, and release notes are published."),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Post-release monitoring.")," Bug reports in the first 7 days after release are tracked and analyzed to improve future releases.")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"epilot's API-first architecture means backend services maintain strict backward compatibility. Stable frontend versions are fully compatible with continuously updated backend APIs -- there are no version lock-in concerns."))),(0,r.kt)("h2",{id:"monitoring-and-rollback"},"Monitoring and Rollback"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"E2E tests on production")," run immediately after every deployment. Failures trigger alerts and automatic rollback."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Real-time error monitoring")," via Datadog catches issues that automated tests miss."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Feature flags")," provide instant kill switches for new functionality without requiring a rollback deployment."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Hotfix pipeline")," enables emergency patches to reach Stable customers within minutes when needed.")),(0,r.kt)("h2",{id:"further-reading"},"Further Reading"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/architecture/overview"},"Architecture Overview")," -- epilot's tech stack and system design"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/architecture/api-first"},"API First")," -- API design philosophy and backward compatibility"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/architecture/security"},"Security Architecture")," -- multi-tenant isolation and encryption")))}c.isMDXComponent=!0}}]);