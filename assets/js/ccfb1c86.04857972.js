"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[3730],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),m=p(n),d=a,g=m["".concat(s,".").concat(d)]||m[d]||c[d]||i;return n?r.createElement(g,o(o({ref:t},u),{},{components:n})):r.createElement(g,o({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3863:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return u},default:function(){return m}});var r=n(7462),a=n(3366),i=(n(7294),n(3905)),o=["components"],l={sidebar_position:3},s="Permissions",p={unversionedId:"auth/permissions",id:"auth/permissions",title:"Permissions",description:"[API Docs]",source:"@site/docs/auth/permissions.md",sourceDirName:"auth",slug:"/auth/permissions",permalink:"/docs/auth/permissions",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/auth/permissions.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Authorization",permalink:"/docs/auth/authorization"},next:{title:"Internal Auth",permalink:"/docs/auth/internal-auth"}},u=[{value:"Usage",id:"usage",children:[],level:2},{value:"Example Role",id:"example-role",children:[],level:2},{value:"Grants Evaluation Logic",id:"grants-evaluation-logic",children:[],level:2},{value:"Organization Root Role",id:"organization-root-role",children:[],level:2},{value:"Links",id:"links",children:[],level:2}],c={toc:u};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"permissions"},"Permissions"),(0,i.kt)("p",null,"[",(0,i.kt)("a",{parentName:"p",href:"/api/permissions"},"API Docs"),"]\n[",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/permissions"},"SDK"),"]"),(0,i.kt)("p",null,"Epilot implements flexible role-based access control using influenced by the design of AWS IAM policies."),(0,i.kt)("p",null,"The epilot Permissions system consists of these basic ideas:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Users")," may be assigned ",(0,i.kt)("strong",{parentName:"li"},"Roles")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Roles")," are collections of ",(0,i.kt)("strong",{parentName:"li"},"Grants")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Grants")," are used to evaluate whether the user has permissions to perform actions and access resources")),(0,i.kt)("h2",{id:"usage"},"Usage"),(0,i.kt)("p",null,"To use the epilot Permissions API, we provide a package that implements both fetching the user's roles and grants as well as evaluating them."),(0,i.kt)("p",null,"Example:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"import { tokenIsPermitted } from '@epilot/permissions';\n\nconst isPermitted = await tokenIsPermitted(token, 'myaction');\n")),(0,i.kt)("p",null,"Readme link: ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/permissions"},"@epilot/permissions")),(0,i.kt)("h2",{id:"example-role"},"Example Role"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'// Example manager role in org 66\n{\n  "id":"66:manager",\n  "name":"Manager",\n  "slug":"manager",\n  "organization_id":"66",\n  "type":"user_role",\n  "grants":[\n    {\n      "action":"entity:*",\n      "effect": "allow"\n    },\n    {\n      "action":"users:*",\n      "effect": "allow"\n    },\n    {\n      "action":"partners:*",\n      "effect": "allow"\n    },\n    {\n      "action":"legacy_products:*",\n      "effect": "allow"\n    }\n  ]\n')),(0,i.kt)("h2",{id:"grants-evaluation-logic"},"Grants Evaluation Logic"),(0,i.kt)("p",null,"A lot of this will be familiar to AWS IAM users. This is \u201cheavily inspired\u201d by their design  "),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Rule 1"),": Tenants are isolated into Organizations. Roles may only grant access to resources within the tenant Organization."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Rule 2"),": The owner role inherits all grants from the organization. (hardcoded role, present in all orgs)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Rule 3"),": By default roles have no grants until they are defined. (Principle of least privilege)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Rule 4"),": When evaluating all role and organization grants are added to the grant pool."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Rule 5"),": At least one organization role grant and at least one user role grant must be matched to pass the evaluation. Neither must contain a matched explicit deny."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Rule 6"),": An evaluation will try to match all available grants where a given action and resource matches. Wildcard expressions are supported.")),(0,i.kt)("h2",{id:"organization-root-role"},"Organization Root Role"),(0,i.kt)("p",null,"In addition to user roles, each user in the organization also has a mandatory root role when acting in the organization."),(0,i.kt)("p",null,"The organization root role defines the maximum set of grants any user in that organization may receive."),(0,i.kt)("p",null,"This role is only accessible to epilot admins and is controlled by the pricing tier of that organization."),(0,i.kt)("h2",{id:"links"},"Links"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Permissions package: ",(0,i.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/@epilot/permissions"},"https://www.npmjs.com/package/@epilot/permissions"))))}m.isMDXComponent=!0}}]);