"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[23727],{35722:(e,t,a)=>{a.d(t,{G:()=>d});var n=a(42858),l=a(67294),r=a(25108);let i=0,o=!1;const p=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??n},d=e=>{let{chart:t,config:a}=e;const d=(0,l.useRef)(null),s=(0,l.useRef)("mermaid-"+i++),[u,m]=(0,l.useState)(""),c=(0,l.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,l.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=p(e,c);o||(n.Z.initialize({startOnLoad:!1,theme:a,...c?.mermaid||{}}),o=!0);(async()=>{try{const{svg:e}=await n.Z.render(s.current,t);m(e)}catch(e){r.error("Mermaid rendering failed:",e)}})()}),[t,c]),(0,l.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const l of a){if("attributes"!==l.type||"data-theme"!==l.attributeName)continue;const a=p(e,c);o=!1,n.Z.initialize({startOnLoad:!1,theme:a,...c?.mermaid||{}}),o=!0,s.current="mermaid-"+i++,n.Z.render(s.current,t).then((e=>{let{svg:t}=e;m(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,c]),"undefined"==typeof window?l.createElement("div",{className:"mermaid"},t):l.createElement("div",{ref:d,dangerouslySetInnerHTML:{__html:u}})}},15489:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>p,toc:()=>d});var n=a(87462),l=(a(67294),a(3905)),r=a(35722);const i={sidebar_position:3,title:"Mobile App"},o="Mobile App",p={unversionedId:"portals/mobile-app",id:"portals/mobile-app",title:"Mobile App",description:"epilot portals can be distributed as native iOS and Android apps through the App Store and Google Play. The mobile app uses a hybrid shell architecture -- a minimal native wrapper that loads the portal web application, combining native distribution with web-speed iteration.",source:"@site/docs/portals/mobile-app.md",sourceDirName:"portals",slug:"/portals/mobile-app",permalink:"/docs/portals/mobile-app",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/portals/mobile-app.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,title:"Mobile App"},sidebar:"docsSidebar",previous:{title:"Metering",permalink:"/docs/portals/metering"},next:{title:"Portal Webhooks",permalink:"/docs/portals/portal-webhooks"}},d=[{value:"Architecture",id:"architecture",children:[{value:"Shell Approach",id:"shell-approach",children:[],level:3},{value:"Core Technology",id:"core-technology",children:[],level:3}],level:2},{value:"Native Capabilities",id:"native-capabilities",children:[],level:2},{value:"Per-Customer Branding",id:"per-customer-branding",children:[],level:2},{value:"Bundle Update Lifecycle",id:"bundle-update-lifecycle",children:[],level:2},{value:"Relationship to Web Portal",id:"relationship-to-web-portal",children:[],level:2}],s={toc:d},u="wrapper";function m(e){let{components:t,...a}=e;return(0,l.kt)(u,(0,n.Z)({},s,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"mobile-app"},"Mobile App"),(0,l.kt)("p",null,"epilot portals can be distributed as native iOS and Android apps through the App Store and Google Play. The mobile app uses a ",(0,l.kt)("strong",{parentName:"p"},"hybrid shell architecture")," -- a minimal native wrapper that loads the portal web application, combining native distribution with web-speed iteration."),(0,l.kt)("h2",{id:"architecture"},"Architecture"),(0,l.kt)(r.G,{chart:'flowchart TB\n    subgraph "Native Shell (Capacitor)"\n        CAP["Native Runtime\\n(iOS / Android)"]\n        PLUG["Native Plugins\\n(Camera, Push, Haptics)"]\n    end\n\n    subgraph "Web Layer"\n        ECP["End Customer Portal\\n(React SPA)"]\n    end\n\n    subgraph "Deployment"\n        S3["S3 Bundle Storage"]\n        STORE["App Store / Google Play"]\n    end\n\n    CAP --\x3e|WebView| ECP\n    ECP --\x3e PLUG\n    S3 --\x3e|OTA bundle update| CAP\n    CAP --\x3e|Initial install| STORE',mdxType:"Mermaid"}),(0,l.kt)("h3",{id:"shell-approach"},"Shell Approach"),(0,l.kt)("p",null,"The architecture separates the app into two independently deployable layers:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Layer"),(0,l.kt)("th",{parentName:"tr",align:null},"Contents"),(0,l.kt)("th",{parentName:"tr",align:null},"Update path"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Native shell")),(0,l.kt)("td",{parentName:"tr",align:null},"Capacitor runtime, native plugins, app icons, splash screens"),(0,l.kt)("td",{parentName:"tr",align:null},"App store submission (infrequent)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Web bundle")),(0,l.kt)("td",{parentName:"tr",align:null},"Portal UI (React), business logic, theming"),(0,l.kt)("td",{parentName:"tr",align:null},"Over-the-air from S3 (continuous)")))),(0,l.kt)("p",null,"On launch, the shell checks for a newer web bundle from S3. If a compatible update is available, it downloads and applies it before rendering -- no app store review required. This allows portal features and fixes to ship to mobile users as fast as to web users."),(0,l.kt)("h3",{id:"core-technology"},"Core Technology"),(0,l.kt)("p",null,"The native shell is built with ",(0,l.kt)("a",{parentName:"p",href:"https://capacitorjs.com/"},"Capacitor")," (v7), an open-source native runtime by Ionic. Capacitor renders the portal inside a native WebView and exposes a bridge to native device APIs."),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Component"),(0,l.kt)("th",{parentName:"tr",align:null},"Technology"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Native runtime"),(0,l.kt)("td",{parentName:"tr",align:null},"Capacitor 7")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Web framework"),(0,l.kt)("td",{parentName:"tr",align:null},"React (shared with web portal)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Build automation"),(0,l.kt)("td",{parentName:"tr",align:null},"Fastlane (iOS + Android)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Bundle tooling"),(0,l.kt)("td",{parentName:"tr",align:null},"Vite")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"CI"),(0,l.kt)("td",{parentName:"tr",align:null},"Bitrise")))),(0,l.kt)("h2",{id:"native-capabilities"},"Native Capabilities"),(0,l.kt)("p",null,"The mobile app extends the web portal with native device features:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Capability"),(0,l.kt)("th",{parentName:"tr",align:null},"Plugin"),(0,l.kt)("th",{parentName:"tr",align:null},"Use case"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Camera"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@capacitor/camera")),(0,l.kt)("td",{parentName:"tr",align:null},"Photo uploads, meter reading capture")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Push notifications"),(0,l.kt)("td",{parentName:"tr",align:null},"Capacitor Push"),(0,l.kt)("td",{parentName:"tr",align:null},"Real-time alerts for portal events")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Haptic feedback"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@capacitor/haptics")),(0,l.kt)("td",{parentName:"tr",align:null},"Tactile response on interactions")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Network detection"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@capacitor/network")),(0,l.kt)("td",{parentName:"tr",align:null},"Offline state handling")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"In-app browser"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@capacitor/browser")),(0,l.kt)("td",{parentName:"tr",align:null},"Opening external links")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Apple Sign-In"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@capacitor-community/apple-sign-in")),(0,l.kt)("td",{parentName:"tr",align:null},"Native SSO on iOS")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},"Status bar"),(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"@capacitor/status-bar")),(0,l.kt)("td",{parentName:"tr",align:null},"Themed status bar matching portal branding")))),(0,l.kt)("h2",{id:"per-customer-branding"},"Per-Customer Branding"),(0,l.kt)("p",null,"Each customer portal gets its own app store listing with fully custom branding:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"App name and ID")," (e.g., ",(0,l.kt)("inlineCode",{parentName:"li"},"de.twl.kundenportal"),")"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"App icon and splash screen")," (light and dark variants)"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Custom domain")," association for deep linking"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("strong",{parentName:"li"},"Publisher account")," -- customers can publish under their own Apple/Google developer account")),(0,l.kt)("p",null,'The build process ("charging the shell") takes a portal domain as input and produces a branded native app:'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"PORTAL_DOMAIN=kundenportal.twl.de npm run charge\n")),(0,l.kt)("p",null,"This injects the portal-specific configuration, assets, and web bundle into the native project, then builds platform binaries via Fastlane."),(0,l.kt)("h2",{id:"bundle-update-lifecycle"},"Bundle Update Lifecycle"),(0,l.kt)("p",null,"Web bundles follow the same release channels as the web portal:"),(0,l.kt)(r.G,{chart:'flowchart LR\n    COMMIT["ECP Commit"] --\x3e BUILD["Build Bundle"]\n    BUILD --\x3e S3C["S3: canary bundle"]\n    S3C --\x3e S3S["S3: stable bundle"]\n    S3S --\x3e APP["Mobile App\\n(downloads on launch)"]',mdxType:"Mermaid"}),(0,l.kt)("p",null,"A version manifest tracks bundle compatibility with native shell versions. The app only downloads bundles compatible with its installed native version, preventing breaking changes from reaching users on older shell releases."),(0,l.kt)("h2",{id:"relationship-to-web-portal"},"Relationship to Web Portal"),(0,l.kt)("p",null,"The mobile app runs the same End Customer Portal (ECP) codebase as the web version. The portal detects the mobile shell at runtime and adapts:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Uses native camera APIs instead of browser file pickers"),(0,l.kt)("li",{parentName:"ul"},"Adjusts navigation for mobile form factors"),(0,l.kt)("li",{parentName:"ul"},"Enables offline caching for portal configuration and entity data"),(0,l.kt)("li",{parentName:"ul"},"Integrates with native app lifecycle events (background, resume)")),(0,l.kt)("p",null,"This means 100% feature parity between web and mobile -- any feature available in the web portal is automatically available in the mobile app."))}m.isMDXComponent=!0}}]);