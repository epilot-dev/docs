"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[37418],{35722:(e,t,n)=>{n.d(t,{G:()=>u});var s=n(42858),i=n(67294),a=n(25108);let o=0,r=!1;const l=(e,t)=>{const n=e?.getAttribute("data-theme")??"light",s="dark"===n?"dark":"default";return t?.theme?.[n]??t?.mermaid?.theme??s},u=e=>{let{chart:t,config:n}=e;const u=(0,i.useRef)(null),p=(0,i.useRef)("mermaid-"+o++),[d,m]=(0,i.useState)(""),c=(0,i.useMemo)((()=>"string"==typeof n?JSON.parse(n):n),[n]);return(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=l(e,c);r||(s.Z.initialize({startOnLoad:!1,theme:n,...c?.mermaid||{}}),r=!0);(async()=>{try{const{svg:e}=await s.Z.render(p.current,t);m(e)}catch(e){a.error("Mermaid rendering failed:",e)}})()}),[t,c]),(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=new MutationObserver((n=>{for(const i of n){if("attributes"!==i.type||"data-theme"!==i.attributeName)continue;const n=l(e,c);r=!1,s.Z.initialize({startOnLoad:!1,theme:n,...c?.mermaid||{}}),r=!0,p.current="mermaid-"+o++,s.Z.render(p.current,t).then((e=>{let{svg:t}=e;m(t)}));break}}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[t,c]),"undefined"==typeof window?i.createElement("div",{className:"mermaid"},t):i.createElement("div",{ref:u,dangerouslySetInnerHTML:{__html:d}})}},19547:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>o,default:()=>d,frontMatter:()=>a,metadata:()=>r,toc:()=>l});var s=n(87462),i=(n(67294),n(3905));n(35722);const a={sidebar_position:4},o="Submissions",r={unversionedId:"journeys/submissions",id:"journeys/submissions",title:"Submissions",description:"[API Docs]",source:"@site/docs/journeys/submissions.md",sourceDirName:"journeys",slug:"/journeys/submissions",permalink:"/docs/journeys/submissions",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/journeys/submissions.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"docsSidebar",previous:{title:"Embedding Journeys",permalink:"/docs/journeys/embedding"},next:{title:"Journey Launcher",permalink:"/docs/journeys/journey-launcher"}},l=[{value:"Submission Entity",id:"submission-entity",children:[],level:2},{value:"Submission API",id:"submission-api",children:[],level:2},{value:"Passing Files",id:"passing-files",children:[],level:2}],u={toc:l},p="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,s.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"submissions"},"Submissions"),(0,i.kt)("p",null,"[",(0,i.kt)("a",{parentName:"p",href:"/api/submission"},"API Docs"),"]\n[",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/submission-client"},"SDK"),"]"),(0,i.kt)("p",null,"Submissions are entities that store raw data collected from journeys or other external sources. They are created via the ",(0,i.kt)("a",{parentName:"p",href:"/api/submission"},"Submission API"),"."),(0,i.kt)("h2",{id:"submission-entity"},"Submission Entity"),(0,i.kt)("p",null,"Unlike other business entities, a Submission does not have a fixed schema. It stores the raw JSON payload for further processing."),(0,i.kt)("p",null,"A typical workflow maps the incoming submission data into business entities like Contacts, Opportunities, and Orders using ",(0,i.kt)("a",{parentName:"p",href:"/docs/automation/automation-flows"},"Automation"),".Ex"),(0,i.kt)("h2",{id:"submission-api"},"Submission API"),(0,i.kt)("p",null,"The Submission API can be used by external journeys to create Submission entities."),(0,i.kt)("p",null,"See [",(0,i.kt)("a",{parentName:"p",href:"/api/submission"},"Submission API Docs"),"] for examples."),(0,i.kt)("h2",{id:"passing-files"},"Passing Files"),(0,i.kt)("p",null,"Submission API can be used together with ",(0,i.kt)("a",{parentName:"p",href:"https://docs.epilot.io/api/file"},"File API")," to pass file uploads to submissions using the following flow:"),(0,i.kt)("p",null,"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"uploadFile")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"uploadFilePublic")," operation of File API to generate a temporary upload URL and receive an s3ref:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:'title="Generate upload URL"',title:'"Generate',upload:!0,'URL"':!0},"POST https://file.sls.epilot.io/v1/files/public/upload\n")),(0,i.kt)("p",null,"Request Body:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Upload request"',title:'"Upload','request"':!0},'{\n  "filename": "document.pdf",\n  "mime_type": "application/pdf"\n}\n')),(0,i.kt)("p",null,"Response (200):"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Upload URL response"',title:'"Upload',URL:!0,'response"':!0},'{\n  "s3ref": {\n    "bucket": "epilot-user-content",\n    "key": "temp/123/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf"\n  },\n  "upload_url": "https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf?AWSParams=123"\n}\n')),(0,i.kt)("p",null,"Then, upload a file with a ",(0,i.kt)("inlineCode",{parentName:"p"},"PUT")," operation to the generated upload_url. (Hint: make sure you pass the correct Content-Type header and encoding!)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:'title="Upload the file"',title:'"Upload',the:!0,'file"':!0},"PUT https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf?AWSParams=123\n")),(0,i.kt)("p",null,"Request Body:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"(binary data)\n")),(0,i.kt)("p",null,"After the file has uploaded, pass the ",(0,i.kt)("inlineCode",{parentName:"p"},"s3ref")," in the ",(0,i.kt)("inlineCode",{parentName:"p"},"entities.*.files")," attribute in your Submission API payload:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-http",metastring:'title="Create submission with files"',title:'"Create',submission:!0,with:!0,'files"':!0},"POST https://submission.sls.epilot.io/v1/submission/submissions\n")),(0,i.kt)("p",null,"Request Body:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Submission payload with s3ref"',title:'"Submission',payload:!0,with:!0,'s3ref"':!0},'{\n  "organization_id": "123",\n  "source_type": "api",\n  "source_id": "example",\n  "entities": [\n    {\n      "_schema": "submission",\n      "description": "Submission with files",\n      "files": [\n        {\n          "s3ref": {\n            "bucket": "epilot-user-content",\n            "key": "temp/123/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf"\n          }\n        }\n      ]\n    }\n  ]\n}\n')))}d.isMDXComponent=!0}}]);