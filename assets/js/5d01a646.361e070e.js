"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[42437],{35722:(e,t,a)=>{a.d(t,{G:()=>d});var i=a(42858),n=a(67294),o=a(25108);let r=0,s=!1;const l=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",i="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??i},d=e=>{let{chart:t,config:a}=e;const d=(0,n.useRef)(null),p=(0,n.useRef)("mermaid-"+r++),[u,h]=(0,n.useState)(""),c=(0,n.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=l(e,c);s||(i.Z.initialize({startOnLoad:!1,theme:a,...c?.mermaid||{}}),s=!0);(async()=>{try{const{svg:e}=await i.Z.render(p.current,t);h(e)}catch(e){o.error("Mermaid rendering failed:",e)}})()}),[t,c]),(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const n of a){if("attributes"!==n.type||"data-theme"!==n.attributeName)continue;const a=l(e,c);s=!1,i.Z.initialize({startOnLoad:!1,theme:a,...c?.mermaid||{}}),s=!0,p.current="mermaid-"+r++,i.Z.render(p.current,t).then((e=>{let{svg:t}=e;h(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,c]),"undefined"==typeof window?n.createElement("div",{className:"mermaid"},t):n.createElement("div",{ref:d,dangerouslySetInnerHTML:{__html:u}})}},6373:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>r,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var i=a(87462),n=(a(67294),a(3905));a(35722);const o={sidebar_position:6},r="Integrating GIS Data",s={unversionedId:"journeys/integrate-gis-data",id:"journeys/integrate-gis-data",title:"Integrating GIS Data",description:"Address suggestion files are typically uploaded through the Journey Builder UI, but you can automate this process using the epilot APIs. This guide covers programmatic integration of GIS (Geo Information System) data \u2014 uploading address CSV files and attaching them to journeys for address autocomplete functionality.",source:"@site/docs/journeys/integrate-gis-data.md",sourceDirName:"journeys",slug:"/journeys/integrate-gis-data",permalink:"/docs/journeys/integrate-gis-data",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/journeys/integrate-gis-data.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"docsSidebar",previous:{title:"Journey Launcher",permalink:"/docs/journeys/journey-launcher"},next:{title:"Post Qualification Journey",permalink:"/docs/journeys/post-qualification"}},l=[{value:"Prerequisites",id:"prerequisites",children:[],level:2},{value:"Steps to Integrate GIS data with epilot",id:"steps-to-integrate-gis-data-with-epilot",children:[{value:"1. Upload the CSV File",id:"1-upload-the-csv-file",children:[],level:3},{value:"2. Validate the CSV File",id:"2-validate-the-csv-file",children:[],level:3},{value:"3. Attach the file to the Journey",id:"3-attach-the-file-to-the-journey",children:[],level:3}],level:2},{value:"Additional Resources",id:"additional-resources",children:[],level:2}],d={toc:l},p="wrapper";function u(e){let{components:t,...a}=e;return(0,n.kt)(p,(0,i.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"integrating-gis-data"},"Integrating GIS Data"),(0,n.kt)("p",null,"Address suggestion files are typically uploaded through the Journey Builder UI, but you can automate this process using the epilot APIs. This guide covers programmatic integration of GIS (Geo Information System) data \u2014 uploading address CSV files and attaching them to journeys for address autocomplete functionality."),(0,n.kt)("p",null,"The process involves:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Uploading a CSV File"),": Upload a CSV file containing the new address information."),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Validating Address Data"),": Validate the address data of the newly uploaded file"),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("strong",{parentName:"li"},"Configuring Journey Settings"),": Attach the validated file to the journey configuration, so it's used in the address auto-complete functionality.")),(0,n.kt)("p",null,"Follow the steps outlined in the detailed instructions below to implement this integration."),(0,n.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,n.kt)("p",null,"Please make sure to have the following parts set up already:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"The CSV template downloaded. You can find it ",(0,n.kt)("a",{parentName:"li",href:"https://epilot-prod-user-content.s3.eu-central-1.amazonaws.com/shared/address-suggestions-file-template.csv"},"here")),(0,n.kt)("li",{parentName:"ul"},"A Journey with an initial CSV file attached and an Address or Availability Block configured to use that CSV file"),(0,n.kt)("li",{parentName:"ul"},"An Access Token setup with the permissions to work with the ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/file/#tag/files"},"File API"),", ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/address-suggestions"},"Address Suggestions API"),", and ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/journey"},"Journey API"))),(0,n.kt)("h2",{id:"steps-to-integrate-gis-data-with-epilot"},"Steps to Integrate GIS data with epilot"),(0,n.kt)("h3",{id:"1-upload-the-csv-file"},"1. Upload the CSV File"),(0,n.kt)("p",null,"To automate the uploading of a CSV file containing address information, use the ",(0,n.kt)("a",{parentName:"p",href:"https://docs.epilot.io/api/file/#tag/files"},"File API"),". This API allows the CSV file to be uploaded programmatically without manual intervention. "),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Tip:"),"\nIf you use JavaScript, you can use our ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/epilot-dev/sdk-js"},"epilot sdk")," to invoke the APIs via the sdk clients."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Required Steps:"),(0,n.kt)("br",{parentName:"p"}),"\n","There are 3 steps required to have the address suggestions file in the epilot ecosystem:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Get a presigned URL in order to upload the file to an S3 Bucket via the ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/file#tag/files/operation/uploadFile"},"uploadFile Endpoint"))),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request POST 'https://file.sls.epilot.io/v1/files/upload' \\\n--header 'Authorization: Bearer <AUTH-TOKEN>' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\n  \"filename\": \"<FILE-NAME>.csv\",\n  \"mime_type\": \"text/csv\"\n}'\n")),(0,n.kt)("ol",{start:2},(0,n.kt)("li",{parentName:"ol"},"Upload the file via the previously received presigned URL (",(0,n.kt)("inlineCode",{parentName:"li"},"upload_url"),")")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request PUT '<UPLOAD-URL>' \\\n--header 'Content-Type: text/csv' \\\n--data-binary '@<PATH-TO-THE-FILE>.csv'\n")),(0,n.kt)("ol",{start:3},(0,n.kt)("li",{parentName:"ol"},"Persist the uploaded file and create a file entity via the ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/file#tag/files/operation/saveFile"},"saveFile Endpoint"),". Use the returned ",(0,n.kt)("inlineCode",{parentName:"li"},"s3ref")," from the first request.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'https://file.sls.epilot.io/v1/files\' \\\n--header \'Authorization: Bearer <AUTH-TOKEN>\' \\\n--header \'Content-Type: application/json\' \\\n--data-raw \'{\n    "s3ref": <S3REF-OBJECT>,\n    "filename": "<FILE-NAME>.csv",\n    "access_control": "private",\n    "_tags": [\n        "address-suggestions"\n    ]\n}\'\n')),(0,n.kt)("h3",{id:"2-validate-the-csv-file"},"2. Validate the CSV File"),(0,n.kt)("p",null,"After uploading the CSV file, use the ",(0,n.kt)("a",{parentName:"p",href:"https://docs.epilot.io/api/address-suggestions#tag/Addresses-API/operation/validateAddresses"},"Address Suggestions API")," to validate the address data contained within the file."),(0,n.kt)("p",null,"This ensures that we provide correct address suggestions in Address or Availability Blocks."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Required Steps:"),"  "),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Get the ",(0,n.kt)("inlineCode",{parentName:"li"},"public_url")," from the response of the ",(0,n.kt)("inlineCode",{parentName:"li"},"saveFile"),' request (this shouldn\'t include "temp" in the path)'),(0,n.kt)("li",{parentName:"ol"},"Call the ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/address-suggestions#tag/Addresses-API/operation/validateAddresses"},"validateFile Endpoint")," by passing the ",(0,n.kt)("inlineCode",{parentName:"li"},"public_url")," value as a query parameter."),(0,n.kt)("li",{parentName:"ol"},"If the response returns a ",(0,n.kt)("inlineCode",{parentName:"li"},"200")," status code, proceed to the next section. Otherwise, adjust the file according to the validation errors in the response.")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'https://address-suggestions-api.sls.epilot.io/v1/suggestions:validate?s3FileUrl=<PUBLIC-URL>' \\\n--header 'Authorization: Bearer <AUTH-TOKEN>'\n")),(0,n.kt)("h3",{id:"3-attach-the-file-to-the-journey"},"3. Attach the file to the Journey"),(0,n.kt)("p",null,"Finally, link the validated CSV file to your journey using the Journey API."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Required Steps:")),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Call the ",(0,n.kt)("a",{parentName:"li",href:"https://docs.epilot.io/api/journey#tag/Journeys/operation/patchUpdateJourney"},"patchUpdateJourney Endpoint")," by passing the journey id you would like to update, with the value of the ",(0,n.kt)("inlineCode",{parentName:"li"},"public_url")," under the property name ",(0,n.kt)("inlineCode",{parentName:"li"},"settings.addressSuggestionsFileUrl"),".")),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request PATCH 'https://journey-config.sls.epilot.io/v1/journey/configuration' \\\n--header 'Authorization: Bearer <AUTH-TOKEN>' \\\n--header 'Content-Type: application/json' \\\n--data-raw '{\n  \"journeyId\": \"<JOURNEY-ID>\",\n  \"settings.addressSuggestionsFileUrl\": \"<PUBLIC-URL>\"\n}'\n")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Tip"),"\nYou can get the journey id by opening the journey in a new tab from the Journey Builder"),(0,n.kt)("h2",{id:"additional-resources"},"Additional Resources"),(0,n.kt)("p",null,"For more details on each API and additional configuration options, see the ",(0,n.kt)("a",{parentName:"p",href:"https://docs.epilot.io/docs/intro"},"epilot dev center"),"."))}u.isMDXComponent=!0}}]);