"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[36648],{35722:(e,t,n)=>{n.d(t,{G:()=>d});var a=n(42858),r=n(67294),i=n(25108);let l=0,o=!1;const s=(e,t)=>{const n=e?.getAttribute("data-theme")??"light",a="dark"===n?"dark":"default";return t?.theme?.[n]??t?.mermaid?.theme??a},d=e=>{let{chart:t,config:n}=e;const d=(0,r.useRef)(null),p=(0,r.useRef)("mermaid-"+l++),[u,c]=(0,r.useState)(""),m=(0,r.useMemo)((()=>"string"==typeof n?JSON.parse(n):n),[n]);return(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=s(e,m);o||(a.Z.initialize({startOnLoad:!1,theme:n,...m?.mermaid||{}}),o=!0);(async()=>{try{const{svg:e}=await a.Z.render(p.current,t);c(e)}catch(e){i.error("Mermaid rendering failed:",e)}})()}),[t,m]),(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=new MutationObserver((n=>{for(const r of n){if("attributes"!==r.type||"data-theme"!==r.attributeName)continue;const n=s(e,m);o=!1,a.Z.initialize({startOnLoad:!1,theme:n,...m?.mermaid||{}}),o=!0,p.current="mermaid-"+l++,a.Z.render(p.current,t).then((e=>{let{svg:t}=e;c(t)}));break}}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[t,m]),"undefined"==typeof window?r.createElement("div",{className:"mermaid"},t):r.createElement("div",{ref:d,dangerouslySetInnerHTML:{__html:u}})}},69111:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));n(35722);const i={sidebar_position:6,title:"Environments & Secrets"},l="Environments & Secrets",o={unversionedId:"integrations/webhooks/environments-secrets",id:"integrations/webhooks/environments-secrets",title:"Environments & Secrets",description:"Org-level configuration for storing environment variables and secrets, usable across webhooks, templates, and integrations. Environment variables let you define shared configuration once and reference it everywhere, avoiding duplication and enabling safe Blueprint syncs between sandbox and production.",source:"@site/docs/integrations/webhooks/environments-secrets.md",sourceDirName:"integrations/webhooks",slug:"/integrations/webhooks/environments-secrets",permalink:"/docs/integrations/webhooks/environments-secrets",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/integrations/webhooks/environments-secrets.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"Environments & Secrets"},sidebar:"docsSidebar",previous:{title:"Static IPs",permalink:"/docs/integrations/webhooks/static-ip"},next:{title:"Core Events",permalink:"/docs/integrations/core-events"}},s=[{value:"Variable Types",id:"variable-types",children:[],level:2},{value:"Hierarchical Namespacing",id:"hierarchical-namespacing",children:[],level:2},{value:"Variable Resolution",id:"variable-resolution",children:[],level:2},{value:"API Operations",id:"api-operations",children:[],level:2},{value:"Blueprint Interaction",id:"blueprint-interaction",children:[],level:2},{value:"Use Cases",id:"use-cases",children:[{value:"Sandbox/Production Parity",id:"sandboxproduction-parity",children:[],level:3},{value:"ERP Integration Credentials",id:"erp-integration-credentials",children:[],level:3},{value:"Reusable Global Variables",id:"reusable-global-variables",children:[],level:3}],level:2},{value:"Security Considerations",id:"security-considerations",children:[],level:2},{value:"Examples",id:"examples",children:[{value:"Creating a Variable",id:"creating-a-variable",children:[],level:3},{value:"Using in Webhook Configuration",id:"using-in-webhook-configuration",children:[],level:3}],level:2}],d={toc:s},p="wrapper";function u(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"environments--secrets"},"Environments & Secrets"),(0,r.kt)("p",null,"Org-level configuration for storing environment variables and secrets, usable across webhooks, templates, and integrations. Environment variables let you define shared configuration once and reference it everywhere, avoiding duplication and enabling safe Blueprint syncs between sandbox and production."),(0,r.kt)("h2",{id:"variable-types"},"Variable Types"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Behavior"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"String")),(0,r.kt)("td",{parentName:"tr",align:null},"Readable key/value pair. Value returned by API.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"SecretString")),(0,r.kt)("td",{parentName:"tr",align:null},"Write-only. Value is never returned by the API or interpolated into user-facing outputs. Consumed only by backend services.")))),(0,r.kt)("h2",{id:"hierarchical-namespacing"},"Hierarchical Namespacing"),(0,r.kt)("p",null,"Keys use dot-separated namespacing to group related variables:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"erp_api.oauth_token_url\nerp_api.oauth_app_id\nerp_api.oauth_secret\nmy_webhook.base_url\nmy_webhook.api_key\n")),(0,r.kt)("p",null,"Key format: lowercase alphanumeric with dots, underscores, and hyphens. Max 128 characters. Pattern: ",(0,r.kt)("inlineCode",{parentName:"p"},"^[a-z0-9][a-z0-9_.-]{0,127}$")),(0,r.kt)("h2",{id:"variable-resolution"},"Variable Resolution"),(0,r.kt)("p",null,"Reference environment variables in webhooks and templates using the ",(0,r.kt)("inlineCode",{parentName:"p"},"env")," namespace:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"{{ env.erp_api.base_url }}\n{{ env.erp_api.oauth_token_url }}\n{{ env.erp_api.oauth_secret }}\n{{ env.n8n.metering_webhook_url }}\n")),(0,r.kt)("p",null,"Resolution rules:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Variables are resolved ",(0,r.kt)("strong",{parentName:"li"},"server-side at runtime")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"SecretString")," values are only available in trusted backend contexts (webhooks, integrations)"),(0,r.kt)("li",{parentName:"ul"},"The Template Variables API excludes secrets from its response")),(0,r.kt)("h2",{id:"api-operations"},"API Operations"),(0,r.kt)("p",null,"Base path: ",(0,r.kt)("inlineCode",{parentName:"p"},"/v2/organization/environments")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Operation"),(0,r.kt)("th",{parentName:"tr",align:null},"Method"),(0,r.kt)("th",{parentName:"tr",align:null},"Path"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"listEnvironmentVariables")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"GET")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/v2/organization/environments")),(0,r.kt)("td",{parentName:"tr",align:null},"List all variables (metadata only, secret values omitted)")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"createEnvironmentVariable")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"POST")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/v2/organization/environments")),(0,r.kt)("td",{parentName:"tr",align:null},"Create a new variable. Returns ",(0,r.kt)("inlineCode",{parentName:"td"},"409")," if key already exists")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"getEnvironmentVariable")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"GET")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/v2/organization/environments/{key}")),(0,r.kt)("td",{parentName:"tr",align:null},"Get a variable. Value included only for ",(0,r.kt)("inlineCode",{parentName:"td"},"String")," type")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"updateEnvironmentVariable")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"PUT")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/v2/organization/environments/{key}")),(0,r.kt)("td",{parentName:"tr",align:null},"Update a variable. Changes take effect immediately for all consumers")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"deleteEnvironmentVariable")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"DELETE")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"/v2/organization/environments/{key}")),(0,r.kt)("td",{parentName:"tr",align:null},"Delete a variable")))),(0,r.kt)("h2",{id:"blueprint-interaction"},"Blueprint Interaction"),(0,r.kt)("p",null,"Environment variables are ",(0,r.kt)("strong",{parentName:"p"},"excluded from Blueprints"),":"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Export does not include environment variables"),(0,r.kt)("li",{parentName:"ul"},"Import never overwrites environment values"),(0,r.kt)("li",{parentName:"ul"},"This prevents sandbox credentials from leaking to production")),(0,r.kt)("p",null,"This is the key difference from Custom Variables, which transfer with Blueprints and can cause sandbox values to appear in production after a sync."),(0,r.kt)("h2",{id:"use-cases"},"Use Cases"),(0,r.kt)("h3",{id:"sandboxproduction-parity"},"Sandbox/Production Parity"),(0,r.kt)("p",null,"Deploy the same webhook configuration via Blueprints to both environments. URLs and credentials resolve to environment-specific values automatically, with no manual reconfiguration needed after import."),(0,r.kt)("h3",{id:"erp-integration-credentials"},"ERP Integration Credentials"),(0,r.kt)("p",null,"Define OAuth endpoints, API keys, and base URLs once as environment variables. All webhooks reference the same variables, so credential rotation requires updating a single value rather than editing every webhook individually."),(0,r.kt)("h3",{id:"reusable-global-variables"},"Reusable Global Variables"),(0,r.kt)("p",null,"Store shared URLs, portal domains, and configuration flags as ",(0,r.kt)("inlineCode",{parentName:"p"},"String")," variables. Reference them across templates and integrations without duplicating values or embedding them in complex handlebars logic."),(0,r.kt)("h2",{id:"security-considerations"},"Security Considerations"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"KMS encryption")," -- All values are encrypted at rest using per-org AWS KMS keys (envelope encryption)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Write-only secrets")," -- ",(0,r.kt)("inlineCode",{parentName:"li"},"SecretString")," values cannot be read back through the API"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"No frontend access")," -- Secrets are resolved only in trusted backend contexts"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"No template interpolation")," -- Secrets are never interpolated into user-facing template outputs"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Log redaction")," -- Secret values are redacted from all logs")),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("h3",{id:"creating-a-variable"},"Creating a Variable"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Create a String variable"',title:'"Create',a:!0,String:!0,'variable"':!0},'curl -X POST https://api.epilot.io/v2/organization/environments \\\n  -H "Authorization: Bearer $EPILOT_TOKEN" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "key": "erp_api.base_url",\n    "type": "String",\n    "value": "https://erp.example.com/api/v1",\n    "description": "ERP API base URL"\n  }\'\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash",metastring:'title="Create a SecretString variable"',title:'"Create',a:!0,SecretString:!0,'variable"':!0},'curl -X POST https://api.epilot.io/v2/organization/environments \\\n  -H "Authorization: Bearer $EPILOT_TOKEN" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "key": "erp_api.oauth_secret",\n    "type": "SecretString",\n    "value": "sk_live_abc123...",\n    "description": "ERP OAuth client secret"\n  }\'\n')),(0,r.kt)("h3",{id:"using-in-webhook-configuration"},"Using in Webhook Configuration"),(0,r.kt)("p",null,"Reference environment variables in your webhook URL and authentication fields:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Webhook config using environment variables"',title:'"Webhook',config:!0,using:!0,environment:!0,'variables"':!0},'{\n  "url": "{{ env.erp_api.base_url }}/webhooks/orders",\n  "auth": {\n    "type": "oauth",\n    "token_url": "{{ env.erp_api.oauth_token_url }}",\n    "client_id": "{{ env.erp_api.oauth_app_id }}",\n    "client_secret": "{{ env.erp_api.oauth_secret }}"\n  }\n}\n')),(0,r.kt)("p",null,"When this webhook fires, all ",(0,r.kt)("inlineCode",{parentName:"p"},"{{ env.* }}")," references are resolved server-side to their org-specific values before the request is sent."))}u.isMDXComponent=!0}}]);