"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[37534],{35722:(e,a,t)=>{t.d(a,{G:()=>p});var l=t(42858),n=t(67294),i=t(25108);let r=0,s=!1;const d=(e,a)=>{const t=e?.getAttribute("data-theme")??"light",l="dark"===t?"dark":"default";return a?.theme?.[t]??a?.mermaid?.theme??l},p=e=>{let{chart:a,config:t}=e;const p=(0,n.useRef)(null),o=(0,n.useRef)("mermaid-"+r++),[m,u]=(0,n.useState)(""),c=(0,n.useMemo)((()=>"string"==typeof t?JSON.parse(t):t),[t]);return(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),t=d(e,c);s||(l.Z.initialize({startOnLoad:!1,theme:t,...c?.mermaid||{}}),s=!0);(async()=>{try{const{svg:e}=await l.Z.render(o.current,a);u(e)}catch(e){i.error("Mermaid rendering failed:",e)}})()}),[a,c]),(0,n.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),t=new MutationObserver((t=>{for(const n of t){if("attributes"!==n.type||"data-theme"!==n.attributeName)continue;const t=d(e,c);s=!1,l.Z.initialize({startOnLoad:!1,theme:t,...c?.mermaid||{}}),s=!0,o.current="mermaid-"+r++,l.Z.render(o.current,a).then((e=>{let{svg:a}=e;u(a)}));break}}));return t.observe(e,{attributes:!0}),()=>t.disconnect()}),[a,c]),"undefined"==typeof window?n.createElement("div",{className:"mermaid"},a):n.createElement("div",{ref:p,dangerouslySetInnerHTML:{__html:m}})}},36580:(e,a,t)=>{t.r(a),t.d(a,{contentTitle:()=>r,default:()=>m,frontMatter:()=>i,metadata:()=>s,toc:()=>d});var l=t(87462),n=(t(67294),t(3905));t(35722);const i={sidebar_position:0},r="Template Variables",s={unversionedId:"templates/template-variables",id:"templates/template-variables",title:"Template Variables",description:"[API Docs]",source:"@site/docs/templates/template-variables.md",sourceDirName:"templates",slug:"/templates/template-variables",permalink:"/docs/templates/template-variables",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/templates/template-variables.md",tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0},sidebar:"docsSidebar",previous:{title:"Notes API",permalink:"/docs/notes/notes_api"},next:{title:"Email Templates",permalink:"/docs/templates/email-templates"}},d=[{value:"Template Variables API",id:"template-variables-api",children:[],level:2},{value:"Computed metadata fields",id:"computed-metadata-fields",children:[{value:"Tags",id:"tags",children:[],level:3},{value:"Purpose",id:"purpose",children:[],level:3}],level:2},{value:"Variable Picker",id:"variable-picker",children:[],level:2},{value:"Variable Builder",id:"variable-builder",children:[{value:"Custom Variables",id:"custom-variables",children:[],level:3},{value:"Order Table Variable",id:"order-table-variable",children:[],level:3}],level:2},{value:"Custom Handlebars Helpers",id:"custom-handlebars-helpers",children:[{value:"Standard Handlebars Helpers",id:"standard-handlebars-helpers",children:[],level:3},{value:"formatAddress",id:"formataddress",children:[],level:3},{value:"calculateColspan",id:"calculatecolspan",children:[],level:3},{value:"calculatePeriodColspan",id:"calculateperiodcolspan",children:[],level:3},{value:"calculateSummaryColspan",id:"calculatesummarycolspan",children:[],level:3},{value:"isColumnEnabled",id:"iscolumnenabled",children:[],level:3},{value:"shouldDisplayDetails",id:"shoulddisplaydetails",children:[],level:3},{value:"isSummaryVisible",id:"issummaryvisible",children:[],level:3},{value:"isExternalFeesMetadataVisible",id:"isexternalfeesmetadatavisible",children:[],level:3},{value:"gt",id:"gt",children:[],level:3},{value:"lt",id:"lt",children:[],level:3},{value:"eq",id:"eq",children:[],level:3},{value:"blockHelperMissing",id:"blockhelpermissing",children:[],level:3},{value:"helperMissing",id:"helpermissing",children:[],level:3},{value:"makeStyle",id:"makestyle",children:[],level:3},{value:"<code>&lt;schema&gt;.&lt;property&gt;</code>",id:"schemaproperty",children:[],level:3},{value:"email",id:"email",children:[],level:3},{value:"billing_email",id:"billing_email",children:[],level:3},{value:"phone",id:"phone",children:[],level:3},{value:"billing_phone",id:"billing_phone",children:[],level:3},{value:"address",id:"address",children:[],level:3},{value:"billing_address",id:"billing_address",children:[],level:3},{value:"shipping_address",id:"shipping_address",children:[],level:3},{value:"delivery_address",id:"delivery_address",children:[],level:3},{value:"additional_address",id:"additional_address",children:[],level:3},{value:"withTag",id:"withtag",children:[],level:3},{value:"yn",id:"yn",children:[],level:3},{value:"xif",id:"xif",children:[],level:3},{value:"customOrderTableVariable",id:"customordertablevariable",children:[],level:3},{value:"formatDateTime",id:"formatdatetime",children:[],level:3},{value:"formatDate",id:"formatdate",children:[],level:3},{value:"dateMath",id:"datemath",children:[],level:3},{value:"padStart",id:"padstart",children:[],level:3},{value:"generateJourneyLink",id:"generatejourneylink",children:[],level:3},{value:"asCurrency",id:"ascurrency",children:[],level:3}],level:2},{value:"Excel-like Formulas",id:"excel-like-formulas",children:[],level:2},{value:"Available formulas",id:"available-formulas",children:[{value:"Arithmetic operators",id:"arithmetic-operators",children:[],level:3},{value:"Formula functions",id:"formula-functions",children:[],level:3},{value:"Date functions",id:"date-functions",children:[{value:"Current time",id:"current-time",children:[],level:4},{value:"Date arithmetic",id:"date-arithmetic",children:[],level:4},{value:"Date components",id:"date-components",children:[],level:4},{value:"Week calculations",id:"week-calculations",children:[],level:4},{value:"Examples",id:"examples",children:[],level:4}],level:3}],level:2}],p={toc:d},o="wrapper";function m(e){let{components:a,...i}=e;return(0,n.kt)(o,(0,l.Z)({},p,i,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"template-variables"},"Template Variables"),(0,n.kt)("p",null,"[",(0,n.kt)("a",{parentName:"p",href:"/api/template-variables"},"API Docs"),"]\n[",(0,n.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/template-variables-client"},"SDK"),"]"),(0,n.kt)("p",null,"The Template Variables API handles variable discovery and substitution for email and document templates using ",(0,n.kt)("a",{parentName:"p",href:"https://handlebarsjs.com/"},"Handlebars"),"."),(0,n.kt)("h2",{id:"template-variables-api"},"Template Variables API"),(0,n.kt)("p",null,"The API discovers available variables and executes substitution. When a template renders, the API fetches entity data and other context to resolve each variable."),(0,n.kt)("h2",{id:"computed-metadata-fields"},"Computed metadata fields"),(0,n.kt)("p",null,"Some entity fields store identifiers (slugs or UUIDs). The API expands these into human-readable values using the ",(0,n.kt)("inlineCode",{parentName:"p"},":<field>")," suffix."),(0,n.kt)("h3",{id:"tags"},"Tags"),(0,n.kt)("p",null,"Access resolved tag names from the ",(0,n.kt)("inlineCode",{parentName:"p"},"_tags")," slug array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{<entity_slug>._tags:name}}\n{{opportunity._tags:name}}\n{{_tags:name}}\n")),(0,n.kt)("h3",{id:"purpose"},"Purpose"),(0,n.kt)("p",null,"Access resolved purpose names from the ",(0,n.kt)("inlineCode",{parentName:"p"},"_purpose")," UUID array:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{<entity_slug>._purpose:name}}\n{{opportunity._purpose:name}}\n{{_purpose:name}}\n")),(0,n.kt)("p",null,"If a purpose ID cannot be resolved, the raw ID is returned."),(0,n.kt)("h2",{id:"variable-picker"},"Variable Picker"),(0,n.kt)("p",null,"The variable picker UI lets users search and explore available variables."),(0,n.kt)("h2",{id:"variable-builder"},"Variable Builder"),(0,n.kt)("p",null,"Create custom variables in ",(0,n.kt)("strong",{parentName:"p"},"Configuration > Templates > Variable Builder")," (",(0,n.kt)("a",{parentName:"p",href:"https://portal.epilot.cloud/app/variable-builder"},"direct link"),")."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Variable Builder UI",src:t(74011).Z,width:"1808",height:"920"})),(0,n.kt)("h3",{id:"custom-variables"},"Custom Variables"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Custom Variables",src:t(65585).Z,width:"1806",height:"921"})),(0,n.kt)("p",null,"Custom variables combine free text with any ",(0,n.kt)("a",{parentName:"p",href:"#custom-handlebars-helpers"},"Handlebars helper"),". Reference them in templates with:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{custom_variable_name}}\n")),(0,n.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,n.kt)("div",{parentName:"div",className:"admonition-heading"},(0,n.kt)("h5",{parentName:"div"},(0,n.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,n.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,n.kt)("div",{parentName:"div",className:"admonition-content"},(0,n.kt)("p",{parentName:"div"},"You can use Handlebars helpers directly in templates. Custom variables are useful for encapsulating reusable logic."))),(0,n.kt)("h3",{id:"order-table-variable"},"Order Table Variable"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Order Table Variable",src:t(49265).Z,width:"1806",height:"918"})),(0,n.kt)("p",null,"Order tables display line items from an ",(0,n.kt)("a",{parentName:"p",href:"/docs/pricing/orders"},"Order"),". They support ",(0,n.kt)("a",{parentName:"p",href:"#custom-variables"},"Custom Variables")," and ",(0,n.kt)("a",{parentName:"p",href:"#custom-handlebars-helpers"},"Handlebars Helpers"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Order Table Column Config",src:t(44738).Z,width:"603",height:"856"}),"\n",(0,n.kt)("img",{alt:"Order Table Column Config 2",src:t(12374).Z,width:"602",height:"856"})),(0,n.kt)("p",null,"Customize column order, styling, visibility, headers, and footers."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Order Table Column Config 3",src:t(63557).Z,width:"1104",height:"857"})),(0,n.kt)("p",null,"Reference an order table variable in templates with:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{~~custom_table_key}}\n")),(0,n.kt)("h2",{id:"custom-handlebars-helpers"},"Custom Handlebars Helpers"),(0,n.kt)("h3",{id:"standard-handlebars-helpers"},"Standard Handlebars Helpers"),(0,n.kt)("p",null,"All helpers from the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/helpers/handlebars-helpers"},(0,n.kt)("inlineCode",{parentName:"a"},"handlebars-helpers"))," library are available: ",(0,n.kt)("inlineCode",{parentName:"p"},"math"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"number"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"date"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"comparison"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"array"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"string"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"object"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"url"),", and more."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{add 1 2}}\n")),(0,n.kt)("h3",{id:"formataddress"},"formatAddress"),(0,n.kt)("p",null,"Formats an address object into a single-line string. Returns empty string for invalid input."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{formatAddress 'billing_address.0'}}\n")),(0,n.kt)("h3",{id:"calculatecolspan"},"calculateColspan"),(0,n.kt)("p",null,"Calculates the colspan for table cells based on the table configuration. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{calculateColspan table_config}}\n")),(0,n.kt)("h3",{id:"calculateperiodcolspan"},"calculatePeriodColspan"),(0,n.kt)("p",null,"Calculates the colspan for period-related table columns. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{calculatePeriodColspan table_config}}\n")),(0,n.kt)("h3",{id:"calculatesummarycolspan"},"calculateSummaryColspan"),(0,n.kt)("p",null,"Calculates the colspan for summary sections based on enabled columns. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{calculateSummaryColspan table_config}}\n")),(0,n.kt)("h3",{id:"iscolumnenabled"},"isColumnEnabled"),(0,n.kt)("p",null,"Returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if the specified column ID is enabled in the table configuration. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{isColumnEnabled table_config 'price'}}\n")),(0,n.kt)("h3",{id:"shoulddisplaydetails"},"shouldDisplayDetails"),(0,n.kt)("p",null,"Returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if the column's ",(0,n.kt)("inlineCode",{parentName:"p"},"showDetails")," property is set. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{shouldDisplayDetails table_config 'description'}}\n")),(0,n.kt)("h3",{id:"issummaryvisible"},"isSummaryVisible"),(0,n.kt)("p",null,"Returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if at least one non-draggable column is enabled. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{isSummaryVisible table_config}}\n")),(0,n.kt)("h3",{id:"isexternalfeesmetadatavisible"},"isExternalFeesMetadataVisible"),(0,n.kt)("p",null,"Returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if ",(0,n.kt)("inlineCode",{parentName:"p"},"external_fees_metadata")," is enabled in the table footer. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{isExternalFeesMetadataVisible table_config}}\n")),(0,n.kt)("h3",{id:"gt"},"gt"),(0,n.kt)("p",null,"Compares two numbers and returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if the first is greater than the second."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{gt 5 3}}\n")),(0,n.kt)("h3",{id:"lt"},"lt"),(0,n.kt)("p",null,"Compares two numbers and returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if the first is less than the second."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{lt 3 5}}\n")),(0,n.kt)("h3",{id:"eq"},"eq"),(0,n.kt)("p",null,"Compares two numbers and returns ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," if they are equal."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{eq 5 5}}\n")),(0,n.kt)("h3",{id:"blockhelpermissing"},"blockHelperMissing"),(0,n.kt)("p",null,"Returns an empty string when a block helper is missing."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{#missingBlock}}content{{/missingBlock}}\n")),(0,n.kt)("h3",{id:"helpermissing"},"helperMissing"),(0,n.kt)("p",null,"Returns an empty string when a helper is not found."),(0,n.kt)("h3",{id:"makestyle"},"makeStyle"),(0,n.kt)("p",null,"Converts a table configuration object into a CSS style string. Used with ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variables"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{makeStyle table_config.style}}\n")),(0,n.kt)("h3",{id:"schemaproperty"},(0,n.kt)("inlineCode",{parentName:"h3"},"<schema>.<property>")),(0,n.kt)("p",null,"Dynamically registered from schema attributes (e.g., ",(0,n.kt)("inlineCode",{parentName:"p"},"main.email"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"contact.name"),'). Retrieves a property value from context data, prioritizing items tagged as "primary" or the first array element. Address properties are automatically formatted as full addresses.'),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{main.email}}\n")),(0,n.kt)("h3",{id:"email"},"email"),(0,n.kt)("p",null,"Retrieves the email from context, prioritizing ",(0,n.kt)("inlineCode",{parentName:"p"},"email")," then ",(0,n.kt)("inlineCode",{parentName:"p"},"billing_email"),". Returns the first element if the value is an array."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{email "contact"}}\n')),(0,n.kt)("h3",{id:"billing_email"},"billing_email"),(0,n.kt)("p",null,"Retrieves the billing email from context, prioritizing ",(0,n.kt)("inlineCode",{parentName:"p"},"billing_email")," then ",(0,n.kt)("inlineCode",{parentName:"p"},"email"),". Returns the first element if the value is an array."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{billing_email "contact"}}\n')),(0,n.kt)("h3",{id:"phone"},"phone"),(0,n.kt)("p",null,"Retrieves the phone number from context, prioritizing ",(0,n.kt)("inlineCode",{parentName:"p"},"phone")," then ",(0,n.kt)("inlineCode",{parentName:"p"},"billing_phone"),". Returns the first element if the value is an array."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{phone "contact"}}\n')),(0,n.kt)("h3",{id:"billing_phone"},"billing_phone"),(0,n.kt)("p",null,"Retrieves the billing phone from context, prioritizing ",(0,n.kt)("inlineCode",{parentName:"p"},"billing_phone")," then ",(0,n.kt)("inlineCode",{parentName:"p"},"phone"),". Returns the first element if the value is an array."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{billing_phone "contact"}}\n')),(0,n.kt)("h3",{id:"address"},"address"),(0,n.kt)("p",null,"Formats an address from context, searching for addresses tagged ",(0,n.kt)("inlineCode",{parentName:"p"},"billing")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"primary"),". Falls back to the first address."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{address}}\n")),(0,n.kt)("h3",{id:"billing_address"},"billing_address"),(0,n.kt)("p",null,"Formats an address from context, searching for addresses tagged ",(0,n.kt)("inlineCode",{parentName:"p"},"billing"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"shipping"),", or ",(0,n.kt)("inlineCode",{parentName:"p"},"primary"),". Falls back to the first address."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{billing_address}}\n")),(0,n.kt)("h3",{id:"shipping_address"},"shipping_address"),(0,n.kt)("p",null,"Formats an address from context, searching for addresses tagged ",(0,n.kt)("inlineCode",{parentName:"p"},"shipping"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"billing"),", or ",(0,n.kt)("inlineCode",{parentName:"p"},"primary"),". Falls back to the first address."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{shipping_address}}\n")),(0,n.kt)("h3",{id:"delivery_address"},"delivery_address"),(0,n.kt)("p",null,"Formats an address from context, searching for addresses tagged ",(0,n.kt)("inlineCode",{parentName:"p"},"delivery")," or ",(0,n.kt)("inlineCode",{parentName:"p"},"primary"),". Falls back to the first delivery address."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{delivery_address}}\n")),(0,n.kt)("h3",{id:"additional_address"},"additional_address"),(0,n.kt)("p",null,"Formats an address from context, searching for addresses tagged ",(0,n.kt)("inlineCode",{parentName:"p"},"primary"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{additional_address}}\n")),(0,n.kt)("h3",{id:"withtag"},"withTag"),(0,n.kt)("p",null,"Retrieves a value from an array by tag (defaults to ",(0,n.kt)("inlineCode",{parentName:"p"},"primary"),") and optional attribute."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{withTag items tag="primary" attribute="email"}}\n')),(0,n.kt)("h3",{id:"yn"},"yn"),(0,n.kt)("p",null,'Converts a boolean-like value to a localized "Yes" or "No" string. Accepts optional custom ',(0,n.kt)("inlineCode",{parentName:"p"},"success"),"/",(0,n.kt)("inlineCode",{parentName:"p"},"failure")," values."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{yn true}}\n")),(0,n.kt)("h3",{id:"xif"},"xif"),(0,n.kt)("p",null,"Returns ",(0,n.kt)("inlineCode",{parentName:"p"},'"x"')," if the input is truthy, otherwise an empty string."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{xif true}}\n")),(0,n.kt)("h3",{id:"customordertablevariable"},"customOrderTableVariable"),(0,n.kt)("p",null,"Renders an ",(0,n.kt)("a",{parentName:"p",href:"#order-table-variable"},"Order Table Variable"),"."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},"{{~~custom_table_key}}\n")),(0,n.kt)("h3",{id:"formatdatetime"},"formatDateTime"),(0,n.kt)("p",null,"Formats a date/time string with a specified pattern. Defaults to short date-time format."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{formatDateTime "2025-05-13" "yyyy-MM-dd HH:mm"}}\n')),(0,n.kt)("h3",{id:"formatdate"},"formatDate"),(0,n.kt)("p",null,"Formats a date string with a specified pattern. Defaults to date-only format."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{formatDate "2025-05-13" "yyyy-MM-dd"}}\n')),(0,n.kt)("h3",{id:"datemath"},"dateMath"),(0,n.kt)("p",null,"Performs date arithmetic (add/subtract days, months, etc.). Accepts ",(0,n.kt)("inlineCode",{parentName:"p"},"inputDate"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"expression"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"inputFormat"),", and ",(0,n.kt)("inlineCode",{parentName:"p"},"format")," parameters."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{dateMath "2025-05-13" "+1d"}}\n')),(0,n.kt)("h3",{id:"padstart"},"padStart"),(0,n.kt)("p",null,"Pads a string to a target length with a specified character (defaults to space)."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{padStart "5" 3 "0"}}\n')),(0,n.kt)("h3",{id:"generatejourneylink"},"generateJourneyLink"),(0,n.kt)("p",null,"Generates a signed journey link. Pass parameters as space-separated key-value pairs."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Required"),": ",(0,n.kt)("inlineCode",{parentName:"p"},"journey_id")),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"Optional"),":"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"custom_url")," -- custom domain for the URL"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"expires_in")," -- token expiration (",(0,n.kt)("a",{parentName:"li",href:"https://github.com/vercel/ms"},"ms format"),")"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"nonce")," -- add a nonce to the payload (boolean)")),(0,n.kt)("p",null,"Automatically includes ",(0,n.kt)("inlineCode",{parentName:"p"},"initial_submission_id")," from context when available."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{generateJourneyLink hash.journeyId="123"}}\n')),(0,n.kt)("h3",{id:"ascurrency"},"asCurrency"),(0,n.kt)("p",null,"Formats a number as a currency string using ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/epilot-dev/pricing"},"@epilot/pricing"),". Accepts ",(0,n.kt)("inlineCode",{parentName:"p"},"currency")," (default: ",(0,n.kt)("inlineCode",{parentName:"p"},"EUR"),"), ",(0,n.kt)("inlineCode",{parentName:"p"},"locale")," (default: ",(0,n.kt)("inlineCode",{parentName:"p"},"de"),"), and ",(0,n.kt)("inlineCode",{parentName:"p"},"displayZeroAmount")," (default: ",(0,n.kt)("inlineCode",{parentName:"p"},"false"),")."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'{{asCurrency 100.50 "EUR"}}\n')),(0,n.kt)("h2",{id:"excel-like-formulas"},"Excel-like Formulas"),(0,n.kt)("p",null,"Use the ",(0,n.kt)("inlineCode",{parentName:"p"},"calc")," helper for Excel-like formulas in templates."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'Price: {{price}}\nQty: {{qty}}\n\nTotal (rounded 2): {{ calc "ROUND(price * qty, 2)" }}\nDiscounted: {{ calc "ROUND((price * qty) * (1 - discount), 2)" }}\n\nCaps with IF: {{ calc "IF(qty > 10, 10, qty)" }}\n\nUsing named args override:\n{{ calc "ROUND(a + b, 0)" a=fee b=shipping }}\n\nMin/Max:\n{{ calc "MAX(price1, price2, price3)" }}\n')),(0,n.kt)("h2",{id:"available-formulas"},"Available formulas"),(0,n.kt)("h3",{id:"arithmetic-operators"},"Arithmetic operators"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"+")," - Addition"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"-")," - Subtraction"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"*")," - Multiplication"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"/")," - Division"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"^")," - Exponentiation"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"%")," - Modulus (remainder of division)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"()")," - Parentheses for grouping expressions"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"-number")," - Negation (unary minus)")),(0,n.kt)("h3",{id:"formula-functions"},"Formula functions"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"ABS(number)")," - Returns the absolute value of a number."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"AND(condition1, condition2, ...)")," - Returns ",(0,n.kt)("inlineCode",{parentName:"li"},"true")," if all conditions are truthy."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"AVERAGE(number1, number2, ...)")," - Returns the average of a set of numbers."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"CEIL(number)")," - Rounds a number up to the nearest integer."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"FLOOR(number)")," - Rounds a number down to the nearest integer."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"IF(condition, value_if_true, value_if_false)")," - Returns one value if condition is truthy and another value if it's falsey."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"MAX(number1, number2, ...)")," - Returns the largest number in a set of numbers."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"MIN(number1, number2, ...)")," - Returns the smallest number in a set of numbers."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"NOT(condition)")," - Reverses the value of its argument. Returns ",(0,n.kt)("inlineCode",{parentName:"li"},"true")," if its argument is truthy and ",(0,n.kt)("inlineCode",{parentName:"li"},"false")," if its argument is falsey."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"OR(condition1, condition2, ...)")," - Returns ",(0,n.kt)("inlineCode",{parentName:"li"},"true")," if any condition is truthy."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"ROUND(number, [places])")," - Rounds a number to a specified number of decimal places. If places is omitted, it defaults to 0."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"SUM(number1, number2, ...)")," - Returns the sum of a set of numbers."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"RAND()")," - Returns a random number between 0 (inclusive) and 1 (exclusive).")),(0,n.kt)("h3",{id:"date-functions"},"Date functions"),(0,n.kt)("p",null,'All date functions work with ISO 8601 date strings (e.g., "2025-09-26" or "2025-09-26T12:00:00Z") and use UTC by default with optional timezone support.'),(0,n.kt)("h4",{id:"current-time"},"Current time"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"NOW([timezone])"),' - Returns the current date and time in ISO format (e.g., "2025-09-26T12:00:00.000Z")'),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"TODAY([timezone])"),' - Returns the current date in ISO format (e.g., "2025-09-26")')),(0,n.kt)("h4",{id:"date-arithmetic"},"Date arithmetic"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"DATEADD(date, value, unit, [timezone])")," - Adds/subtracts time from a date",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},'Units: "years", "quarters", "months", "weeks", "days", "hours", "minutes", "seconds"'))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"DATEDIFF(start_date, end_date, unit, [timezone])")," - Calculates difference between dates",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Returns floor of the difference (e.g., 1.9 months = 1)")))),(0,n.kt)("h4",{id:"date-components"},"Date components"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"YEAR(date, [timezone])")," - Extract year (e.g., 2025)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"MONTH(date, [timezone])")," - Extract month (1-12)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"DAY(date, [timezone])")," - Extract day of month (1-31)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"HOUR(date, [timezone])")," - Extract hour (0-23)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"MINUTE(date, [timezone])")," - Extract minute (0-59)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"SECOND(date, [timezone])")," - Extract second (0-59)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"WEEKDAY(date, [type], [timezone])")," - Get day of week",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"type=1"),": Sunday=1, Saturday=7 (Excel default)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"type=2")," or omitted: Monday=1, Sunday=7 (ISO)"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"type=3"),": Monday=0, Sunday=6")))),(0,n.kt)("h4",{id:"week-calculations"},"Week calculations"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},"WEEKNUM(date, [type], [timezone])")," - Get ISO week number of the year")),(0,n.kt)("h4",{id:"examples"},"Examples"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-handlebars"},'\x3c!-- Add 14 days to order date --\x3e\nDelivery date: {{ calc "DATEADD(order.date, 14, \\"days\\")" }}\n\n\x3c!-- Calculate age --\x3e\nAge: {{ calc "DATEDIFF(birthDate, TODAY(), \\"years\\")" }} years old\n\n\x3c!-- Extract components --\x3e\nYear: {{ calc "YEAR(invoice.date)" }}\nMonth: {{ calc "MONTH(invoice.date)" }}\n\n\x3c!-- Business logic --\x3e\nDue date: {{ calc "DATEADD(invoice.date, payment.terms, \\"days\\")" }}\nOverdue: {{ calc "DATEDIFF(invoice.dueDate, TODAY(), \\"days\\") < 0" }}\n\n\x3c!-- Timezone handling --\x3e\nLocal date: {{ calc "TODAY(\\"Europe/Helsinki\\")" }}\n')))}m.isMDXComponent=!0},65585:(e,a,t)=>{t.d(a,{Z:()=>l});const l=t.p+"assets/images/custom-variables-4a044b1269ce1fab85b954ce1ddbd9f0.png"},44738:(e,a,t)=>{t.d(a,{Z:()=>l});const l=t.p+"assets/images/order-table-2-4caf7cde56bb6a85ce179e206952132a.png"},12374:(e,a,t)=>{t.d(a,{Z:()=>l});const l=t.p+"assets/images/order-table-3-4c01a32d2bd50fe2bf52077710db6de8.png"},63557:(e,a,t)=>{t.d(a,{Z:()=>l});const l=t.p+"assets/images/order-table-4-75f579c07fd7a50fa556c1d0fe382781.png"},49265:(e,a,t)=>{t.d(a,{Z:()=>l});const l=t.p+"assets/images/order-table-7c4728745229d6a0da775440cbf45312.png"},74011:(e,a,t)=>{t.d(a,{Z:()=>l});const l=t.p+"assets/images/variable-builder-117242496a34b973256c968529c048a4.png"}}]);