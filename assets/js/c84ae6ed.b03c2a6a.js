"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[59748],{35722:(e,t,a)=>{a.d(t,{G:()=>p});var n=a(42858),i=a(67294),r=a(25108);let o=0,l=!1;const s=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??n},p=e=>{let{chart:t,config:a}=e;const p=(0,i.useRef)(null),d=(0,i.useRef)("mermaid-"+o++),[c,u]=(0,i.useState)(""),m=(0,i.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=s(e,m);l||(n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),l=!0);(async()=>{try{const{svg:e}=await n.Z.render(d.current,t);u(e)}catch(e){r.error("Mermaid rendering failed:",e)}})()}),[t,m]),(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const i of a){if("attributes"!==i.type||"data-theme"!==i.attributeName)continue;const a=s(e,m);l=!1,n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),l=!0,d.current="mermaid-"+o++,n.Z.render(d.current,t).then((e=>{let{svg:t}=e;u(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,m]),"undefined"==typeof window?i.createElement("div",{className:"mermaid"},t):i.createElement("div",{ref:p,dangerouslySetInnerHTML:{__html:c}})}},83188:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var n=a(87462),i=(a(67294),a(3905)),r=a(35722);const o={title:"Portal Extensions",hide_title:!0,sidebar_position:6},l=void 0,s={unversionedId:"apps/about-apps/components/portal-extension",id:"apps/about-apps/components/portal-extension",title:"Portal Extensions",description:"Portal Extensions",source:"@site/docs/apps/about-apps/components/portal-extension.md",sourceDirName:"apps/about-apps/components",slug:"/apps/about-apps/components/portal-extension",permalink:"/docs/apps/about-apps/components/portal-extension",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/apps/about-apps/components/portal-extension.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Portal Extensions",hide_title:!0,sidebar_position:6},sidebar:"docsSidebar",previous:{title:"Custom Workflow Task",permalink:"/docs/apps/about-apps/components/custom-action"},next:{title:"External Product Catalog",permalink:"/docs/apps/about-apps/components/external-product-catalog"}},p=[{value:"Configuration",id:"configuration",children:[],level:2},{value:"Links",id:"links",children:[{value:"What are Seamless Links?",id:"what-are-seamless-links",children:[{value:"How Seamless Links Work",id:"how-seamless-links-work",children:[],level:4}],level:3},{value:"Configuration and Example",id:"configuration-and-example",children:[],level:3},{value:"Template Variables",id:"template-variables",children:[{value:"Available Variables",id:"available-variables",children:[],level:4}],level:3},{value:"Example Use Cases",id:"example-use-cases",children:[],level:3},{value:"Security Considerations",id:"security-considerations",children:[],level:3}],level:2},{value:"Hooks",id:"hooks",children:[{value:"Time Series Data Retrieval Hooks",id:"time-series-data-retrieval-hooks",children:[{value:"Types of Data Retrieval Hooks",id:"types-of-data-retrieval-hooks",children:[],level:4},{value:"How Data Retrieval Hooks Work",id:"how-data-retrieval-hooks-work",children:[],level:4},{value:"Configuration and Example",id:"configuration-and-example-1",children:[{value:"Price Data Retrieval",id:"price-data-retrieval",children:[],level:5},{value:"Consumption Data Retrieval",id:"consumption-data-retrieval",children:[],level:5},{value:"Cost Data Retrieval",id:"cost-data-retrieval",children:[],level:5}],level:4},{value:"Template Variables",id:"template-variables-1",children:[],level:4},{value:"Standard Variables",id:"standard-variables",children:[],level:4},{value:"Scope Variables (for <code>call.params</code>)",id:"scope-variables-for-callparams",children:[],level:4},{value:"Best Practices",id:"best-practices",children:[],level:4}],level:3},{value:"Data Existence Check/Retrieval",id:"data-existence-checkretrieval",children:[{value:"Registration Hook",id:"registration-hook",children:[],level:4},{value:"Template Variables",id:"template-variables-2",children:[],level:4},{value:"Self-Assignment Hook",id:"self-assignment-hook",children:[],level:4},{value:"Template Variables",id:"template-variables-3",children:[],level:4}],level:3},{value:"Data Validation",id:"data-validation",children:[{value:"Meter Reading Plausibility",id:"meter-reading-plausibility",children:[],level:4},{value:"Template Variables",id:"template-variables-4",children:[],level:4}],level:3}],level:2}],d={toc:p},c="wrapper";function u(e){let{components:t,...o}=e;return(0,i.kt)(c,(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{align:"center"},"Portal Extensions"),(0,i.kt)("p",{align:"center"},"Enhance epilot portals with custom functionality and integrations"),(0,i.kt)("h2",{id:"configuration"},"Configuration"),(0,i.kt)("p",null,"All development is performed using the built-in configuration editor accessible from the component editor."),(0,i.kt)("p",null,"The editor provides you with autocomplete and validation of the configuration. That way you can start with the example provided in this documentation and fine-tune your portal extension without ever leaving the editor."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Portal Extension configuration editor",src:a(52374).Z,width:"2660",height:"1572"})),(0,i.kt)("h2",{id:"links"},"Links"),(0,i.kt)("p",null,'The easiest way to extend the functionality of portals is to link to a third party system.\nThis is possible using the "seamless link" concept.'),(0,i.kt)("h3",{id:"what-are-seamless-links"},"What are Seamless Links?"),(0,i.kt)("p",null,"Seamless links enable portal users to access third-party systems directly without manual authentication. When a user clicks a seamless link in the portal, epilot handles the authentication process in the background according to your configured rules, then redirects the user to the specified page in the third-party system with the necessary credentials or tokens."),(0,i.kt)("p",null,"This provides a smooth user experience where portal users can navigate to external systems without interruption, while you maintain control over the authentication mechanism and security policies."),(0,i.kt)("h4",{id:"how-seamless-links-work"},"How Seamless Links Work"),(0,i.kt)(r.G,{chart:"sequenceDiagram\n    participant User as Portal User\n    participant epilot as epilot Portal\n    participant Auth as Your Auth Endpoint\n    participant App as Third-Party System\n\n    User->>epilot: Clicks seamless link\n    epilot->>Auth: Authentication request (credentials + headers)\n    Auth--\x3e>epilot: Returns token/credentials\n    epilot->>App: Redirect with token parameters\n    App--\x3e>User: Authenticated page displayed",mdxType:"Mermaid"}),(0,i.kt)("p",null,"The seamless link flow consists of two main steps:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Authentication"),": epilot makes a request to your authentication endpoint using the configured credentials and headers"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Redirect"),": epilot uses the authentication response to construct a redirect URL with the necessary parameters (such as tokens) and sends the user to the target page")),(0,i.kt)("p",null,"All of this happens automatically in the background, so the portal user experiences a seamless transition to the third-party system."),(0,i.kt)("h3",{id:"configuration-and-example"},"Configuration and Example"),(0,i.kt)("p",null,"Seamless links are configured in your app configuration. Each seamless link defines the authentication mechanism and the redirect behavior. The built-in component configuration editor will guide you through the available properties and their format. Here is an example hook configuration:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Seamless link configuration"',title:'"Seamless',link:!0,'configuration"':!0},'{\n  "id": "third_party_seamless_link",\n  "type": "seamless",\n  "name": {\n    "en": "Dashboard",\n    "de": "Dashboard"\n  },\n  "description": {\n    "en": "Adds Third Party System as a Type for \\"Seamless link\\". Once configured, the system can be opened from Portal without a need to authenticate.",\n    "de": "F\xfcgt Third Party System als Typ f\xfcr \\"Seamless Link\\" hinzu. Sobald konfiguriert, kann das System von Portal aus ge\xf6ffnet werden, ohne sich authentifizieren zu m\xfcssen."\n  },\n  "auth": {\n    "url": "{{Options.api_url}}/token",\n    "method": "GET",\n    "headers": {\n      "API-Key": "{{Options.api_key}}",\n      "UID": "{{Contact.customer_number}}"\n    }\n  },\n  "redirect": {\n    "url": "{{Options.ui_url}}/dashboard",\n    "params": {\n      "token": "{{AuthResponse.data.data.token}}",\n      "contractId": "{{Contract.contract_number}}"\n    }\n  }\n}\n')),(0,i.kt)("p",null,"The configuration above adds a new option for quick actions like this:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Seamless link used in quick action",src:a(79290).Z,width:"754",height:"1168"})),(0,i.kt)("h3",{id:"template-variables"},"Template Variables"),(0,i.kt)("p",null,"You can use template variables throughout your seamless link configuration to dynamically inject values from various sources. Template variables use the ",(0,i.kt)("inlineCode",{parentName:"p"},"{{Variable.path}}")," syntax."),(0,i.kt)("h4",{id:"available-variables"},"Available Variables"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"Options.*")),": Access values from the app options configured during installation"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"{{Options.api_url}}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"{{Options.api_key}}")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"Contact.*")),": Access properties from the current portal user's contact entity"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"{{Contact.customer_number}}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"{{Contact.email}}")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"AuthResponse.*")),": Access data from the authentication response"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"{{AuthResponse.data.data.token}}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"{{AuthResponse.status}}")),(0,i.kt)("li",{parentName:"ul"},"Use this to extract tokens or other authentication data returned by your auth endpoint"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("inlineCode",{parentName:"strong"},"Entity.*")),": Access properties from the current context entities"),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"Example: ",(0,i.kt)("inlineCode",{parentName:"li"},"{{Contract.contract_number}}"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"{{Contract.id}}"))))),(0,i.kt)("h3",{id:"example-use-cases"},"Example Use Cases"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Billing Dashboard"),": Redirect portal users to a third-party billing system to check details of their last bill"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Document Management"),": Provide direct access to a document repository"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Service Portal"),": Integrate with external service management systems")),(0,i.kt)("h3",{id:"security-considerations"},"Security Considerations"),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Never hardcode sensitive credentials in your configuration. Always store API keys and secrets as app options, which are encrypted at rest."))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Credentials Storage"),": Store sensitive credentials (like API keys) as app options rather than hardcoding them"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Token Expiration"),": Ensure your authentication tokens have appropriate expiration times"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"HTTPS"),": Always use HTTPS URLs for authentication endpoints and redirects"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Access Control"),": Implement proper authorization checks on your authentication endpoint to ensure only authorized portal users can obtain tokens")),(0,i.kt)("h2",{id:"hooks"},"Hooks"),(0,i.kt)("p",null,"Hooks allow changing or adding functionality to portals.\nThey typically rely on your API for the execution of any necessary logic and expect a certain response."),(0,i.kt)("p",null,"For certain functionalities, users can choose which hook is used in the portal settings drawer under Extensions."),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Enable hooks in portal settings",src:a(24573).Z,width:"764",height:"661"})),(0,i.kt)("p",null,"There are currently three groups of hooks supported based on their use:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Time Series Data Retrieval"),(0,i.kt)("li",{parentName:"ul"},"Data Existence Check/Retrieval"),(0,i.kt)("li",{parentName:"ul"},"Data Validation")),(0,i.kt)("h3",{id:"time-series-data-retrieval-hooks"},"Time Series Data Retrieval Hooks"),(0,i.kt)("p",null,"Data retrieval hooks enable portals to fetch and display time-series data from third-party systems. These hooks are used to power data visualizations and charts in the portal interface, allowing portal users to view real-time or historical data from integrated systems."),(0,i.kt)("h4",{id:"types-of-data-retrieval-hooks"},"Types of Data Retrieval Hooks"),(0,i.kt)("p",null,"Portals support three types of data retrieval hooks:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Price Data Retrieval")," (",(0,i.kt)("inlineCode",{parentName:"li"},"priceDataRetrieval"),"): Fetches price information over time"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Consumption Data Retrieval")," (",(0,i.kt)("inlineCode",{parentName:"li"},"consumptionDataRetrieval"),"): Retrieves consumption or usage data"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Cost Data Retrieval")," (",(0,i.kt)("inlineCode",{parentName:"li"},"costDataRetrieval"),"): Fetches cost or billing data")),(0,i.kt)("h4",{id:"how-data-retrieval-hooks-work"},"How Data Retrieval Hooks Work"),(0,i.kt)("p",null,"Data retrieval hooks follow a three-step process:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Authentication"),": epilot authenticates with your third-party system to obtain a token or credentials"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Data Retrieval"),": Using the authentication token, epilot makes a request to your data API with the requested time range and interval"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Data Resolution"),": The response is processed and extracted using the configured data path, then displayed in the portal")),(0,i.kt)("p",null,"The authentication step supports caching to reduce API calls and improve performance. The data retrieval supports configurable time intervals (e.g., hourly, daily) and automatically handles time range queries based on the portal user's selected view."),(0,i.kt)("h4",{id:"configuration-and-example-1"},"Configuration and Example"),(0,i.kt)("p",null,"Data retrieval hooks are configured in your app configuration. Each hook defines the authentication mechanism, the data retrieval endpoint, and how to process the response."),(0,i.kt)("p",null,'Below are examples for all three data retrieval hook types.\nAll of these enable configuring users to add a Dynamic Tariff or Consumption block where your integration is pickable using the "Integration" dropdown.'),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Data retrieval integration in Dynamic Tariff block",src:a(22776).Z,width:"806",height:"710"})),(0,i.kt)("h5",{id:"price-data-retrieval"},"Price Data Retrieval"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Price data retrieval hook"',title:'"Price',data:!0,retrieval:!0,'hook"':!0},'{\n  "id": "price",\n  "type": "priceDataRetrieval",\n  "name": {\n    "en": "Price",\n    "de": "Preis"\n  },\n  "intervals": ["PT1H"],\n  "auth": {\n    "url": "{{Options.api_url}}/token",\n    "method": "GET",\n    "headers": {\n      "API-Key": "{{Options.api_key}}",\n      "UID": "{{Contact.customer_number}}"\n    },\n    "cache": {\n      "key": "{{Options.api_key}}-{{Contact.customer_number}}",\n      "ttl": "3600"\n    }\n  },\n  "call": {\n    "url": "{{Options.api_url}}/price",\n    "headers": {\n      "Authorization": "Bearer {{AuthResponse.data.data.token}}"\n    },\n    "params": {\n      "from": "{{Scope.from}}",\n      "to": "{{Scope.to}}",\n      "interval": "{{Scope.interval}}"\n    }\n  },\n  "resolved": {\n    "dataPath": "prices"\n  }\n}\n')),(0,i.kt)("h5",{id:"consumption-data-retrieval"},"Consumption Data Retrieval"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Consumption data retrieval hook"',title:'"Consumption',data:!0,retrieval:!0,'hook"':!0},'{\n  "id": "consumption",\n  "type": "consumptionDataRetrieval",\n  "name": {\n    "en": "Consumption",\n    "de": "Verbrauch"\n  },\n  "intervals": ["PT1H"],\n  "auth": {\n    "url": "{{Options.api_url}}/token",\n    "method": "GET",\n    "headers": {\n      "API-Key": "{{Options.api_key}}",\n      "UID": "{{Contact.customer_number}}"\n    },\n    "cache": {\n      "key": "{{Options.api_key}}-{{Contact.customer_number}}",\n      "ttl": "3600"\n    }\n  },\n  "call": {\n    "url": "{{Options.api_url}}/consumption",\n    "headers": {\n      "Authorization": "Bearer {{AuthResponse.data.data.token}}"\n    },\n    "params": {\n      "from": "{{Scope.from}}",\n      "to": "{{Scope.to}}",\n      "interval": "{{Scope.interval}}"\n    }\n  },\n  "resolved": {\n    "dataPath": "consumptions"\n  }\n}\n')),(0,i.kt)("h5",{id:"cost-data-retrieval"},"Cost Data Retrieval"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Cost data retrieval hook"',title:'"Cost',data:!0,retrieval:!0,'hook"':!0},'{\n  "id": "cost",\n  "type": "costDataRetrieval",\n  "name": {\n    "en": "Cost",\n    "de": "Kosten"\n  },\n  "intervals": ["PT1H"],\n  "auth": {\n    "url": "{{Options.api_url}}/token",\n    "method": "GET",\n    "headers": {\n      "API-Key": "{{Options.api_key}}",\n      "UID": "{{Contact.customer_number}}"\n    },\n    "cache": {\n      "key": "{{Options.api_key}}-{{Contact.customer_number}}",\n      "ttl": "3600"\n    }\n  },\n  "call": {\n    "url": "{{Options.api_url}}/cost",\n    "headers": {\n      "Authorization": "Bearer {{AuthResponse.data.data.token}}"\n    },\n    "params": {\n      "from": "{{Scope.from}}",\n      "to": "{{Scope.to}}",\n      "interval": "{{Scope.interval}}"\n    }\n  },\n  "resolved": {\n    "dataPath": "costs"\n  }\n}\n')),(0,i.kt)("h4",{id:"template-variables-1"},"Template Variables"),(0,i.kt)("p",null,"Data retrieval hooks support the same template variables as any other hook, plus additional scope variables:"),(0,i.kt)("h4",{id:"standard-variables"},"Standard Variables"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Options.*")),": Access values from the app options configured during installation"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Contact.*")),": Access properties from the current portal user's contact entity"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"AuthResponse.*")),": Access data from the authentication response"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Entity.*")),": Access data from the context entities like ",(0,i.kt)("inlineCode",{parentName:"li"},"Contract"),".")),(0,i.kt)("h4",{id:"scope-variables-for-callparams"},"Scope Variables (for ",(0,i.kt)("inlineCode",{parentName:"h4"},"call.params"),")"),(0,i.kt)("p",null,"These variables are automatically provided by epilot based on the portal user's selected time range and interval:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Scope.from")),": Start timestamp of the requested time range (ISO 8601 format)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Scope.to")),": End timestamp of the requested time range (ISO 8601 format)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Scope.interval")),": Selected time interval (ISO 8601 duration format, e.g., ",(0,i.kt)("inlineCode",{parentName:"li"},'"PT1H"')," for hourly)")),(0,i.kt)("h4",{id:"best-practices"},"Best Practices"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Caching"),": Use authentication token caching to reduce API load and improve response times"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Interval Support"),": Support multiple intervals if your API allows it to give portal users flexibility with different data views"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Error Handling"),": Ensure your API returns appropriate error responses that epilot can handle gracefully"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Time Zone Handling"),": Take care when handling Time Zones and DSTs")),(0,i.kt)("h3",{id:"data-existence-checkretrieval"},"Data Existence Check/Retrieval"),(0,i.kt)("p",null,"Sometimes it is desired to check against a third party system before allowing a user to register or self-assign business objects to their account.\nAt the same time, it might be necessary to load business entities to epilot before allowing user to proceed in cases epilot does not have all data on non-portal users."),(0,i.kt)("h4",{id:"registration-hook"},"Registration Hook"),(0,i.kt)("p",null,"Use the registration hook to validate identifiers before creating a portal user. If the registration is valid, you can pass back an epilot Contact UUID that is associated with the portal user."),(0,i.kt)("p",null,"If no body is specified, all identifiers configured for the portal and provided by the user are passed grouped by the schema."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Registration hook"',title:'"Registration','hook"':!0},'{\n  "id": "registration",\n  "type": "registrationIdentifiersCheck",\n  "call": {\n    "url": "https://webhook.site/5e6eae4f-a0ea-4858-ab1a-3f7cb96f5abd",\n    "headers": {\n      "Authorization": "Bearer {{Options.api_key}}"\n    },\n    "result": "{{CallResponse.data.contact_id}}"\n  }\n}\n')),(0,i.kt)("h4",{id:"template-variables-2"},"Template Variables"),(0,i.kt)("p",null,"Registration hooks support the standard template variables plus the identifiers context:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Options.*")),": Access values from the app options configured during installation"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Identifiers.*")),": Access properties provided by the user to identify the entity groupped by schema")),(0,i.kt)("h4",{id:"self-assignment-hook"},"Self-Assignment Hook"),(0,i.kt)("p",null,"Use the self-assignment hook when portal users attach additional contracts to their account. The hook can also include localized explanations shown to the user."),(0,i.kt)("p",null,"If no body is specified, all identifiers configured for the portal and provided by the user are passed grouped by the schema."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Self-assignment hook"',title:'"Self-assignment','hook"':!0},'{\n  "id": "CONTRACT_IDENTIFICATION",\n  "type": "contractIdentification",\n  "call": {\n    "url": "https://webhook.site/5e6eae4f-a0ea-4858-ab1a-3f7cb96f5abd",\n    "headers": {\n      "Authorization": "Bearer {{Options.api_key}}"\n    },\n    "body": {\n      "entity": {\n        "customer_number": "{{Contact.customer_number}}",\n        "portal_user_id": "{{PortalUser._id}}",\n        "contract_number": "{{Identifiers.contract.contract_number}}"\n      }\n    }\n  },\n  "assignment_mode": "contact_to_portal_user",\n  "explanation": {\n    "en": "If you add additional contracts, all your documents, such as invoices, contract offers, etc., will be managed in the customer portal. You will no longer receive the documents by mail, but you will be notified by email about the upload of new documents that have been uploaded to the customer portal for you. Please note that there is currently a limit of 50 contracts.",\n    "de": "Wenn Sie einen weiteren Vertr\xe4ge hinzuf\xfcgen werden alle Ihre Dokumente, wie z.B. Rechnungen, Vertragsangebote etc. im Kundenportal verwaltet. Sie erhalten die Dokumente dann nicht mehr per Post, werden aber per E-Mail \xfcber den Upload von neuen Unterlagen, die im Kundenportal f\xfcr Sie hochgeladen wurden, informiert. Bitte beachten Sie, dass derzeit eine Begrenzung von 50 Vertr\xe4gen besteht."\n  }\n}\n')),(0,i.kt)("h4",{id:"template-variables-3"},"Template Variables"),(0,i.kt)("p",null,"Self-assignment hooks support the standard template variables plus the identifiers context:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Options.*")),": Access values from the app options configured during installation"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Contact.*")),": Access properties from the current portal user's contact entity"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"PortalUser.*")),": Access properties from the current portal user"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Identifiers.*")),": Access properties provided by the user to identify the entity groupped by schema"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"CallResponse.*")),": Access data from the call response (for example in ",(0,i.kt)("inlineCode",{parentName:"li"},"call.result"),")")),(0,i.kt)("h3",{id:"data-validation"},"Data Validation"),(0,i.kt)("h4",{id:"meter-reading-plausibility"},"Meter Reading Plausibility"),(0,i.kt)("p",null,"Use the plausibility check hook to validate meter readings before they are submitted and return limits for validation feedback."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Meter reading plausibility check hook"',title:'"Meter',reading:!0,plausibility:!0,check:!0,'hook"':!0},'{\n  "id": "PLAUSIBILITY_CHECK",\n  "type": "meterReadingPlausibilityCheck",\n  "call": {\n    "url": "https://webhook.site/5e6eae4f-a0ea-4858-ab1a-3f7cb96f5abd",\n    "headers": {\n      "Authorization": "Bearer {{Options.api_key}}"\n    },\n    "body": {\n      "meter_number": "{{Meter.meter_number}}",\n      "register_number": "{{MeterCounter.register_number}}",\n      "timestamp": "{{Reading.timestamp}}",\n      "value": "{{Reading.value}}"\n    }\n  },\n  "resolved": {\n    "valid": "{{CallResponse.data.valid}}",\n    "lower_limit": "{{CallResponse.data.lower_limit}}",\n    "upper_limit": "{{CallResponse.data.upper_limit}}"\n  }\n}\n')),(0,i.kt)("h4",{id:"template-variables-4"},"Template Variables"),(0,i.kt)("p",null,"Meter reading plausibility hooks support the standard template variables plus meter reading context:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Options.*")),": Access values from the app options configured during installation"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Contact.*")),": Access properties from the current portal user's contact entity"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Meter.*")),": Access properties of the meter"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"MeterCounter.*")),": Access properties of the meter register"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"Reading.*")),": Access properties of the submitted reading"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"strong"},"CallResponse.*")),": Access data from the call response")),(0,i.kt)("p",null,"For questions about portal extensions, ",(0,i.kt)("a",{parentName:"p",href:"https://developers.epilot.cloud/contact"},"contact our developer support team"),"."))}u.isMDXComponent=!0},22776:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/data-retrieval-integration-portal-builder-42a34869716dd6ff1055d51c5e932bb2.png"},52374:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/editor-f0eb44cb549dc4ebd4392c4faa4b678f.png"},24573:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/enabling-hooks-in-portal-settings-aa7057885f4d9aaccd9f54a05ca09217.png"},79290:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/quick-action-seamless-link-00f630d32509af492fb29c3137ac5784.png"}}]);