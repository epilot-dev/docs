"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[65199],{35722:(e,t,a)=>{a.d(t,{G:()=>p});var n=a(42858),o=a(67294),i=a(25108);let r=0,l=!1;const s=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??n},p=e=>{let{chart:t,config:a}=e;const p=(0,o.useRef)(null),c=(0,o.useRef)("mermaid-"+r++),[d,u]=(0,o.useState)(""),m=(0,o.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,o.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=s(e,m);l||(n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),l=!0);(async()=>{try{const{svg:e}=await n.Z.render(c.current,t);u(e)}catch(e){i.error("Mermaid rendering failed:",e)}})()}),[t,m]),(0,o.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const o of a){if("attributes"!==o.type||"data-theme"!==o.attributeName)continue;const a=s(e,m);l=!1,n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),l=!0,c.current="mermaid-"+r++,n.Z.render(c.current,t).then((e=>{let{svg:t}=e;u(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,m]),"undefined"==typeof window?o.createElement("div",{className:"mermaid"},t):o.createElement("div",{ref:p,dangerouslySetInnerHTML:{__html:d}})}},33666:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var n=a(87462),o=(a(67294),a(3905));a(35722);const i={title:"External Product Catalog",hide_title:!0,sidebar_position:7},r=void 0,l={unversionedId:"apps/about-apps/components/external-product-catalog",id:"apps/about-apps/components/external-product-catalog",title:"External Product Catalog",description:"External Product Catalog",source:"@site/docs/apps/about-apps/components/external-product-catalog.md",sourceDirName:"apps/about-apps/components",slug:"/apps/about-apps/components/external-product-catalog",permalink:"/docs/apps/about-apps/components/external-product-catalog",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/apps/about-apps/components/external-product-catalog.md",tags:[],version:"current",sidebarPosition:7,frontMatter:{title:"External Product Catalog",hide_title:!0,sidebar_position:7},sidebar:"docsSidebar",previous:{title:"Portal Extensions",permalink:"/docs/apps/about-apps/components/portal-extension"},next:{title:"Cloning Versions",permalink:"/docs/apps/about-apps/versioning/cloning-versions"}},s=[{value:"Configuration",id:"configuration",children:[],level:2},{value:"Hooks",id:"hooks",children:[{value:"Supported Hooks / Catalog Types",id:"supported-hooks--catalog-types",children:[],level:3},{value:"Template Variables",id:"template-variables",children:[{value:"Available Variables",id:"available-variables",children:[],level:4}],level:3},{value:"Example",id:"example",children:[],level:3},{value:"Security Considerations",id:"security-considerations",children:[],level:3}],level:2},{value:"Usage in Journeys",id:"usage-in-journeys",children:[],level:2},{value:"Usage in Portals",id:"usage-in-portals",children:[],level:2},{value:"Integration Interface",id:"integration-interface",children:[{value:"Specification",id:"specification",children:[],level:3}],level:2}],p={toc:s},c="wrapper";function d(e){let{components:t,...a}=e;return(0,o.kt)(c,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{align:"center"},"External Product Catalog"),(0,o.kt)("p",{align:"center"},"Integrate external product catalogs with epilot"),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"To add an ",(0,o.kt)("strong",{parentName:"p"},"External Product Catalog")," component, create a new App or update an existing App."),(0,o.kt)("img",{src:"/img/apps/external-product-catalog/external-catalog-option-menu.png",width:"400"}),(0,o.kt)("p",null,"All development is performed using the built-in configuration editor accessible from the component editor."),(0,o.kt)("p",null,"The editor provides you with autocomplete and validation of the configuration. That way you can start with the example provided in this documentation and fine-tune your external product catalog without ever leaving the editor."),(0,o.kt)("img",{src:"/img/apps/external-product-catalog/component-editor.png",width:"700"}),(0,o.kt)("h2",{id:"hooks"},"Hooks"),(0,o.kt)("p",null,"Hooks allow changing or adding functionality to external product catalogs.\nThey typically rely on your API for the execution of any necessary logic and expect a certain response."),(0,o.kt)("h3",{id:"supported-hooks--catalog-types"},"Supported Hooks / Catalog Types"),(0,o.kt)("p",null,"The interface supports two types of data exchange, depending on the block being used in the journey:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Products"),": Returns an array of products (",(0,o.kt)("inlineCode",{parentName:"li"},'type: "products"'),")."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Product Recommendations"),": Returns a source product and a list of offer products (",(0,o.kt)("inlineCode",{parentName:"li"},'type: "products-recommendation"'),").")),(0,o.kt)("h3",{id:"template-variables"},"Template Variables"),(0,o.kt)("p",null,"You can use template variables throughout your configuration to dynamically inject values from various sources. Template variables use the ",(0,o.kt)("inlineCode",{parentName:"p"},"{{Variable.path}}")," syntax."),(0,o.kt)("h4",{id:"available-variables"},"Available Variables"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"Options.*")),": Access values from the app options configured during installation"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Example: ",(0,o.kt)("inlineCode",{parentName:"li"},"{{Options.api_url}}"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"{{Options.api_key}}")))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"AuthResponse.*")),": Access data from the authentication response data"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Example: ",(0,o.kt)("inlineCode",{parentName:"li"},"{{AuthResponse.access_token}}")),(0,o.kt)("li",{parentName:"ul"},"Use this to extract tokens or other authentication data returned by your auth endpoint"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"Context.*")),": Access properties from the current context (e.g. Journey Context)"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Example: ",(0,o.kt)("inlineCode",{parentName:"li"},"{{Context.journey_id}}"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"{{Context.journey_url.params.xxx}}"))))),(0,o.kt)("h3",{id:"example"},"Example"),(0,o.kt)("p",null,"Below is an example of a configuration for the ",(0,o.kt)("inlineCode",{parentName:"p"},"products")," hook, assuming a typical OAuth2 authentication flow, where the client credentials are stored in the app options."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Products hook with OAuth2 authentication"',title:'"Products',hook:!0,with:!0,OAuth2:!0,'authentication"':!0},'{\n  "hooks": [\n    {\n      "id": "prod-catalog",\n      "type": "products",\n      "name": {\n        "en": "Prod Products",\n        "de": "Prod Produkte"\n      },\n      "auth": {\n        "url": "{{Options.oauth_api_url}}/auth/token",\n        "method": "POST",\n        "headers": {\n          "Authorization": "Basic {{Options.oauth_client_id | append: \\":\\" | append: Options.oauth_client_secret | base64_encode}}",\n          "Content-Type": "application/x-www-form-urlencoded"\n        },\n        "body": {\n          "grant_type": "client_credentials",\n          "scope": "{{Options.oauth_scope}}"\n        }\n      },\n      "call": {\n        "url": "{{Options.base_api_url}}/products",\n        "method": "POST",\n        "headers": {\n          "Authorization": "Bearer {{AuthResponse.access_token}}"\n        }\n      }\n    }\n  ]\n}\n')),(0,o.kt)("h3",{id:"security-considerations"},"Security Considerations"),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Never hardcode sensitive credentials in your configuration. Always store API keys and secrets as app options, which are encrypted at rest."))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Credentials Storage"),": Store sensitive credentials (like API keys) as app options rather than hardcoding them"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Token Expiration"),": Ensure your authentication tokens have appropriate expiration times"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"HTTPS"),": Always use HTTPS URLs for authentication endpoints and redirects"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Access Control"),": Implement proper authorization checks on your authentication endpoint to ensure only authorized clients can obtain tokens")),(0,o.kt)("h2",{id:"usage-in-journeys"},"Usage in Journeys"),(0,o.kt)("p",null,"After your External Product Catalog component is configured and the app is installed, it can be used within epilot's Journeys. Currently we support seamless integration of the external product catalog into the journey via Product Blocks and Product Recommendations Blocks (beta)."),(0,o.kt)("p",null,"When a journey creator adds a ",(0,o.kt)("strong",{parentName:"p"},"Product Block")," or ",(0,o.kt)("strong",{parentName:"p"},"Product Recommendations Block")," in a journey, they can select the integration as the source for products. Only hooks that are supported for the selected block type will be available (e.g. only ",(0,o.kt)("inlineCode",{parentName:"p"},"products")," hook for Product Block, only ",(0,o.kt)("inlineCode",{parentName:"p"},"products-recommendation")," hook for Product Recommendations Block)."),(0,o.kt)("img",{src:"/img/apps/external-product-catalog/journey-product-block-config.png",width:"500"}),(0,o.kt)("p",null,"This allows the journey to dynamically fetch products and pricing from your external catalog in journeys."),(0,o.kt)("p",null,"By default, only data from preceding steps (in their defined order) is passed to the steps/blocks data context. While this works for most use cases, you can configure the data context to also include data from subsequent steps, enabling non-linear journey flows. This configuration also makes the data each integration passes to the journey more explicit, lighter and easier to manage."),(0,o.kt)("img",{src:"/img/apps/external-product-catalog/blocks-data-selection.png",width:"500"}),(0,o.kt)("h2",{id:"usage-in-portals"},"Usage in Portals"),(0,o.kt)("p",null,"After your External Product Catalog component is configured and the app is installed, it can also be used within epilot's Portals."),(0,o.kt)("p",null,"When configuring a Portal, you can add a ",(0,o.kt)("strong",{parentName:"p"},"Product Block")," and select the integration as the source for products. Only hooks that are supported for the selected block type will be available."),(0,o.kt)("img",{src:"/img/apps/external-product-catalog/portal-product-block-config.png",width:"500"}),(0,o.kt)("p",null,"This allows the portal to dynamically fetch products and pricing from your external catalog."),(0,o.kt)("h2",{id:"integration-interface"},"Integration Interface"),(0,o.kt)("p",null,"To ensure seamless communication between epilot and your external catalog, your integration must respect the ",(0,o.kt)("strong",{parentName:"p"},"External Catalog Integration Interface"),"."),(0,o.kt)("h3",{id:"specification"},"Specification"),(0,o.kt)("p",null,"The integration works as a request to your service endpoint with the following request and response:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Request"),": A payload containing the ",(0,o.kt)("inlineCode",{parentName:"li"},"context")," of the journey or a custom one defined by you/epilot."),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Response"),": A list of products or product recommendations in a specific format.")),(0,o.kt)("p",null,"For detailed information on the request and response schemas, please refer to the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.api.epilot.io/pricing-api-external-catalog"},"External Catalog Integration Interface documentation"),"."))}d.isMDXComponent=!0}}]);