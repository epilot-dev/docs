"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[19389],{35722:(e,t,a)=>{a.d(t,{G:()=>p});var n=a(42858),l=a(67294),r=a(25108);let i=0,s=!1;const m=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??n},p=e=>{let{chart:t,config:a}=e;const p=(0,l.useRef)(null),o=(0,l.useRef)("mermaid-"+i++),[d,u]=(0,l.useState)(""),c=(0,l.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,l.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=m(e,c);s||(n.Z.initialize({startOnLoad:!1,theme:a,...c?.mermaid||{}}),s=!0);(async()=>{try{const{svg:e}=await n.Z.render(o.current,t);u(e)}catch(e){r.error("Mermaid rendering failed:",e)}})()}),[t,c]),(0,l.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const l of a){if("attributes"!==l.type||"data-theme"!==l.attributeName)continue;const a=m(e,c);s=!1,n.Z.initialize({startOnLoad:!1,theme:a,...c?.mermaid||{}}),s=!0,o.current="mermaid-"+i++,n.Z.render(o.current,t).then((e=>{let{svg:t}=e;u(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,c]),"undefined"==typeof window?l.createElement("div",{className:"mermaid"},t):l.createElement("div",{ref:p,dangerouslySetInnerHTML:{__html:d}})}},11787:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>s,toc:()=>m});var n=a(87462),l=(a(67294),a(3905));a(35722);const r={sidebar_position:2},i="Email Templates",s={unversionedId:"templates/email-templates",id:"templates/email-templates",title:"Email Templates",description:"[API Docs]",source:"@site/docs/templates/email-templates.md",sourceDirName:"templates",slug:"/templates/email-templates",permalink:"/docs/templates/email-templates",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/templates/email-templates.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Template Variables",permalink:"/docs/templates/template-variables"},next:{title:"Document Templates",permalink:"/docs/templates/document-templates"}},m=[{value:"Template Components",id:"template-components",children:[],level:2},{value:"Variables",id:"variables",children:[],level:2},{value:"System Templates",id:"system-templates",children:[],level:2},{value:"Key API Operations",id:"key-api-operations",children:[],level:2},{value:"Sending Emails with Templates",id:"sending-emails-with-templates",children:[],level:2},{value:"Bulk Messaging",id:"bulk-messaging",children:[],level:2},{value:"Creating a Template",id:"creating-a-template",children:[],level:2}],p={toc:m},o="wrapper";function d(e){let{components:t,...a}=e;return(0,l.kt)(o,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"email-templates"},"Email Templates"),(0,l.kt)("p",null,"[",(0,l.kt)("a",{parentName:"p",href:"/api/email-template"},"API Docs"),"]\n[",(0,l.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/email-template-client"},"SDK"),"]"),(0,l.kt)("p",null,"The Email Template API manages reusable email templates in epilot. Templates define the structure and content of outgoing emails, supporting HTML content, variable substitution, branding, and file attachments."),(0,l.kt)("p",null,"Each email template is stored as an entity with metadata (sender, recipients, subject), an HTML body with optional plaintext fallback, and references to attached files."),(0,l.kt)("h2",{id:"template-components"},"Template Components"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Component"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Name")),(0,l.kt)("td",{parentName:"tr",align:null},"Display name for the template")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Brand")),(0,l.kt)("td",{parentName:"tr",align:null},"Associated brand for styling and sender identity. Set to ",(0,l.kt)("inlineCode",{parentName:"td"},"0")," for all brands")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"From")),(0,l.kt)("td",{parentName:"tr",align:null},"Sender email address (supports custom email domains)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"To / Cc / Bcc")),(0,l.kt)("td",{parentName:"tr",align:null},"Default recipient addresses")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Subject")),(0,l.kt)("td",{parentName:"tr",align:null},"Email subject line (supports ",(0,l.kt)("a",{parentName:"td",href:"/docs/templates/template-variables"},"template variables"),")")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Body")),(0,l.kt)("td",{parentName:"tr",align:null},"HTML and/or plaintext content with variable placeholders")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Attachments")),(0,l.kt)("td",{parentName:"tr",align:null},"File references stored in S3. Files over 10 MB are sent as download links. Supports ",(0,l.kt)("a",{parentName:"td",href:"/docs/templates/document-templates"},"document templates")," as attachments -- documents are generated with variable substitution at send time and attached as PDF/DOCX")))),(0,l.kt)("h2",{id:"variables"},"Variables"),(0,l.kt)("p",null,"Templates support ",(0,l.kt)("a",{parentName:"p",href:"https://handlebarsjs.com/"},"Handlebars"),"-based variable substitution powered by the ",(0,l.kt)("a",{parentName:"p",href:"/docs/templates/template-variables"},"Template Variables API"),". Insert variables into subject lines and body content using double curly braces:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-handlebars"},"Hello {{contact.first_name}},\n\nYour order {{order._title}} has been confirmed.\n")),(0,l.kt)("p",null,"Variables are resolved at send time against entity data. Use the variable picker in the template editor to browse available variables."),(0,l.kt)("h2",{id:"system-templates"},"System Templates"),(0,l.kt)("p",null,"epilot provides built-in system templates for platform features:"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Template"),(0,l.kt)("th",{parentName:"tr",align:null},"Purpose"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Double Opt-in")),(0,l.kt)("td",{parentName:"tr",align:null},"Sends a confirmation link for consent management / newsletter opt-in")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Portal Invitation")),(0,l.kt)("td",{parentName:"tr",align:null},"Invites end customers to register for the Customer Portal (ECP)")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("strong",{parentName:"td"},"Installer Portal Invitation")),(0,l.kt)("td",{parentName:"tr",align:null},"Invites partners to register for the Installer Portal")))),(0,l.kt)("p",null,"System templates can be customized per organization but cannot be deleted."),(0,l.kt)("h2",{id:"key-api-operations"},"Key API Operations"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Operation"),(0,l.kt)("th",{parentName:"tr",align:null},"Description"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"createEmailTemplate")),(0,l.kt)("td",{parentName:"tr",align:null},"Create a new email template entity")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"getEmailTemplate")),(0,l.kt)("td",{parentName:"tr",align:null},"Retrieve a template by ID")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"updateEmailTemplate")),(0,l.kt)("td",{parentName:"tr",align:null},"Update an existing template")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"deleteEmailTemplate")),(0,l.kt)("td",{parentName:"tr",align:null},"Delete a template")),(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"getSystemEmailTemplate")),(0,l.kt)("td",{parentName:"tr",align:null},"Retrieve a system template by type")))),(0,l.kt)("p",null,"See the full ",(0,l.kt)("a",{parentName:"p",href:"/api/email-template"},"API reference")," for request and response schemas."),(0,l.kt)("h2",{id:"sending-emails-with-templates"},"Sending Emails with Templates"),(0,l.kt)("p",null,"To send an email using a template, use the ",(0,l.kt)("a",{parentName:"p",href:"/docs/messaging/message-api"},"Message API")," with a ",(0,l.kt)("inlineCode",{parentName:"p"},"template_id"),". The Message API resolves template variables against the provided entity context before sending."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST https://message.sls.epilot.io/v1/message/send \\\n  -H "Authorization: Bearer $EPILOT_API_TOKEN" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "template_id": "abc-123-template-id",\n    "to": ["customer@example.com"],\n    "entity_id": "entity-uuid",\n    "schema": "contact"\n  }\'\n')),(0,l.kt)("p",null,"The ",(0,l.kt)("inlineCode",{parentName:"p"},"entity_id")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"schema")," fields provide the context for variable resolution. The template's subject, body, and attachments are used, with all ",(0,l.kt)("inlineCode",{parentName:"p"},"{{variables}}")," replaced with actual entity data."),(0,l.kt)("h2",{id:"bulk-messaging"},"Bulk Messaging"),(0,l.kt)("p",null,"For sending the same template to multiple recipients (e.g. campaigns or notifications), use bulk automation with email templates. The automation engine iterates over a set of entities and sends individualized emails with per-recipient variable resolution."),(0,l.kt)("p",null,"Configure bulk messaging through ",(0,l.kt)("strong",{parentName:"p"},"Automation > Actions > Send Email")," and select the target template."),(0,l.kt)("h2",{id:"creating-a-template"},"Creating a Template"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST https://email-template.sls.epilot.io/v1/email-template \\\n  -H "Authorization: Bearer $EPILOT_API_TOKEN" \\\n  -H "Content-Type: application/json" \\\n  -d \'{\n    "name": "Order Confirmation",\n    "brand_id": 0,\n    "from": "noreply@example.com",\n    "to": [],\n    "subject": "Your order {{order._title}} is confirmed",\n    "body": {\n      "html": "<h1>Hi {{contact.first_name}},</h1><p>Thank you for your order.</p>",\n      "text": "Hi {{contact.first_name}}, Thank you for your order."\n    },\n    "attachments": []\n  }\'\n')))}d.isMDXComponent=!0}}]);