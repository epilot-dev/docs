"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[88059],{35722:(e,t,a)=>{a.d(t,{G:()=>d});var n=a(42858),r=a(67294),i=a(25108);let o=0,s=!1;const l=(e,t)=>{const a=e?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return t?.theme?.[a]??t?.mermaid?.theme??n},d=e=>{let{chart:t,config:a}=e;const d=(0,r.useRef)(null),p=(0,r.useRef)("mermaid-"+o++),[h,c]=(0,r.useState)(""),m=(0,r.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=l(e,m);s||(n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),s=!0);(async()=>{try{const{svg:e}=await n.Z.render(p.current,t);c(e)}catch(e){i.error("Mermaid rendering failed:",e)}})()}),[t,m]),(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),a=new MutationObserver((a=>{for(const r of a){if("attributes"!==r.type||"data-theme"!==r.attributeName)continue;const a=l(e,m);s=!1,n.Z.initialize({startOnLoad:!1,theme:a,...m?.mermaid||{}}),s=!0,p.current="mermaid-"+o++,n.Z.render(p.current,t).then((e=>{let{svg:t}=e;c(t)}));break}}));return a.observe(e,{attributes:!0}),()=>a.disconnect()}),[t,m]),"undefined"==typeof window?r.createElement("div",{className:"mermaid"},t):r.createElement("div",{ref:d,dangerouslySetInnerHTML:{__html:h}})}},78781:(e,t,a)=>{a.r(t),a.d(t,{contentTitle:()=>o,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var n=a(87462),r=(a(67294),a(3905));a(35722);const i={sidebar_position:1,title:"Sharing & Collaboration"},o="Sharing & Cross-Org Collaboration",s={unversionedId:"collaboration/sharing",id:"collaboration/sharing",title:"Sharing & Collaboration",description:"epilot enables organizations to share entities and collaborate across organizational boundaries. This is central to the energy sector, where utility companies work with networks of installers, grid operators, and service partners to fulfill customer orders.",source:"@site/docs/collaboration/sharing.md",sourceDirName:"collaboration",slug:"/collaboration/sharing",permalink:"/docs/collaboration/sharing",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/collaboration/sharing.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Sharing & Collaboration"},sidebar:"docsSidebar",previous:{title:"File Collections",permalink:"/docs/files/file-collections"},next:{title:"Journey Builder",permalink:"/docs/journeys/journey-builder"}},l=[{value:"Overview",id:"overview",children:[],level:2},{value:"How Sharing Works",id:"how-sharing-works",children:[{value:"Partner Roles",id:"partner-roles",children:[],level:3},{value:"Entity ACLs",id:"entity-acls",children:[],level:3},{value:"The <code>x-epilot-org-id</code> Header",id:"the-x-epilot-org-id-header",children:[],level:3},{value:"Entity Ownership",id:"entity-ownership",children:[],level:3}],level:2},{value:"What Can Be Shared",id:"what-can-be-shared",children:[],level:2},{value:"Partner Onboarding",id:"partner-onboarding",children:[],level:2},{value:"Automating Sharing with Flows",id:"automating-sharing-with-flows",children:[],level:2},{value:"Partner-Controlled Permissions",id:"partner-controlled-permissions",children:[],level:2},{value:"API Access",id:"api-access",children:[],level:2},{value:"Related Topics",id:"related-topics",children:[],level:2}],d={toc:l},p="wrapper";function h(e){let{components:t,...a}=e;return(0,r.kt)(p,(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"sharing--cross-org-collaboration"},"Sharing & Cross-Org Collaboration"),(0,r.kt)("p",null,"epilot enables organizations to share entities and collaborate across organizational boundaries. This is central to the energy sector, where utility companies work with networks of installers, grid operators, and service partners to fulfill customer orders."),(0,r.kt)("h2",{id:"overview"},"Overview"),(0,r.kt)("p",null,"Sharing allows a ",(0,r.kt)("strong",{parentName:"p"},"vendor organization")," to grant a ",(0,r.kt)("strong",{parentName:"p"},"partner organization")," controlled access to specific entities and their related data. Partners can then view, edit, or act on shared entities depending on the permissions granted to them."),(0,r.kt)("p",null,"Common partner collaboration scenarios include:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A utility company shares an opportunity with an installation partner to schedule an on-site visit"),(0,r.kt)("li",{parentName:"ul"},"A grid operator shares meter data with a service provider for maintenance"),(0,r.kt)("li",{parentName:"ul"},"A vendor shares order details (including related products, files, and workflows) with a fulfillment partner")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Sharing is always initiated by the vendor organization. The principle is ",(0,r.kt)("strong",{parentName:"p"},"private by default")," \u2014 entities are only visible to partner organizations after being explicitly shared."))),(0,r.kt)("h2",{id:"how-sharing-works"},"How Sharing Works"),(0,r.kt)("h3",{id:"partner-roles"},"Partner Roles"),(0,r.kt)("p",null,"Each partner organization is assigned a single ",(0,r.kt)("strong",{parentName:"p"},"Partner Role")," by the vendor organization. This role defines the maximum set of permissions the partner has when accessing shared entities."),(0,r.kt)("p",null,"A partner role contains ",(0,r.kt)("strong",{parentName:"p"},"grants")," \u2014 permission rules that specify which actions (view, edit, delete) are allowed on which entity types:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Partner role with grants"',title:'"Partner',role:!0,with:!0,'grants"':!0},'{\n  "name": "Installation Partner",\n  "type": "partner_role",\n  "organization_id": "vendor-org-id",\n  "grants": [\n    { "action": "entity:view", "resource": "opportunity*" },\n    { "action": "entity:edit", "resource": "opportunity*" },\n    { "action": "entity:view", "resource": "file*" },\n    { "action": "workflow:execution:*", "resource": "*" }\n  ]\n}\n')),(0,r.kt)("p",null,"The partner role is configured during partner onboarding and applies to ",(0,r.kt)("strong",{parentName:"p"},"all users")," in the partner organization."),(0,r.kt)("h3",{id:"entity-acls"},"Entity ACLs"),(0,r.kt)("p",null,"When an entity is shared with a partner, an ",(0,r.kt)("inlineCode",{parentName:"p"},"_acl")," (Access Control List) field is written to the entity. The ACL specifies which organizations can perform which operations:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Entity ACL"',title:'"Entity','ACL"':!0},'{\n  "_id": "opp-123",\n  "_schema": "opportunity",\n  "_acl": {\n    "view": ["org:partner-1", "org:partner-2"],\n    "edit": ["org:partner-2"],\n    "delete": []\n  }\n}\n')),(0,r.kt)("p",null,"Permission checks combine the partner role grants with entity-level ACLs using ",(0,r.kt)("a",{parentName:"p",href:"/docs/auth/authorization"},"Attribute-Based Access Control (ABAC)"),". A partner user can only access an entity if:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Their ",(0,r.kt)("strong",{parentName:"li"},"partner role")," includes a grant for the action and entity type"),(0,r.kt)("li",{parentName:"ol"},"The entity's ",(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("inlineCode",{parentName:"strong"},"_acl"))," includes their organization for that action")),(0,r.kt)("p",null,"This two-layer approach means vendors maintain full control \u2014 even if a partner role grants broad edit access, only entities with matching ACL entries are accessible."),(0,r.kt)("h3",{id:"the-x-epilot-org-id-header"},"The ",(0,r.kt)("inlineCode",{parentName:"h3"},"x-epilot-org-id")," Header"),(0,r.kt)("p",null,"To access shared entities via API, partner users include the ",(0,r.kt)("inlineCode",{parentName:"p"},"x-epilot-org-id")," header to specify the vendor organization they want to interact with:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-http",metastring:'title="Accessing a shared entity"',title:'"Accessing',a:!0,shared:!0,'entity"':!0},"GET /v1/entity/opportunity/opp-123\nHost: entity.sls.epilot.cloud\nAuthorization: Bearer <token>\nx-epilot-org-id: <vendor-org-id>\n")),(0,r.kt)("p",null,"Without this header, API calls default to the caller's own organization. With the header, the caller accesses resources in the target organization, subject to their partner role permissions and entity ACLs."),(0,r.kt)("h3",{id:"entity-ownership"},"Entity Ownership"),(0,r.kt)("p",null,"When a partner creates an entity in the vendor's organization (e.g., adding a comment to a shared opportunity), the entity receives an ",(0,r.kt)("inlineCode",{parentName:"p"},"_owner")," field set to the partner's organization ID. This gives the partner immediate access to entities they create, without waiting for ACL propagation."),(0,r.kt)("h2",{id:"what-can-be-shared"},"What Can Be Shared"),(0,r.kt)("p",null,"Sharing applies to entities and their related data. When sharing a top-level entity like an opportunity, vendors can choose to also share:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Resource"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Entities")),(0,r.kt)("td",{parentName:"tr",align:null},"The primary entity (opportunity, order, contract) and related entities")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Files")),(0,r.kt)("td",{parentName:"tr",align:null},"Documents and attachments related to the shared entity")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Workflows")),(0,r.kt)("td",{parentName:"tr",align:null},"Workflow executions linked to the shared entity")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Notes")),(0,r.kt)("td",{parentName:"tr",align:null},"Comments and discussion threads on the entity")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"Emails")),(0,r.kt)("td",{parentName:"tr",align:null},"Message threads and their attachments")))),(0,r.kt)("p",null,"Related entities are shared through contextual rules. For example, sharing an order automatically includes its related products and prices, since they are required for the order to be meaningful."),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"Sharing emails automatically includes related message threads and attachments. Sharing notes includes the full comment thread."))),(0,r.kt)("h2",{id:"partner-onboarding"},"Partner Onboarding"),(0,r.kt)("p",null,"Setting up a new partner involves these steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Create the Partner entity")," \u2014 Add a partner record with name, email, address, and other details"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Configure a Partner Role")," \u2014 Define the permission grants that control what the partner can access"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Invite the partner")," \u2014 Send an invitation for the partner organization to join and link accounts"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Share entities")," \u2014 Begin sharing specific entities through the sharing dialog or automation")),(0,r.kt)("p",null,"Once established, the vendor can share entities from the entity table (single or bulk), the entity detail view, or through automated flows."),(0,r.kt)("h2",{id:"automating-sharing-with-flows"},"Automating Sharing with Flows"),(0,r.kt)("p",null,"For organizations with recurring sharing patterns, sharing can be automated using ",(0,r.kt)("a",{parentName:"p",href:"/docs/automation/automation-flows"},"Flows"),". Two automated tasks are available:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Share Entity")," \u2014 Automatically share entities with a partner when conditions are met"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Offer Entity")," \u2014 Offer entities to partners based on availability rules")),(0,r.kt)("p",null,"Conditions can include entity attributes, labels, purposes, and geographic criteria such as ZIP code-based partner availability. This enables scenarios like automatically sharing all new solar installation opportunities with the nearest qualified installer."),(0,r.kt)("h2",{id:"partner-controlled-permissions"},"Partner-Controlled Permissions"),(0,r.kt)("p",null,"While the vendor defines the maximum permissions through the partner role, partner organizations can further ",(0,r.kt)("strong",{parentName:"p"},"restrict")," access for their own users. A partner admin can create internal roles that limit what individual users can do with shared entities."),(0,r.kt)("p",null,"This follows the ",(0,r.kt)("strong",{parentName:"p"},"principle of least privilege"),": partner internal roles can only narrow permissions, never expand beyond what the vendor granted. For example, if the vendor grants view and edit access to opportunities, a partner admin can create a role that only allows view access for certain team members."),(0,r.kt)("h2",{id:"api-access"},"API Access"),(0,r.kt)("p",null,"The ",(0,r.kt)("a",{parentName:"p",href:"/api/partner"},"Partner API")," provides endpoints for managing partner relationships programmatically:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"List and search partner organizations in the partner directory"),(0,r.kt)("li",{parentName:"ul"},"Manage partner invitations and onboarding"),(0,r.kt)("li",{parentName:"ul"},"Query partner details and relationship metadata")),(0,r.kt)("p",null,"For entity-level sharing operations, use the ",(0,r.kt)("a",{parentName:"p",href:"/api/entity"},"Entity API")," with the ",(0,r.kt)("inlineCode",{parentName:"p"},"x-epilot-org-id")," header to interact with shared entities across organizations."),(0,r.kt)("p",null,"For managing permission grants and partner roles, use the ",(0,r.kt)("a",{parentName:"p",href:"/api/permissions"},"Permissions API"),"."),(0,r.kt)("h2",{id:"related-topics"},"Related Topics"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/entities/flexible-entities"},"Flexible Entities")," \u2014 Entity data model and schema system"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/auth/authorization"},"Authorization")," \u2014 ABAC permission model and role system"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/docs/auth/permissions"},"Permissions")," \u2014 Managing roles and grants")))}h.isMDXComponent=!0}}]);