"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[8181],{35722:(t,e,a)=>{a.d(e,{G:()=>m});var n=a(42858),r=a(67294),i=a(25108);let o=0,l=!1;const d=(t,e)=>{const a=t?.getAttribute("data-theme")??"light",n="dark"===a?"dark":"default";return e?.theme?.[a]??e?.mermaid?.theme??n},m=t=>{let{chart:e,config:a}=t;const m=(0,r.useRef)(null),p=(0,r.useRef)("mermaid-"+o++),[s,u]=(0,r.useState)(""),k=(0,r.useMemo)((()=>"string"==typeof a?JSON.parse(a):a),[a]);return(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const t=document.querySelector("html"),a=d(t,k);l||(n.Z.initialize({startOnLoad:!1,theme:a,...k?.mermaid||{}}),l=!0);(async()=>{try{const{svg:t}=await n.Z.render(p.current,e);u(t)}catch(t){i.error("Mermaid rendering failed:",t)}})()}),[e,k]),(0,r.useEffect)((()=>{if("undefined"==typeof window)return;const t=document.querySelector("html"),a=new MutationObserver((a=>{for(const r of a){if("attributes"!==r.type||"data-theme"!==r.attributeName)continue;const a=d(t,k);l=!1,n.Z.initialize({startOnLoad:!1,theme:a,...k?.mermaid||{}}),l=!0,p.current="mermaid-"+o++,n.Z.render(p.current,e).then((t=>{let{svg:e}=t;u(e)}));break}}));return a.observe(t,{attributes:!0}),()=>a.disconnect()}),[e,k]),"undefined"==typeof window?r.createElement("div",{className:"mermaid"},e):r.createElement("div",{ref:m,dangerouslySetInnerHTML:{__html:s}})}},18319:(t,e,a)=>{a.r(e),a.d(e,{contentTitle:()=>o,default:()=>s,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));a(35722);const i={sidebar_position:1,title:"Common Data Structure"},o="Payload Structure",l={unversionedId:"integrations/webhooks/payload-structure/intro",id:"integrations/webhooks/payload-structure/intro",title:"Common Data Structure",description:"[API Docs]",source:"@site/docs/integrations/webhooks/payload-structure/intro.md",sourceDirName:"integrations/webhooks/payload-structure",slug:"/integrations/webhooks/payload-structure/intro",permalink:"/docs/integrations/webhooks/payload-structure/intro",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/integrations/webhooks/payload-structure/intro.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,title:"Common Data Structure"},sidebar:"docsSidebar",previous:{title:"Overview",permalink:"/docs/integrations/webhooks"},next:{title:"Trigger: Automation Action",permalink:"/docs/integrations/webhooks/payload-structure/automation-trigger"}},d=[{value:"Main Entity",id:"main-entity",children:[],level:2},{value:"Webhook Fields",id:"webhook-fields",children:[],level:2}],m={toc:d},p="wrapper";function s(t){let{components:e,...i}=t;return(0,r.kt)(p,(0,n.Z)({},m,i,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"payload-structure"},"Payload Structure"),(0,r.kt)("p",null,"[",(0,r.kt)("a",{parentName:"p",href:"/api/webhooks"},"API Docs"),"]\n[",(0,r.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/webhooks-client"},"SDK"),"]"),(0,r.kt)("p",null,"Webhook payloads vary by trigger type. The two trigger types are:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Automation Trigger Webhook")," \u2014 Fires when an automation action sends a webhook request. This is the most common trigger."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Portal User Access")," \u2014 Fires when a user accesses an entity in the portal.")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Trigger",src:a(96727).Z,width:"800",height:"592"})),(0,r.kt)("p",null,"Every payload contains a ",(0,r.kt)("inlineCode",{parentName:"p"},"metadata")," object with the organization ID and event context. The ",(0,r.kt)("inlineCode",{parentName:"p"},"entity")," object holds the primary entity data. The ",(0,r.kt)("inlineCode",{parentName:"p"},"relations")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"activity")," objects are optional and depend on the webhook configuration."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="Webhook payload structure"',title:'"Webhook',payload:!0,'structure"':!0},'{\n   "metadata": {\n      "organization_id": "org_1234567890",\n      "event_type": "automation_trigger_webhook",\n      "timestamp": "2023-10-01T12:00:00Z"\n   },\n   "entity": {\n      "_id": "123456",\n      "_schema_": "opportunity",\n      "name": "New Opportunity",\n      "status": "open"\n   },\n   "relations": [\n      // optional relations to other entities\n   ],\n   "activity": {\n      // optional activity data\n   },\n   "changed_attributes": {\n      "added": {},\n      "deleted": {},\n      "updated": {}\n   }\n}\n')),(0,r.kt)("p",null,"The overall flow works as follows:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Configure a trigger for the webhook"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Portal Access")," triggers fire on every portal user login"),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"Automation Trigger")," triggers fire when connected to an automation action"),(0,r.kt)("li",{parentName:"ol"},"Optionally configure a JSONata expression to transform the payload before delivery")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Simple Overview",src:a(33981).Z,width:"892",height:"362"})),(0,r.kt)("h2",{id:"main-entity"},"Main Entity"),(0,r.kt)("p",null,"Every webhook payload includes a main entity in the ",(0,r.kt)("inlineCode",{parentName:"p"},"entity")," object. The entity type depends on the trigger:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Portal User Access")," \u2014 The ",(0,r.kt)("inlineCode",{parentName:"li"},"entity")," object contains the contact entity of the user who accessed the portal."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"Automation Trigger")," \u2014 The ",(0,r.kt)("inlineCode",{parentName:"li"},"entity")," object contains the entity that the automation was triggered on (e.g., a contact, opportunity, or order).")),(0,r.kt)("h2",{id:"webhook-fields"},"Webhook Fields"),(0,r.kt)("p",null,"The payload sent to the webhook URL contains the following fields (assuming no JSONata transformation is applied):"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Field"),(0,r.kt)("th",{parentName:"tr",align:null},"Type"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata")),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:null},"Contains metadata about the configured event")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.action")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"Action that triggered the event")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.origin")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"Origin of the event")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.creation_timestamp")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"Time of event creation")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.webhook_id")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"The ID of the webhook configuration")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.webhook_name")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"The name of the webhook configuration")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.automation_name")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"The name of the automation that triggered the event")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.organization_id")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"The ID of the given organization")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.user_id")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"The ID of the user for manual triggered events")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.correlation_id")),(0,r.kt)("td",{parentName:"tr",align:null},"string"),(0,r.kt)("td",{parentName:"tr",align:null},"ID used to track the event")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.execution_id")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"When triggered by an automation this is its execution id")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"metadata.action_id")),(0,r.kt)("td",{parentName:"tr",align:null},"string?"),(0,r.kt)("td",{parentName:"tr",align:null},"When triggered by an automation this is the id of the action")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"entity")),(0,r.kt)("td",{parentName:"tr",align:null},"object"),(0,r.kt)("td",{parentName:"tr",align:null},"The main entity data relevant to the event")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"relations")),(0,r.kt)("td",{parentName:"tr",align:null},"array?"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional relations to other entities")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"activity")),(0,r.kt)("td",{parentName:"tr",align:null},"object?"),(0,r.kt)("td",{parentName:"tr",align:null},"Optional activity data")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"changed_attributes")),(0,r.kt)("td",{parentName:"tr",align:null},"object?"),(0,r.kt)("td",{parentName:"tr",align:null},"The attributes that were added, deleted, or updated")))))}s.isMDXComponent=!0},33981:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/intro-f98fa1d0488cdb4149ab32eb738f838a.png"},96727:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/trigger-8379d28e6021b7796f6bfecc9591f687.gif"}}]);