"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[76582],{35722:(e,t,n)=>{n.d(t,{G:()=>p});var a=n(42858),i=n(67294),r=n(25108);let l=0,d=!1;const o=(e,t)=>{const n=e?.getAttribute("data-theme")??"light",a="dark"===n?"dark":"default";return t?.theme?.[n]??t?.mermaid?.theme??a},p=e=>{let{chart:t,config:n}=e;const p=(0,i.useRef)(null),u=(0,i.useRef)("mermaid-"+l++),[m,s]=(0,i.useState)(""),c=(0,i.useMemo)((()=>"string"==typeof n?JSON.parse(n):n),[n]);return(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=o(e,c);d||(a.Z.initialize({startOnLoad:!1,theme:n,...c?.mermaid||{}}),d=!0);(async()=>{try{const{svg:e}=await a.Z.render(u.current,t);s(e)}catch(e){r.error("Mermaid rendering failed:",e)}})()}),[t,c]),(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=new MutationObserver((n=>{for(const i of n){if("attributes"!==i.type||"data-theme"!==i.attributeName)continue;const n=o(e,c);d=!1,a.Z.initialize({startOnLoad:!1,theme:n,...c?.mermaid||{}}),d=!0,u.current="mermaid-"+l++,a.Z.render(u.current,t).then((e=>{let{svg:t}=e;s(t)}));break}}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[t,c]),"undefined"==typeof window?i.createElement("div",{className:"mermaid"},t):i.createElement("div",{ref:p,dangerouslySetInnerHTML:{__html:m}})}},89339:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>d,toc:()=>o});var a=n(87462),i=(n(67294),n(3905));n(35722);const r={sidebar_position:5,title:"Pricing Models"},l="Pricing Models",d={unversionedId:"pricing/pricing-models",id:"pricing/pricing-models",title:"Pricing Models",description:"Pricing models define how customers are charged. Set the pricing_model field on a Price entity to control the calculation method.",source:"@site/docs/pricing/5-pricing-models.mdx",sourceDirName:"pricing",slug:"/pricing/pricing-models",permalink:"/docs/pricing/pricing-models",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/pricing/5-pricing-models.mdx",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"Pricing Models"},sidebar:"docsSidebar",previous:{title:"Online Sales",permalink:"/docs/pricing/ecommerce"},next:{title:"Switching Deadlines",permalink:"/docs/deadlines/intro"}},o=[{value:"Overview",id:"overview",children:[],level:2},{value:"Standard (<code>per_unit</code>)",id:"standard-per_unit",children:[],level:2},{value:"Tiered Volume (<code>tiered_volume</code>)",id:"tiered-volume-tiered_volume",children:[],level:2},{value:"Tiered Graduated (<code>tiered_graduated</code>)",id:"tiered-graduated-tiered_graduated",children:[],level:2},{value:"Tiered Flat Fee (<code>tiered_flatfee</code>)",id:"tiered-flat-fee-tiered_flatfee",children:[],level:2},{value:"Tier Selection and Input Precedence",id:"tier-selection-and-input-precedence",children:[],level:2},{value:"Billing Periods",id:"billing-periods",children:[],level:2}],p={toc:o},u="wrapper";function m(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"pricing-models"},"Pricing Models"),(0,i.kt)("p",null,"Pricing models define how customers are charged. Set the ",(0,i.kt)("inlineCode",{parentName:"p"},"pricing_model")," field on a Price entity to control the calculation method."),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Model"),(0,i.kt)("th",{parentName:"tr",align:null},"Type"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"per_unit")),(0,i.kt)("td",{parentName:"tr",align:null},"Unit-based or flat-fee"),(0,i.kt)("td",{parentName:"tr",align:null},"Fixed amount per unit of quantity")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"tiered_volume")),(0,i.kt)("td",{parentName:"tr",align:null},"Unit-based"),(0,i.kt)("td",{parentName:"tr",align:null},"Single tier applies to all units based on total quantity")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"tiered_graduated")),(0,i.kt)("td",{parentName:"tr",align:null},"Unit-based"),(0,i.kt)("td",{parentName:"tr",align:null},"Each tier's rate applies only to units within that tier's range")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"tiered_flatfee")),(0,i.kt)("td",{parentName:"tr",align:null},"Flat-fee"),(0,i.kt)("td",{parentName:"tr",align:null},"Flat fee determined by which tier the quantity falls into")))),(0,i.kt)("p",null,"All models support ",(0,i.kt)("strong",{parentName:"p"},"variable pricing")," -- when ",(0,i.kt)("inlineCode",{parentName:"p"},"variable_price")," is enabled, the total is calculated dynamically from user input (e.g., estimated annual energy consumption)."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"For energy tariffs, ",(0,i.kt)("inlineCode",{parentName:"p"},"tiered_graduated")," is the most common model -- it mirrors how grid fees and energy prices are typically structured with consumption-based tiers."))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"standard-per_unit"},"Standard (",(0,i.kt)("inlineCode",{parentName:"h2"},"per_unit"),")"),(0,i.kt)("p",null,"Charges a fixed amount per unit. When ",(0,i.kt)("inlineCode",{parentName:"p"},"variable_price=true"),", the total is calculated from user input (e.g., consumption)."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pricing_model": "per_unit",\n  "variable_price": true,\n  "unit_amount_decimal": "0.055",\n  "unit_amount": 6,\n  "unit_amount_currency": "EUR"\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Calculation:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Consumption = 2,000 kWh\nTotal = 2,000 kWh x 0.055 EUR/kWh = 110.00 EUR\n")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"tiered-volume-tiered_volume"},"Tiered Volume (",(0,i.kt)("inlineCode",{parentName:"h2"},"tiered_volume"),")"),(0,i.kt)("p",null,"The customer's total quantity determines a single tier, and that tier's unit price applies to ",(0,i.kt)("strong",{parentName:"p"},"all")," units."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pricing_model": "tiered_volume",\n  "variable_price": true,\n  "unit_amount_currency": "EUR",\n  "tiers": [\n    { "unit_amount_decimal": "0.055", "up_to": 1000 },\n    { "unit_amount_decimal": "0.054", "up_to": 2000 },\n    { "unit_amount_decimal": "0.053", "up_to": 3000 },\n    { "unit_amount_decimal": "0.050" }\n  ]\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Calculation:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Consumption = 2,000 kWh \u2192 falls in tier 2 (up to 2,000)\nTotal = 2,000 kWh x 0.054 EUR/kWh = 108.00 EUR\n")),(0,i.kt)("p",null,"The last tier (no ",(0,i.kt)("inlineCode",{parentName:"p"},"up_to"),") acts as a catch-all for quantities exceeding all defined ranges."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"tiered-graduated-tiered_graduated"},"Tiered Graduated (",(0,i.kt)("inlineCode",{parentName:"h2"},"tiered_graduated"),")"),(0,i.kt)("p",null,"Each tier's unit price applies only to units ",(0,i.kt)("strong",{parentName:"p"},"within that tier's range"),'. Lower tiers keep their price as consumption crosses into higher tiers. This is sometimes called "cumulative" or "staircase" pricing.'),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pricing_model": "tiered_graduated",\n  "variable_price": true,\n  "unit_amount_currency": "EUR",\n  "tiers": [\n    { "unit_amount_decimal": "0.055", "up_to": 1000 },\n    { "unit_amount_decimal": "0.054", "up_to": 2000 },\n    { "unit_amount_decimal": "0.053", "up_to": 3000 },\n    { "unit_amount_decimal": "0.050" }\n  ]\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Calculation:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Consumption = 2,000 kWh\n  Tier 1: 1,000 kWh x 0.055 EUR/kWh =  55.00 EUR\n  Tier 2: 1,000 kWh x 0.054 EUR/kWh =  54.00 EUR\n  Total                                = 109.00 EUR\n")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"tiered-flat-fee-tiered_flatfee"},"Tiered Flat Fee (",(0,i.kt)("inlineCode",{parentName:"h2"},"tiered_flatfee"),")"),(0,i.kt)("p",null,"Charges a flat fee based on which tier the quantity falls into. The customer pays the tier's flat fee regardless of exact quantity."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "pricing_model": "tiered_flatfee",\n  "variable_price": true,\n  "unit_amount_currency": "EUR",\n  "tiers": [\n    { "flat_fee_amount_decimal": "50.00", "up_to": 5 },\n    { "flat_fee_amount_decimal": "100.00", "up_to": 7 },\n    { "flat_fee_amount_decimal": "150.00", "up_to": 3000 },\n    { "flat_fee_amount_decimal": "200.00" }\n  ]\n}\n')),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Calculation:")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"Max peak power = 7 kW \u2192 falls in tier 2 (up to 7)\nTotal = 100.00 EUR (flat fee)\n")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"tier-selection-and-input-precedence"},"Tier Selection and Input Precedence"),(0,i.kt)("p",null,"Tier ranges are defined by the ",(0,i.kt)("inlineCode",{parentName:"p"},"up_to")," field. The customer's consumption determines which tier applies. For graduated models, all tiers up to the matched tier contribute."),(0,i.kt)("p",null,"Consumption comes from two possible sources:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Priority"),(0,i.kt)("th",{parentName:"tr",align:null},"Source"),(0,i.kt)("th",{parentName:"tr",align:null},"Where it's set"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},"Mapping input"),(0,i.kt)("td",{parentName:"tr",align:null},"Number input block in a ",(0,i.kt)("a",{parentName:"td",href:"/docs/journeys/journey-builder"},"Journey"),", or mapping input on an ",(0,i.kt)("a",{parentName:"td",href:"/docs/pricing/orders"},"Order"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},"Quantity input"),(0,i.kt)("td",{parentName:"tr",align:null},"Product selection block in a ",(0,i.kt)("a",{parentName:"td",href:"/docs/journeys/journey-builder"},"Journey"),", or quantity input on an ",(0,i.kt)("a",{parentName:"td",href:"/docs/pricing/orders"},"Order"))))),(0,i.kt)("p",null,"If both inputs are provided, the ",(0,i.kt)("strong",{parentName:"p"},"mapping input takes precedence"),". If neither is provided, consumption defaults to ",(0,i.kt)("inlineCode",{parentName:"p"},"1"),"."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Use the ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/pricing"},"Pricing Library")," to perform price calculations client-side in Journeys or server-side in automation flows. It handles all pricing models, tax breakdowns, and billing period normalization."))),(0,i.kt)("h2",{id:"billing-periods"},"Billing Periods"),(0,i.kt)("p",null,"All pricing models support the following billing periods:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Period"),(0,i.kt)("th",{parentName:"tr",align:null},"Value"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"One-time"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"one_time"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Weekly"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"weekly"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Monthly"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"monthly"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Quarterly"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"every_quarter"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Semi-annual"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"every_6_months"))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"Annual"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"yearly"))))),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/pricing"},"Pricing Library")," includes normalization utilities for converting amounts between billing periods (e.g., displaying a yearly rate as a monthly equivalent)."))}m.isMDXComponent=!0}}]);