"use strict";(self.webpackChunkepilot_dev_handbook=self.webpackChunkepilot_dev_handbook||[]).push([[25904],{35722:(e,t,n)=>{n.d(t,{G:()=>s});var a=n(42858),i=n(67294),r=n(25108);let l=0,p=!1;const o=(e,t)=>{const n=e?.getAttribute("data-theme")??"light",a="dark"===n?"dark":"default";return t?.theme?.[n]??t?.mermaid?.theme??a},s=e=>{let{chart:t,config:n}=e;const s=(0,i.useRef)(null),m=(0,i.useRef)("mermaid-"+l++),[d,u]=(0,i.useState)(""),c=(0,i.useMemo)((()=>"string"==typeof n?JSON.parse(n):n),[n]);return(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=o(e,c);p||(a.Z.initialize({startOnLoad:!1,theme:n,...c?.mermaid||{}}),p=!0);(async()=>{try{const{svg:e}=await a.Z.render(m.current,t);u(e)}catch(e){r.error("Mermaid rendering failed:",e)}})()}),[t,c]),(0,i.useEffect)((()=>{if("undefined"==typeof window)return;const e=document.querySelector("html"),n=new MutationObserver((n=>{for(const i of n){if("attributes"!==i.type||"data-theme"!==i.attributeName)continue;const n=o(e,c);p=!1,a.Z.initialize({startOnLoad:!1,theme:n,...c?.mermaid||{}}),p=!0,m.current="mermaid-"+l++,a.Z.render(m.current,t).then((e=>{let{svg:t}=e;u(t)}));break}}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[t,c]),"undefined"==typeof window?i.createElement("div",{className:"mermaid"},t):i.createElement("div",{ref:s,dangerouslySetInnerHTML:{__html:d}})}},46184:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>p,default:()=>u,frontMatter:()=>l,metadata:()=>o,toc:()=>s});var a=n(87462),i=(n(67294),n(3905)),r=n(35722);const l={sidebar_position:5,title:"Mapping Examples",description:"Open source mapping examples with test-driven development patterns"},p="Mapping Examples",o={unversionedId:"integrations/erp-toolkit/mapping-examples",id:"integrations/erp-toolkit/mapping-examples",title:"Mapping Examples",description:"Open source mapping examples with test-driven development patterns",source:"@site/docs/integrations/erp-toolkit/mapping-examples.md",sourceDirName:"integrations/erp-toolkit",slug:"/integrations/erp-toolkit/mapping-examples",permalink:"/docs/integrations/erp-toolkit/mapping-examples",editUrl:"https://github.com/epilot-dev/docs/edit/main/docs/integrations/erp-toolkit/mapping-examples.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5,title:"Mapping Examples",description:"Open source mapping examples with test-driven development patterns"},sidebar:"docsSidebar",previous:{title:"File Proxy",permalink:"/docs/integrations/erp-toolkit/file-proxy"},next:{title:"Batch API",permalink:"/docs/integrations/batch-api"}},s=[{value:"Overview",id:"overview",children:[],level:2},{value:"Getting Started",id:"getting-started",children:[{value:"Prerequisites",id:"prerequisites",children:[],level:3},{value:"Setup",id:"setup",children:[],level:3},{value:"Run Tests",id:"run-tests",children:[],level:3}],level:2},{value:"TDD Workflow",id:"tdd-workflow",children:[{value:"Using AI Coding Agents",id:"using-ai-coding-agents",children:[],level:3}],level:2},{value:"Example Mappings",id:"example-mappings",children:[{value:"CustomerChanged",id:"customerchanged",children:[],level:3},{value:"OrderChanged",id:"orderchanged",children:[],level:3},{value:"ContractChanged",id:"contractchanged",children:[],level:3}],level:2},{value:"Test Structure",id:"test-structure",children:[{value:"CI Pipeline",id:"ci-pipeline",children:[],level:3}],level:2},{value:"Key Mapping Concepts",id:"key-mapping-concepts",children:[],level:2},{value:"Next Steps",id:"next-steps",children:[],level:2}],m={toc:s},d="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(d,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"mapping-examples"},"Mapping Examples"),(0,i.kt)("p",null,"The ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/epilot-dev/erp-toolkit-mapping-examples"},"erp-toolkit-mapping-examples")," repository is an open source reference project that demonstrates how to build and test ERP Toolkit mapping configurations using a ",(0,i.kt)("strong",{parentName:"p"},"test-driven development (TDD)")," approach."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Clone this repo and use it as a starting point for your own mapping configurations. The TDD workflow lets you iterate on mappings locally before deploying to production."))),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"The repo contains sample mapping configurations, sample ERP payloads, and integration tests that validate mappings against the ",(0,i.kt)("a",{parentName:"p",href:"./inbound/getting-started#step-3-send-events"},"mapping simulation API")," without persisting any data."),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Component"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"samples/mapping.*.json")),(0,i.kt)("td",{parentName:"tr",align:null},"Mapping configurations for different event types")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"samples/payload.*.json")),(0,i.kt)("td",{parentName:"tr",align:null},"Sample ERP payloads that simulate real inbound events")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"tests/sample-mappings.test.ts")),(0,i.kt)("td",{parentName:"tr",align:null},"Integration tests that validate mapping output")))),(0,i.kt)("h2",{id:"getting-started"},"Getting Started"),(0,i.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Node.js (v18+)"),(0,i.kt)("li",{parentName:"ul"},"An epilot API token with access to the ERP Integration API")),(0,i.kt)("h3",{id:"setup"},"Setup"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Clone the repo\ngit clone https://github.com/epilot-dev/erp-toolkit-mapping-examples.git\ncd erp-toolkit-mapping-examples\n\n# Install dependencies\nnpm install\n\n# Configure your API token\ncp .env.example .env\n# Edit .env and add your EPILOT_API_TOKEN\n")),(0,i.kt)("h3",{id:"run-tests"},"Run Tests"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# Run all tests once\nnpm test\n\n# Run tests in watch mode (re-runs on file changes)\nnpm run test:watch\n")),(0,i.kt)("h2",{id:"tdd-workflow"},"TDD Workflow"),(0,i.kt)("p",null,"The repo demonstrates a test-driven approach to mapping development:"),(0,i.kt)(r.G,{chart:"flowchart LR\n    P[Define sample payload] --\x3e M[Write mapping config]\n    M --\x3e T[Write test with expected output]\n    T --\x3e R[Run test against simulation API]\n    R --\x3e|Fail| M\n    R --\x3e|Pass| D[Deploy mapping to integration]",mdxType:"Mermaid"}),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Define your sample payload")," -- Create a JSON file in ",(0,i.kt)("inlineCode",{parentName:"li"},"samples/")," that represents the ERP data you expect to receive"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Write the mapping configuration")," -- Create a mapping JSON file that transforms the payload into epilot entities"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Write a test")," -- Define the expected entity output and assert against the simulation API response"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Iterate")," -- Run tests in watch mode, adjust mappings until all tests pass"),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("strong",{parentName:"li"},"Deploy")," -- Copy the validated mapping configuration into your integration's use case")),(0,i.kt)("p",null,"Each test calls the ",(0,i.kt)("inlineCode",{parentName:"p"},"simulateMappingV2")," endpoint from the ",(0,i.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/@epilot/erp-integration-client"},(0,i.kt)("inlineCode",{parentName:"a"},"@epilot/erp-integration-client"))," SDK, which applies the mapping to the payload and returns the transformed entities without persisting anything."),(0,i.kt)("h3",{id:"using-ai-coding-agents"},"Using AI Coding Agents"),(0,i.kt)("p",null,"AI coding agents like ",(0,i.kt)("a",{parentName:"p",href:"https://docs.anthropic.com/en/docs/claude-code"},"Claude Code")," can significantly speed up the mapping development process. When given access to both the epilot entity schema documentation and your ERP's data model documentation, an AI agent can:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Draft mapping configurations")," from sample payloads and target entity schemas"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Write JSONata expressions")," for complex transformations, enum lookups, and conditional logic"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Generate test cases")," with expected output based on the sample payloads"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Debug failing tests")," by analyzing the simulation API response and adjusting mappings")),(0,i.kt)("p",null,"For best results, provide the agent with your ERP's API documentation or sample payloads alongside the ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities"},"epilot entity schemas")," and the examples in this repo."),(0,i.kt)("h2",{id:"example-mappings"},"Example Mappings"),(0,i.kt)("h3",{id:"customerchanged"},"CustomerChanged"),(0,i.kt)("p",null,"Transforms a customer event into ",(0,i.kt)("strong",{parentName:"p"},"3 entities"),": ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#contact"},(0,i.kt)("inlineCode",{parentName:"a"},"contact")),", ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#account"},(0,i.kt)("inlineCode",{parentName:"a"},"account")),", and ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#billing_account"},(0,i.kt)("inlineCode",{parentName:"a"},"billing_account")),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Key patterns demonstrated:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Multi-value attributes with ",(0,i.kt)("inlineCode",{parentName:"li"},"_tags")," (e.g., Primary email, Mobile phone, Billing Address)"),(0,i.kt)("li",{parentName:"ul"},"Conditional entity creation (",(0,i.kt)("inlineCode",{parentName:"li"},"account")," only created when ",(0,i.kt)("inlineCode",{parentName:"li"},"customerType = 'business'"),")"),(0,i.kt)("li",{parentName:"ul"},"SEPA payment data mapping"),(0,i.kt)("li",{parentName:"ul"},"Bidirectional entity relations (contact \u2194 account)"),(0,i.kt)("li",{parentName:"ul"},"Defensive ",(0,i.kt)("inlineCode",{parentName:"li"},"$exists()")," checks in JSONata expressions")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Sample payload"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "customerId": "CUST-2024-001",\n  "customerType": "business",\n  "firstName": "Max",\n  "lastName": "Mustermann",\n  "companyName": "Acme Corporation",\n  "email": "max.mustermann@acme.de",\n  "phone": "+49 89 12345678",\n  "address": {\n    "street": "Hauptstra\xdfe",\n    "houseNumber": "42",\n    "zip": "80331",\n    "city": "M\xfcnchen",\n    "country": "DE"\n  },\n  "defaultPayment": {\n    "iban": "DE89370400440532013000",\n    "bic": "COBADEFFXXX",\n    "accountHolder": "Acme Corporation"\n  }\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Mapping configuration (excerpt)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "entities": [\n    {\n      "entity_schema": "contact",\n      "unique_ids": ["external_id"],\n      "fields": [\n        { "attribute": "external_id", "field": "customerId" },\n        { "attribute": "first_name", "field": "firstName" },\n        { "attribute": "last_name", "field": "lastName" },\n        {\n          "attribute": "email",\n          "_type": "email",\n          "_tags": ["Primary"],\n          "field": "email"\n        },\n        {\n          "attribute": "phone",\n          "_type": "phone",\n          "_tags": ["Primary"],\n          "field": "phone"\n        }\n      ]\n    },\n    {\n      "entity_schema": "account",\n      "unique_ids": ["customer_number"],\n      "condition": "customerType = \'business\'",\n      "fields": [\n        { "attribute": "customer_number", "field": "customerId" },\n        { "attribute": "name", "field": "companyName" }\n      ]\n    }\n  ]\n}\n'))),(0,i.kt)("h3",{id:"orderchanged"},"OrderChanged"),(0,i.kt)("p",null,"Transforms an order event into ",(0,i.kt)("strong",{parentName:"p"},"2 entities"),": ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#contact"},(0,i.kt)("inlineCode",{parentName:"a"},"contact"))," and ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#order"},(0,i.kt)("inlineCode",{parentName:"a"},"order")),"."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Key patterns demonstrated:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Accessing nested source fields (e.g., ",(0,i.kt)("inlineCode",{parentName:"li"},"customer.customerId"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"customer.email"),")"),(0,i.kt)("li",{parentName:"ul"},"Array transformation for order line items with ",(0,i.kt)("inlineCode",{parentName:"li"},"_tags")," per item"),(0,i.kt)("li",{parentName:"ul"},"Currency amount formatting with ",(0,i.kt)("inlineCode",{parentName:"li"},"$formatNumber")," (multiplying by 100 for cents)"),(0,i.kt)("li",{parentName:"ul"},"Computed fields (e.g., ",(0,i.kt)("inlineCode",{parentName:"li"},"item_count")," via ",(0,i.kt)("inlineCode",{parentName:"li"},"$count(items)"),")")),(0,i.kt)("h3",{id:"contractchanged"},"ContractChanged"),(0,i.kt)("p",null,"The most complex example. Transforms a power contract event into ",(0,i.kt)("strong",{parentName:"p"},"4+ entities")," plus ",(0,i.kt)("strong",{parentName:"p"},"meter readings"),": ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#contract"},(0,i.kt)("inlineCode",{parentName:"a"},"contract")),", ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#meter"},(0,i.kt)("inlineCode",{parentName:"a"},"meter")),", ",(0,i.kt)("a",{parentName:"p",href:"/docs/entities/core-entities#meter_counter"},(0,i.kt)("inlineCode",{parentName:"a"},"meter_counter")),", and meter readings."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Key patterns demonstrated:")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Array iteration")," -- Entity-level ",(0,i.kt)("inlineCode",{parentName:"li"},"jsonataExpression")," to iterate over a ",(0,i.kt)("inlineCode",{parentName:"li"},"meter.counters")," array, creating one ",(0,i.kt)("inlineCode",{parentName:"li"},"meter_counter")," entity per counter register (e.g., HT peak, NT off-peak)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Enum/value mapping")," -- JSONata lookup table to map ERP meter types (",(0,i.kt)("inlineCode",{parentName:"li"},"SMART"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"IMS"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"TP"),") to epilot values (",(0,i.kt)("inlineCode",{parentName:"li"},"smart-meter"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"intelligent-measuring-system"),", ",(0,i.kt)("inlineCode",{parentName:"li"},"two-phase-meter"),") with a fallback default"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Meter readings")," -- Dedicated ",(0,i.kt)("inlineCode",{parentName:"li"},"meter_readings")," mapping section (separate from ",(0,i.kt)("inlineCode",{parentName:"li"},"entities"),"), referencing meter and meter counter by unique IDs"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Multi-entity relations")," -- Contract relates to both customer and meter; meter relates back to customer and contract")),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Array iteration example"),(0,i.kt)("p",null,"Creating one ",(0,i.kt)("inlineCode",{parentName:"p"},"meter_counter")," entity per item in the ",(0,i.kt)("inlineCode",{parentName:"p"},"meter.counters")," array:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "entity_schema": "meter_counter",\n  "jsonataExpression": "meter.counters",\n  "unique_ids": ["external_id"],\n  "fields": [\n    { "attribute": "external_id", "field": "counterId" },\n    { "attribute": "obis_number", "field": "obisCode" },\n    { "attribute": "direction", "field": "direction" }\n  ]\n}\n'))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Enum mapping example"),(0,i.kt)("p",null,"Translating ERP meter type codes to epilot values using a JSONata lookup:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},"{\n  \"attribute\": \"type\",\n  \"jsonataExpression\": \"$lookup({'SMART':'smart-meter','IMS':'intelligent-measuring-system','TP':'two-phase-meter','MME':'modern-measuring-equipment'}, meter.meterType) ~> $default('analog')\"\n}\n"))),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Meter readings mapping example"),(0,i.kt)("p",null,"Meter readings use a separate top-level ",(0,i.kt)("inlineCode",{parentName:"p"},"meter_readings")," section:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "meter_readings": [\n    {\n      "jsonataExpression": "meter.readings",\n      "meter": {\n        "unique_ids": ["external_id"]\n      },\n      "fields": [\n        { "attribute": "external_id", "field": "$$.meter.meterId" },\n        { "attribute": "reading_date", "field": "readingDate" },\n        { "attribute": "value", "field": "value" },\n        { "attribute": "reason", "field": "reason" }\n      ]\n    }\n  ]\n}\n'))),(0,i.kt)("h2",{id:"test-structure"},"Test Structure"),(0,i.kt)("p",null,"Tests use ",(0,i.kt)("a",{parentName:"p",href:"https://vitest.dev/"},"Vitest")," and follow a consistent pattern:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-typescript"},"import { simulateMappingV2 } from './helpers';\n\ndescribe('CustomerChanged', () => {\n  it('should map to contact entity', async () => {\n    const mapping = require('../samples/mapping.CustomerChanged.json');\n    const payload = require('../samples/payload.customer.json');\n\n    const response = await simulateMappingV2(mapping, payload);\n    const contact = response.entity_updates.find(\n      (e) => e.entity_schema === 'contact'\n    );\n\n    expect(contact).toMatchObject({\n      entity_schema: 'contact',\n      fields: expect.objectContaining({\n        first_name: 'Max',\n        last_name: 'Mustermann',\n      }),\n    });\n  });\n});\n")),(0,i.kt)("p",null,"Each test:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Loads a mapping configuration and sample payload from ",(0,i.kt)("inlineCode",{parentName:"li"},"samples/")),(0,i.kt)("li",{parentName:"ol"},"Calls ",(0,i.kt)("inlineCode",{parentName:"li"},"simulateMappingV2()")," to dry-run the mapping against the simulation API"),(0,i.kt)("li",{parentName:"ol"},"Finds the relevant entity in the response"),(0,i.kt)("li",{parentName:"ol"},"Asserts the expected output with ",(0,i.kt)("inlineCode",{parentName:"li"},"toMatchObject()"))),(0,i.kt)("h3",{id:"ci-pipeline"},"CI Pipeline"),(0,i.kt)("p",null,"The repo includes a GitHub Actions workflow (",(0,i.kt)("inlineCode",{parentName:"p"},".github/workflows/test.yml"),") that runs all tests on every push and pull request. The ",(0,i.kt)("inlineCode",{parentName:"p"},"EPILOT_API_TOKEN")," is stored as a GitHub Actions secret."),(0,i.kt)("h2",{id:"key-mapping-concepts"},"Key Mapping Concepts"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Concept"),(0,i.kt)("th",{parentName:"tr",align:null},"Description"),(0,i.kt)("th",{parentName:"tr",align:null},"Example"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Field mapping")),(0,i.kt)("td",{parentName:"tr",align:null},"Map a source field to an entity attribute"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{ "attribute": "first_name", "field": "firstName" }'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"JSONata expression")),(0,i.kt)("td",{parentName:"tr",align:null},"Compute a value using JSONata"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'{ "attribute": "full_name", "jsonataExpression": "firstName & \' \' & lastName" }'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Unique identifiers")),(0,i.kt)("td",{parentName:"tr",align:null},"Match existing entities for upsert"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"unique_ids": ["customer_number"]'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Conditional creation")),(0,i.kt)("td",{parentName:"tr",align:null},"Only create entity when condition is met"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"condition": "customerType = \'business\'"'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Multi-value attributes")),(0,i.kt)("td",{parentName:"tr",align:null},"Arrays with tags for email, phone, address"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"_type": "email", "_tags": ["Primary"]'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Array iteration")),(0,i.kt)("td",{parentName:"tr",align:null},"Create multiple entities from an array"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"jsonataExpression": "meter.counters"')," on entity level")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Enum mapping")),(0,i.kt)("td",{parentName:"tr",align:null},"Translate ERP codes to epilot values"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"$lookup({...}, sourceField)")," in JSONata")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Entity relations")),(0,i.kt)("td",{parentName:"tr",align:null},"Link entities using ",(0,i.kt)("inlineCode",{parentName:"td"},"$relation")),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},'"$relation": [{ "entity_schema": "contact", ... }]'))),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("strong",{parentName:"td"},"Meter readings")),(0,i.kt)("td",{parentName:"tr",align:null},"Dedicated mapping section for readings"),(0,i.kt)("td",{parentName:"tr",align:null},"Top-level ",(0,i.kt)("inlineCode",{parentName:"td"},'"meter_readings"')," array in config")))),(0,i.kt)("h2",{id:"next-steps"},"Next Steps"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://github.com/epilot-dev/erp-toolkit-mapping-examples"},"Fork the repo")," and add your own mappings"),(0,i.kt)("li",{parentName:"ul"},"Read the ",(0,i.kt)("a",{parentName:"li",href:"./inbound/mapping"},"Mapping Configuration")," guide for the full mapping syntax reference"),(0,i.kt)("li",{parentName:"ul"},"Use the ",(0,i.kt)("a",{parentName:"li",href:"./inbound/getting-started"},"mapping simulation endpoint")," to test mappings interactively"),(0,i.kt)("li",{parentName:"ul"},"See the ",(0,i.kt)("a",{parentName:"li",href:"./inbound/examples"},"Inbound Examples")," for additional mapping patterns")))}u.isMDXComponent=!0}}]);